var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{l(a.next(e))}catch(t){o(t)}}function s(e){try{l(a["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,s)}l((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return a([e,t])}}function a(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(a){n=[6,a],o=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,r,s,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},BasePanel=function(e){function t(){var t=e.call(this)||this;return t.w=0,t.h=0,t.w=Config.stageWidth,t.h=Config.stageHeight,t.initPanel(),t.addEventListener(egret.Event.RESIZE,t._onResize,t),t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null)},t.prototype.onEnter=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null)},t.prototype.onExit=function(){},t.prototype._onResize=function(e){void 0===e&&(e=null),Config.stageHeight/Config.stageWidth<1366/750&&Common.log("比率小")},t}(eui.Component);__reflect(BasePanel.prototype,"BasePanel");var EGameState;!function(e){e[e.Ready=0]="Ready",e[e.Start=1]="Start",e[e.Pause=2]="Pause",e[e.Again=3]="Again",e[e.End=4]="End",e[e.StageBack=5]="StageBack",e[e.StageFront=6]="StageFront",e[e.Warning=7]="Warning",e[e.EndLevel=8]="EndLevel"}(EGameState||(EGameState={}));var EGamePauseState;!function(e){e[e.Continue=1]="Continue",e[e.Again=2]="Again",e[e.Return=3]="Return"}(EGamePauseState||(EGamePauseState={}));var EPanelState;!function(e){e[e.EnterLevelSelect=1]="EnterLevelSelect",e[e.EnterBabyList=2]="EnterBabyList",e[e.EnterBattle=3]="EnterBattle"}(EPanelState||(EPanelState={}));var EPanelAnimation;!function(e){e[e.None=0]="None",e[e.CenterSlight=1]="CenterSlight",e[e.CenterViolent=2]="CenterViolent",e[e.LeftToRight=3]="LeftToRight",e[e.RightToLeft=4]="RightToLeft",e[e.UpToDown=5]="UpToDown",e[e.DownToUp=6]="DownToUp",e[e.CenterZoomOut=7]="CenterZoomOut"}(EPanelAnimation||(EPanelAnimation={}));var EBabyState;!function(e){e[e.Idle=0]="Idle",e[e.Run=1]="Run",e[e.Attack=2]="Attack",e[e.Tired=3]="Tired"}(EBabyState||(EBabyState={}));var ESkillReleaseType;!function(e){e[e.Immediately=1]="Immediately",e[e.Range=2]="Range"}(ESkillReleaseType||(ESkillReleaseType={}));var ESkillResult;!function(e){e[e.Invalid=0]="Invalid",e[e.Kill=1]="Kill",e[e.ContinuedKill=2]="ContinuedKill",e[e.GestureChange=3]="GestureChange",e[e.SlowSpeed=4]="SlowSpeed",e[e.StopSpeed=5]="StopSpeed",e[e.ChangeLucky=6]="ChangeLucky"}(ESkillResult||(ESkillResult={}));var ESkillHand;!function(e){e[e.Monster=1]="Monster",e[e.Ballon=2]="Ballon"}(ESkillHand||(ESkillHand={}));var ESkillRange;!function(e){e[e.Random=1]="Random",e[e.FrontToBack=2]="FrontToBack",e[e.All=3]="All"}(ESkillRange||(ESkillRange={}));var EBattleMode;!function(e){e[e.Level=1]="Level",e[e.Endless=2]="Endless",e[e.Timelimite=3]="Timelimite"}(EBattleMode||(EBattleMode={}));var EMonsterState;!function(e){e[e.Ready=0]="Ready",e[e.Run=1]="Run",e[e.FallDown=2]="FallDown",e[e.Dead=3]="Dead",e[e.Stop=4]="Stop",e[e.Drown=5]="Drown",e[e.Summon=6]="Summon",e[e.SummonFinish=7]="SummonFinish",e[e.Attack=8]="Attack",e[e.Arrive=9]="Arrive",e[e.Move=10]="Move",e[e.Hurt=11]="Hurt"}(EMonsterState||(EMonsterState={}));var EGestureDifficult;!function(e){e[e.Easy=-1]="Easy",e[e.Mix=0]="Mix",e[e.Normal=1]="Normal",e[e.Center=2]="Center",e[e.Hard=3]="Hard",e[e.NAndH=4]="NAndH",e[e.NAndHH=5]="NAndHH",e[e.NNAndH=6]="NNAndH"}(EGestureDifficult||(EGestureDifficult={}));var EMonsterType;!function(e){e[e.FallDown=1]="FallDown",e[e.Float=2]="Float"}(EMonsterType||(EMonsterType={}));var EMonsterDifficult;!function(e){e[e.Normal=1]="Normal",e[e.Elite=2]="Elite",e[e.BOSS=3]="BOSS",e[e.Summon=4]="Summon"}(EMonsterDifficult||(EMonsterDifficult={}));var ESummonType;!function(e){e[e.Balloon=1]="Balloon",e[e.Monster=2]="Monster"}(ESummonType||(ESummonType={}));var EMonsterPos;!function(e){e[e.Left=1]="Left",e[e.Middle=2]="Middle",e[e.Right=3]="Right"}(EMonsterPos||(EMonsterPos={}));var EEffectType;!function(e){e[e.Fire=1]="Fire",e[e.Ice=2]="Ice",e[e.Thunder=3]="Thunder",e[e.ChangeGesture=4]="ChangeGesture"}(EEffectType||(EEffectType={}));var ELevelType;!function(e){e[e.Normal=1]="Normal",e[e.EliteWarning=2]="EliteWarning",e[e.Elite=3]="Elite",e[e.Boss=4]="Boss",e[e.End=5]="End"}(ELevelType||(ELevelType={}));var EReward;!function(e){e[e.Candy=1]="Candy",e[e.AssignBaby=2]="AssignBaby",e[e.GreenBaby=3]="GreenBaby",e[e.BlueBaby=4]="BlueBaby",e[e.PurpleBaby=5]="PurpleBaby"}(EReward||(EReward={}));var ECapsule;!function(e){e[e.Candy=1]="Candy",e[e.GreenBaby=2]="GreenBaby",e[e.BlueBaby=3]="BlueBaby",e[e.PurpleBaby=4]="PurpleBaby"}(ECapsule||(ECapsule={}));var EBabyQuality;!function(e){e[e.Green=1]="Green",e[e.Blue=2]="Blue",e[e.Purple=3]="Purple"}(EBabyQuality||(EBabyQuality={}));var BaseActor=function(e){function t(){var t=e.call(this)||this;t._groupBalloon=new egret.DisplayObjectContainer,t.addChild(t._groupBalloon),t._armatureContainer=new DragonBonesArmatureContainer,t.addChild(t._armatureContainer),t._effectArmatureContainer=new DragonBonesArmatureContainer,t.addChild(t._effectArmatureContainer),t._gestureData=new Array,t._normalGesture=new Array,t._centerGesture=new Array,t._hardGesture=new Array;for(var n=0;n<GameConfig.gestureConfig.length;n++)GameConfig.gestureConfig[n].difficult==EGestureDifficult.Normal?t._normalGesture.push(GameConfig.gestureConfig[n]):t._hardGesture.push(GameConfig.gestureConfig[n]);return t._rect=new egret.Rectangle,t}return __extends(t,e),t.prototype.resetNormalGesture=function(){this._normalGesture.length=0;for(var e=0;e<GameConfig.gestureConfig.length;e++)GameConfig.gestureConfig[e].difficult==EGestureDifficult.Normal&&this._normalGesture.push(GameConfig.gestureConfig[e])},t.prototype.resetCenterGesture=function(){this._centerGesture.length=0;for(var e=0;e<GameConfig.gestureConfig.length;e++)GameConfig.gestureConfig[e].difficult==EGestureDifficult.Center&&this._normalGesture.push(GameConfig.gestureConfig[e])},t.prototype.resetHardGesture=function(){this._hardGesture.length=0;for(var e=0;e<GameConfig.gestureConfig.length;e++)GameConfig.gestureConfig[e].difficult==EGestureDifficult.Hard&&this._hardGesture.push(GameConfig.gestureConfig[e])},t.prototype.initData=function(){this._unusualDelay=0},t.prototype.gotoIdle=function(){},t.prototype.gotoHurt=function(){},t.prototype.gotoDead=function(){},t.prototype.gotoExplore=function(){},t.prototype.gotoRun=function(){},t.prototype.gotoSlow=function(){},Object.defineProperty(t.prototype,"w",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"h",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"balloons",{get:function(){return this._balloons},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gestureData",{get:function(){return this._gestureData},set:function(e){this._gestureData=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedVertical",{set:function(e){this._speedY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedHorizon",{set:function(e){this._speedX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ePos",{get:function(){return this._ePos},set:function(e){this._ePos=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actorTableData",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t.prototype.update=function(e){this._state==EMonsterState.Ready&&0==this._speedY&&(this._unusualDelay+=e,this._unusualDelay>=PanelManager.gameScenePanel.baby.skillData.time&&(this._unusualDelay=0,this._effectArmatureContainer.visible=!1,this._speedY=this._data.Speed/100*GameConfig.gameSpeedPercent))},t.prototype.resetGestureData=function(){},t.prototype.setVertical=function(e){this._speedY<=0||(this.resetVertical(),this._addNum+=e,this._speedY+=e)},t.prototype.resetVertical=function(){this._speedY-=this._addNum,this._addNum=0,this._speedY=Math.max(this._speedY,0)},t.prototype.updateEffectArmature=function(e){this._effectArmatureContainer.clear();var t=DragonBonesFactory.getInstance().buildArmatureDisplay(e.skillFile,e.skillFile);null==this._effectArmature&&(this._effectArmature=new DragonBonesArmature(t)),this._effectData=e,this._effectResult=e.result,this._effectArmature.ArmatureDisplay=t,this._effectArmatureContainer.register(this._effectArmature,[e.skill]),this._effectArmatureContainer.visible=!1,this._effectArmatureContainer.scaleX=e.scale,this._effectArmatureContainer.scaleY=e.scale,this._effectArmatureContainer.x=e.skillPosX,this._effectArmatureContainer.y=e.skillPosY,this._effectArmatureContainer.addCompleteCallFunc(this.onEffectArmatureComplete,this),this._effectArmatureContainer.addFrameCallFunc(this.onEffectArmatureFram,this),this._effectArmatureContainer.visible=!1},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.playEffect=function(e){},t.prototype.ballExplosion=function(e){},t.prototype.removeBalloon=function(e){},t.prototype.onEffectArmatureComplete=function(){switch(this._state){case EMonsterState.Dead:this.destroyAndRemove();break;case EMonsterState.Stop:switch(this._effectResult){case ESkillResult.Kill:this._effectResult=ESkillResult.Invalid,this.gotoDead(),this._destroyBalloon();break;case ESkillResult.StopSpeed:this._speedY=0,this._state=EMonsterState.Ready;break;case ESkillResult.ChangeLucky:PanelManager.gameScenePanel.createLuckyActor(this.x,this.y),this.destroyAndRemove()}break;case EMonsterState.Drown:this.destroyAndRemove()}},t.prototype.destroy=function(){},t.prototype.destroyAndRemove=function(){this._effectArmatureContainer.visible=!1},t.prototype.onEffectArmatureFram=function(e){},t.prototype._destroyBalloon=function(){for(this._sumBalloon=0;this._balloons.length>0;){var e=this._balloons.pop();GameObjectPool.getInstance().destroyObject(e),this._groupBalloon.contains(e)?this._groupBalloon.removeChild(e):e.parent.removeChild(e)}},t.prototype.balloonExploreHandle=function(){if(this._balloons.length<=0)this._sumBalloon=0;else{if(2==this._sumBalloon&&this._balloons.length>0){var e=this._balloons[0],t=0;egret.Tween.get(e).to({x:t},200,egret.Ease.circOut),egret.Tween.get(e.rop).to({rotation:0},200,egret.Ease.circOut),this._sumBalloon=1}if(3==this._sumBalloon&&this._balloons.length>0){this._sumBalloon=2,2==this._exploreIndex&&this._balloons.reverse();for(var n=0;n<this._balloons.length;n++){var e=this._balloons[n],a=n*(e.width+5)-this._rect.width/2,i=1.2*-this._rect.height;e.calculateRop(a,i),egret.Tween.get(e).to({x:a,y:i},200,egret.Ease.circOut),egret.Tween.get(e.rop).to({rotation:e.ropRotation},200,egret.Ease.circOut)}}}},t.prototype._setBallonPosition=function(e,t,n){void 0===n&&(n=0),1==t?(e.x=0,e.y=1.1*-this._rect.height):2==t?(e.x=n*(e.width+5)-this._rect.width/2,e.y=1.3*-this._rect.height):3==t&&(0==n?(e.x=0,e.y=1.5*-this._rect.height):(e.x=(n-1)*(e.width+this._rect.width/2)-.7*this._rect.width,e.y=1.2*-this._rect.height)),e.setLine()},t}(egret.DisplayObjectContainer);__reflect(BaseActor.prototype,"BaseActor");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,a){function i(e){t.call(a,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}var r=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(a,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(a,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var l=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(a,generateJSON.paths[e])},this):RES.getResByUrl(l,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(a,generateJSON.paths[e])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(a,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var RingScrollView=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.Init=function(e,t){if(3>t)return void console.error("the content at least 3 count");var n=new egret.ScrollView;this.addChild(n),n.height=e.height;for(var a=0;t>a;a++);},t}(egret.DisplayObjectContainer);__reflect(RingScrollView.prototype,"RingScrollView");var RingContent=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.Init=function(){},t.prototype.Update=function(){},t}(egret.DisplayObjectContainer);__reflect(RingContent.prototype,"RingContent");var ScrollView=function(e){function t(){var t=e.call(this)||this;return t.curItemCount=0,t.delayScroll=250,t.spacing=0,t.bScrolling=!1,t}return __extends(t,e),t.prototype.childrenCreated=function(){this.validateNow();var e=this.viewport.contentWidth-this.viewport.width;e>0?(this.isHScroller=!0,this.itemSize=this.viewport.width+this.spacing):(this.isHScroller=!1,this.itemSize=this.viewport.height+this.spacing),this.throwSpeed=0,this.bounces=!0,this.horizontalScrollBar.visible=!1,this.horizontalScrollBar.autoVisibility=!1,this.addEventListener(eui.UIEvent.CHANGE_START,this.onChangeStartHandler,this),this.addEventListener(eui.UIEvent.CHANGE_END,this.onChangeEndHandler,this)},t.prototype.start=function(){this.touchEnabled=!0,this.touchChildren=!0},t.prototype.stop=function(){this.touchEnabled=!1,this.touchChildren=!1},t.prototype.reset=function(e){this.curItemCount=0,this.isHScroller?this.viewport.scrollH=0:this.viewport.scrollV=0,this.m_tag=e},t.prototype.onChangeStartHandler=function(){this.isHScroller?this.touchStartPos=this.viewport.scrollH:this.touchStartPos=this.viewport.scrollV},t.prototype.onChangeEndHandler=function(){if(-1!=this.touchStartPos){var e;e=this.isHScroller?this.viewport.scrollH-this.touchStartPos:this.viewport.scrollV-this.touchStartPos,e>0?this.scrollToNext():0>e&&this.scrollToLast(),this.touchStartPos=-1;for(var t=0;t<this.m_tag.length;t++)this.m_tag[t].source="actorList3_png";this.m_tag[this.curItemCount].source="actorList4_png"}},t.prototype.scrollToNext=function(){if(!this.bScrolling){var e=this.curItemCount;e<this.itemNum-1&&e++,this.scrollToItem(e)}},t.prototype.scrollToLast=function(){if(!this.bScrolling){var e=this.curItemCount;e>0&&e--,this.scrollToItem(e)}},t.prototype.scrollToItem=function(e){var n=this;this.bScrolling||e>=0&&e<this.itemNum&&(this.bScrolling=!0,this.disableTouch(),this.curItemCount=e,egret.Tween.removeTweens(this.viewport),this.isHScroller?egret.Tween.get(this.viewport).to({scrollH:e*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll):egret.Tween.get(this.viewport).to({scrollV:e*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll),egret.Tween.get(this.viewport).wait(this.delayScroll).call(function(){n.bScrolling=!1,n.enableTouch(),n.dispatchEventWith(t.EVENT_SCROLL_COMPLETE,!1,n.curItemCount)},this))},t.prototype.enableTouch=function(){this.touchEnabled=!0,this.touchChildren=!0},t.prototype.disableTouch=function(){this.touchChildren=!1,this.touchEnabled=!1},t.prototype.destroy=function(){},Object.defineProperty(t.prototype,"itemCount",{get:function(){return this.itemNum},set:function(e){this.itemNum=e},enumerable:!0,configurable:!0}),t.EVENT_SCROLL_COMPLETE="EVENT_SCROLL_COMPLETE",t}(eui.Scroller);__reflect(ScrollView.prototype,"ScrollView");var Tips=function(e){function t(){var t=e.call(this)||this;return t._imgBg=new egret.Bitmap,t.addChild(t._imgBg),t._labDesc=new egret.TextField,t.addChild(t._labDesc),t._data=new TipsData,t}return __extends(t,e),t.prototype.init=function(){this._imgBg.visible=!1,this._data.tipsBg.length>0&&(this._imgBg.texture=RES.getRes(this._data.tipsBg),this._imgBg.visible=!0),this._labDesc.textColor=this._data.descColor,this._labDesc.size=this._data.descSize,this._labDesc.textAlign="center",this._labDesc.text=this._data.desc,this._labDesc.bold=!0},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(Tips.prototype,"Tips");var TipsData=function(){function e(){this.tipsBg="",this.desc="",this.descSize=40,this.descColor=Common.TextColors.red}return e}();__reflect(TipsData.prototype,"TipsData");var GameConfig=function(){function e(){}return e.initBattleDragonBones=function(e){var t=RES.getRes(e+"_ske_json"),n=RES.getRes(e+"_tex_json"),a=RES.getRes(e+"_tex_png");DragonBonesFactory.getInstance().initDragonBonesArmatureFile(t,n,a)},e.initSound=function(){GameVoice.beginBGMSound=RES.getRes(GameVoice.beginBGM_mp3),GameVoice.battleBGMSound=RES.getRes(GameVoice.battleBGM_mp3),GameVoice.btnSound=RES.getRes(GameVoice.btn_mp3),GameVoice.ballonBoomSound=RES.getRes(GameVoice.ballonBoom_mp3),GameVoice.burnSound=RES.getRes(GameVoice.burn_mp3),GameVoice.fireBallSound=RES.getRes(GameVoice.fireBall_mp3),GameVoice.iceEffectSound=RES.getRes(GameVoice.iceEffect_mp3),GameVoice.skillBeginSound=RES.getRes(GameVoice.skillBegin_mp3),GameVoice.staffSound=RES.getRes(GameVoice.staff_mp3),GameVoice.combo1Sound=RES.getRes(GameVoice.combo1_mp3),GameVoice.combo2Sound=RES.getRes(GameVoice.combo2_mp3),GameVoice.combo3Sound=RES.getRes(GameVoice.combo3_mp3),GameVoice.combo4Sound=RES.getRes(GameVoice.combo4_mp3),GameVoice.spiderKingArrive=RES.getRes(GameVoice.spiderKingArrive_mp3),GameVoice.spiderKingDrug=RES.getRes(GameVoice.spiderKingDrug_mp3),GameVoice.jiesuanSound=RES.getRes(GameVoice.jiesuan_mp3),GameVoice.readyGoSound=RES.getRes(GameVoice.readyGo_mp3),GameVoice.smallBossSound=RES.getRes(GameVoice.smallBoss_mp3),GameVoice.fallDownWaterSound=RES.getRes(GameVoice.fallDownWater_mp3),GameVoice.bossWarning=RES.getRes(GameVoice.bossWarning_mp3),GameVoice.spideBall=RES.getRes(GameVoice.spideBall_mp3),GameVoice.summon=RES.getRes(GameVoice.summon_mp3),GameVoice.unlockItem=RES.getRes(GameVoice.unlockItem_mp3),GameVoice.battleBefore=RES.getRes(GameVoice.battleBefore_mp3),GameVoice.vectory=RES.getRes(GameVoice.vectory_mp3),GameVoice.rewardBGM=RES.getRes(GameVoice.rewardBGM_mp3),GameVoice.rewardVoice=RES.getRes(GameVoice.rewardVoice_mp3),GameVoice.gestureVoice=RES.getRes(GameVoice.gesture_mp3)},e.init=function(){this.summonConfig=RES.getRes("summonConfig_json"),this.levelConfig=RES.getRes("levelConfig_json"),this.summonSkillConfig=RES.getRes("summonSkillConfig_json");var e=RES.getRes("effectConfig_json");this.effectTable={};for(var t=0;t<e.length;t++){var n=e[t],a={};a.ID=n.ID,a.name=n.name,this.effectTable[n.ID.toString()]=a,this.initBattleDragonBones(n.name)}this.monsterConfig=RES.getRes("monsterConfig_json"),this.gestureConfig=RES.getRes("gesture_json"),this.luckyConfig=RES.getRes("luckyConfig_json"),this.luckyTable={};for(var t=0;t<this.luckyConfig.length;t++){var n=this.luckyConfig[t],a={};a.ID=n.ID,a.Type=n.Type,a.Animation=n.Animation,a.Speed=n.Speed,a.Score=n.Score,a.Power=n.Power,a.Scale=n.Scale,a.Width=n.Width,a.Height=n.Height,a.Prob=n.Prob,a.balloon=n.balloon,this.luckyTable[n.ID.toString()]=a,null!=n.Animation&&""!=n.Animation&&this.initBattleDragonBones(n.Animation)}this.gestureTable={};for(var t=0;t<this.gestureConfig.length;t++){var n=this.gestureConfig[t],a={};a.difficult=n.difficult,a.type=n.type,a.data=n.data,a.count=n.count,a.path=n.path,a.balloon=n.balloon,a.color=n.color,this.gestureTable[n.type.toString()]=a}this.monsterTable={};for(var t=0;t<this.monsterConfig.length;t++){var n=this.monsterConfig[t],a={};a.ID=n.ID,a.Type=n.Type,a.Difficult=n.Difficult,a.Animation=n.Animation,a.Actions=n.Actions,a.Speed=n.Speed,a.Score=n.Score,a.Power=n.Power,a.Scale=n.Scale,a.Width=n.Width,a.Height=n.Height,a.BalloonScale=n.BalloonScale,a.BalloonX=n.BalloonX,a.BalloonY=n.BalloonY,this.monsterTable[n.ID.toString()]=a,null!=n.Animation&&""!=n.Animation&&this.initBattleDragonBones(n.Animation)}this.initConfig(),this.initSound(),Common.getGuide()},e.initConfig=function(){this.summonTable={};for(var e=0;e<this.summonConfig.length;e++){var t=this.summonConfig[e],n={};n.ID=t.ID,n.Type=t.Type,n.Actions=t.Actions,n.Animation=t.Animation,n.Speed=t.Speed,n.Score=t.Score,n.Power=t.Power,n.Scale=t.Scale,n.Width=t.Width,n.Height=t.Height,this.summonTable[t.ID.toString()]=n}this.levelTable={};for(var e=0;e<this.levelConfig.length;e++){var t=this.levelConfig[e],n={};n.key=t.key,n.next=t.next,n.addTime=t.addTime,n.speed=t.speed,n.normalCount=t.normalCount,n.candy=t.candy,n.unlockItem=t.unlockItem,n.normal=t.normal,n.elite=t.elite,n.section=t.section,n.level=t.level,null!=t.key&&t.key>0&&(this.levelTable[t.key.toString()]=n)}this.summonSkillTable={};for(var e=0;e<this.summonSkillConfig.length;e++){var t=this.summonSkillConfig[e],n={};n.id=t.id,n.type=t.type,n.diff=t.diff,n.key=t.key,n.max=t.max,n.min=t.min,n.count=t.count,n.ids=t.ids,this.summonSkillTable[t.key.toString()]=n}this.actorConfig=RES.getRes("actorConfig_json"),this.actorTable={},this.babyOpenList.length=0;for(var e=0;e<this.actorConfig.length;e++){var t=this.actorConfig[e],n={};n.id=t.id,n.level=t.level,n.nextId=t.nextId,n.quality=t.quality,n.weight=t.weight,n.candy=t.candy,n.name=t.name,n.unlockDesc=t.unlockDesc,n.desc=t.desc,n.action=t.action,n.icon=t.icon,n.lockIcon=t.lockIcon,n.direction=t.direction,n.skillId=t.skillId,n.fusion=t.fusion,n.range=0,t.level<=1&&this.babyOpenList.push(t.id),this.actorTable[t.id.toString()]=n,null!=t.action&&""!=t.action&&this.initBattleDragonBones(t.action)}for(var e=0;e<this.babyOpenList.length;e++)for(var a=this.babyOpenList[e],i=0;i<this.babyUnlockList.length;i++){var o=this.babyUnlockList[i],r=this.actorTable[o.toString()].level;if(r>=2&&o-r-1==a){this.babyOpenList[e]=o;break}}this.curBabyData=this.actorTable[this.curBaby.toString()],this.chapterConfig=RES.getRes("chapterConfig_json"),this.chapterTable={};for(var e=0;e<this.chapterConfig.length;e++){var t=this.chapterConfig[e],n={};n.id=t.id,n.name=t.name,n.icon=t.icon,n.unlockIcon=t.unlockIcon,n.bg=t.bg,n.bgm=t.bgm,n.begin=t.begin,n.sun=t.sun,n.cloud1=t.cloud1,n.cloud2=t.cloud2,n.water=t.water,this.chapterTable[t.id.toString()]=n}var s=RES.getRes("babySkillConfig_json");this.babySkillTable={};for(var e=0;e<s.length;e++){var t=s[e],n={};n.id=t.id,n.skillFile=t.skillFile,n.skillHang=t.skillHang,n.boss=t.boss,n.auto=t.auto,n.param=t.param,n.skillPosX=t.skillPosX,n.range=t.range,n.result=t.result,n.time=t.time,n.skill=t.skill,n.method=t.method,n.sceneEffect=t.sceneEffect,n.skillPosY=t.skillPosY,n.rangeType=t.rangeType,n.music=t.music,n.scale=t.scale,this.babySkillTable[t.id.toString()]=n}this.signConfig=RES.getRes("signConfig_json"),this.signTable={};for(var e=0;e<this.signConfig.length;e++){var t=this.signConfig[e],n={};n.id=t.id,n.name=t.name,n.desc=t.desc,n.boss=t.boss,n.rewardType=t.rewardType,n.reward=t.reward,n.icon=t.icon,n.isGet=!1,e<this.signCount&&(n.isGet=!0),e==this.signCount&&1==this.sign&&(n.isGet=!0),this.signTable[t.id.toString()]=n}this.capsuleConfig=RES.getRes("capsuleConfig_json"),this.capsuleTable={};for(var e=0;e<this.capsuleConfig.length;e++){var t=this.capsuleConfig[e],n={};n.id=t.id,n.type=t.type,n.value=t.value,n.weight=t.weight,n.range=0,this.capsuleTable[t.id.toString()]=n}},e.game="HT",e.isWebView=!0,e.baseFallSpeed=.1,e.monsterAddDelay=2e3,e.luckyActorAddDelay=23e3,e.slowDuration=3e3,e.comboDelay=1e3,e.spiderDelay=4e3,e.bgmValue=100,e.soundValue=100,e.monsterPos=1,e.gameSpeedPercent=0,e.isGuide=!1,e.babyOpenList=new Array,e.gameMode=EBattleMode.Level,e.sign=0,e.signCount=0,e.curBattleChapter=0,e.sceneType=0,e}();__reflect(GameConfig.prototype,"GameConfig");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function a(a){t.call(n,a,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?a(i):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameTips=function(){function e(){}return e.test="测试提示",e}();__reflect(GameTips.prototype,"GameTips");var GameVoice;!function(e){e.btn_mp3="btn_mp3",e.ballonBoom_mp3="ballonBoom_mp3",e.battleBGM_mp3="battleBGM_mp3",e.beginBGM_mp3="beginBGM_mp3",e.burn_mp3="burn_mp3",e.fireBall_mp3="fireBall_mp3",e.iceEffect_mp3="iceEffect_mp3",e.skillBegin_mp3="skillBegin_mp3",e.staff_mp3="staff_mp3",e.combo1_mp3="combo1_mp3",e.combo2_mp3="combo2_mp3",e.combo3_mp3="combo3_mp3",e.combo4_mp3="combo4_mp3",e.spiderKingArrive_mp3="spiderKingArrive_mp3",e.spiderKingDrug_mp3="spiderKingDrug_mp3",e.jiesuan_mp3="jiesuan_mp3",e.readyGo_mp3="readyGo_mp3",e.smallBoss_mp3="smallBoss_mp3",e.fallDownWater_mp3="fallDownWater_mp3",e.bossWarning_mp3="bossWarning_mp3",e.spideBall_mp3="spideBall_mp3",e.summon_mp3="summon_mp3",e.unlockItem_mp3="unlockItem_mp3",e.battleBefore_mp3="battleBefore_mp3",e.vectory_mp3="vectory_mp3",e.rewardBGM_mp3="choujiang_mp3",e.rewardVoice_mp3="choujiangBg_mp3",e.gesture_mp3="gesture_mp3",e.beginBGMSound=null,e.beginBGMChannel=null,e.battleBGMSound=null,e.battleBGMChannel=null,e.btnSound=null,e.ballonBoomSound=null,e.burnSound=null,e.fireBallSound=null,e.iceEffectSound=null,e.skillBeginSound=null,e.staffSound=null,e.combo1Sound=null,e.combo2Sound=null,e.combo3Sound=null,e.combo4Sound=null,e.spiderKingArrive=null,e.spiderKingDrug=null,e.jiesuanSound=null,e.readyGoSound=null,e.smallBossSound=null,e.fallDownWaterSound=null,e.bossWarning=null,e.spideBall=null,e.summon=null,e.unlockItem=null,e.battleBefore=null,e.vectory=null,e.rewardBGM=null,e.rewardVoice=null,e.gestureVoice=null}(GameVoice||(GameVoice={}));var MainNotify;!function(e){e.openGameStartPanel="openGameStartPanel",e.closeGameStartPanel="closeGameStartPanel",e.openGamePanel="openGamePanel",e.closeGamePanel="closeGamePanel",e.openGameOverPanel="openGameOverPanel",e.closeGameOverPanel="closeGameOverPanel",e.gestureAction="gestureAction",e.beginLocus="beginLocus",e.endLocus="endLocus",e.updateCandy="updateCandy",e.openSettingPanel="openSettingPanel",e.closeSettingPanel="closeSettingPanel",e.openGamePausePanel="openGamePausePanel",e.closeGamePausePanel="closeGamePausePanel",e.openActorListPanel="openActorListPanel",e.closeActorListPanel="closeActorListPanel",e.openGameSelectLevel="openGameSelectLevel",e.closeGameSelectLevel="closeGameSelectLevel",e.openRechargePanel="openRechargePanel",e.closeRechargePanel="closeRechargePanel",e.openSignPanel="openSignPanel",e.closeSignPanel="closeSignPanel",e.openCapsulePanel="openCapsulePanel",e.closeCapsulePanel="closeCapsulePanel",e.openGetRewardPanel="openGetRewardPanel",e.closeGetRewardPanel="closeGetRewardPanel"}(MainNotify||(MainNotify={}));var DragonBonesAnimations=function(){function e(){}return e.Idle="idle",e.Dead="dead",e.Run="run",e.Hurt="hurt",e.Explore="explore",e.Arrive="arrive",e.Attack="attack",e.ReadyFall="readyFall",e.Move="move",e}();__reflect(DragonBonesAnimations.prototype,"DragonBonesAnimations");var DragonBonesArmature=function(e){function t(t){var n=e.call(this)||this;return n._armature=t.armature,n._armatureDisplay=t,n.addChild(n._armatureDisplay),n._frameCalls=[],n._completeCalls=[],n._tagetBones=[],n}return __extends(t,e),t.prototype.addListeners=function(){null!=this._armatureDisplay&&(this._armatureDisplay.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onComplete,this),this._armatureDisplay.addEventListener(dragonBones.EventObject.FRAME_EVENT,this.onFrame,this))},t.prototype.removeLiteners=function(){null!=this._armatureDisplay&&(this._armatureDisplay.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onComplete,this),this._armatureDisplay.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this.onFrame,this))},t.prototype.addCompleteCallFunc=function(e,t){for(var n=0;n<this._completeCalls.length;n++)if(this._completeCalls[n][0]==e&&this._completeCalls[n][1]==t)return;this._completeCalls.push([e,t])},t.prototype.removeCompleteCallFunc=function(e,t){for(var n=0;n<this._completeCalls.length;n++){var a=this._completeCalls[n];a[0]==e&&a[1]==t&&this._completeCalls.splice(n,1)}},t.prototype.addFrameCallFunc=function(e,t){for(var n=0;n<this._frameCalls.length;n++)if(this._frameCalls[n][0]==e&&this._frameCalls[n][1]==t)return;this._frameCalls.push([e,t])},t.prototype.removeFrameCallFunc=function(e,t){for(var n=0;n<this._frameCalls.length;n++)this._frameCalls[n][0]==e&&this._frameCalls[n][1]==t&&this._frameCalls.splice(n,1)},t.prototype.getBone=function(e,t){for(var n=0;n<this._tagetBones.length;n++)if(this._tagetBones[n][0]==e&&this._tagetBones[n][1]==t)return null;return this._tagetBones.push([e,t]),this._armature.getBone(e)},t.prototype.onComplete=function(e){for(var t=0;t<this._completeCalls.length;t++){var n=this._completeCalls[t];n[0].call(n[1])}},t.prototype.onFrame=function(e){for(var t=0;t<this._frameCalls.length;t++){var n=this._frameCalls[t];n[0].call(n[1],e)}},t.prototype.getSlots=function(){return this._armature.getSlots()},t.prototype.getSlot=function(e){return this._armature.getSlot(e)},t.prototype.play=function(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=1),this.start(),void 0==t?this._armatureDisplay.animation.play(e).timeScale=n:this._armatureDisplay.animation.play(e,t).timeScale=n},t.prototype.playByFrame=function(e,t,n,a){void 0===a&&(a=1),this.start(),void 0==n?this._armatureDisplay.animation.gotoAndPlayByFrame(e,t).timeScale=a:this._armatureDisplay.animation.gotoAndPlayByFrame(e,t,n).timeScale=a},t.prototype.fadeIn=function(e,t,n,a,i){this._armatureDisplay.animation.fadeIn(e,t,n,a,i,2)},t.prototype.pause=function(e){this._armatureDisplay.animation.stop(e)},t.prototype.setTimeScale=function(e,t){this._armatureDisplay.animation.play(e).timeScale=t},t.prototype.setDBTimeScale=function(e){this._armatureDisplay.animation.timeScale=e},t.prototype.stopByFrame=function(e,t){this.start(),this._armature.animation.gotoAndStopByProgress(e,t)},t.prototype.playMuti=function(e,t,n){void 0===n&&(n=null),this.start();for(var a=0;a<e.length;a++);},t.prototype.fadeOut=function(e){var t=this._armatureDisplay.animation.getState(e);
t.fadeOut(0,!1)},t.prototype.getState=function(e){return this._armatureDisplay.animation.getState(e)},t.prototype.start=function(){this.addListeners()},t.prototype.stop=function(){this.removeLiteners()},t.prototype.removeArmatureDisplay=function(){this.removeLiteners(),null!=this._armatureDisplay&&this.removeChild(this._armatureDisplay),this._armatureDisplay=null},Object.defineProperty(t.prototype,"Armature",{get:function(){return this._armature},set:function(e){this._armature=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ArmatureDisplay",{get:function(){return this._armatureDisplay},set:function(e){this._armatureDisplay=e,this._armature=e.armature,this.addChild(this._armatureDisplay)},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(DragonBonesArmature.prototype,"DragonBonesArmature");var DragonBonesArmatureContainer=function(e){function t(){var t=e.call(this)||this;return t._armatures=new Array,t._actions={},t._bones={},t}return __extends(t,e),t.prototype.get_armatures=function(){return this._armatures},t.prototype.register=function(e,t){this._armatures.push(e);for(var n=0;n<t.length;n++)this._actions[t[n]]=this._armatures.length-1},t.prototype.clear=function(){for(;this._armatures.length>0;){var e=this._armatures.pop();e.removeArmatureDisplay()}this._actions={},this._bones={}},t.prototype.addCompleteCallFunc=function(e,t){for(var n=0;n<this._armatures.length;n++){var a=this._armatures[n];a.addCompleteCallFunc(e,t)}},t.prototype.removeCompleteCallFunc=function(e,t){for(var n=0;n<this._armatures.length;n++){var a=this._armatures[n];a.removeCompleteCallFunc(e,t)}},t.prototype.addFrameCallFunc=function(e,t){for(var n=0;n<this._armatures.length;n++){var a=this._armatures[n];a.addFrameCallFunc(e,t)}},t.prototype.removeFrameCallFunc=function(e,t){for(var n=0;n<this._armatures.length;n++){var a=this._armatures[n];a.removeFrameCallFunc(e,t)}},t.prototype.getBone=function(e,t,n){var a=e+t;if(!this._bones[a])for(var i=0;i<this._armatures.length;i++){var o=this._armatures[i],r=o.getBone(t,n);if(null!=r){this._bones[a]=r;break}}return this._bones[a]},t.prototype.getSlots=function(){this._armatures[0].getSlots()},t.prototype.getState=function(e){if(null==this._actions[e])return void Common.log("不存在动作---->"+e+typeof e);var t=this._actions[e],n=this._armatures[t];return n?(this._curArmatureIndex=t,n.getState(e)):null},t.prototype.play=function(e,t,n,a,i){if(void 0===t&&(t=void 0),void 0===n&&(n=1),void 0===a&&(a=null),void 0===i&&(i=1),null==this._actions[e])return void Common.log("play不存在动作---->"+e);var o=this._actions[e];o!=this._curArmatureIndex&&this.remove();var r=this._armatures[o];r&&(this.addChild(r),this._curArmatureIndex=o,1==n?r.play(e,t,i):r.playByFrame(e,a,t,i))},t.prototype.setTimeScale=function(e,t){if(null==this._actions[e])return void Common.log("不存在动作---->"+e+typeof e);var n=this._actions[e];n!=this._curArmatureIndex&&this.remove();var a=this._armatures[n];a&&(this.addChild(a),this._curArmatureIndex=n,a.setTimeScale(e,t))},t.prototype.setDBTimeScale=function(e){},t.prototype.fadeIn=function(e,t,n,a,i){if(null!=this._actions[e]){var o=this._actions[e];o!=this._curArmatureIndex&&this.remove();var r=this._armatures[o];r&&(this.addChild(r),this._curArmatureIndex=o,r.fadeIn(e,t,n,a,i))}},t.prototype.pause=function(e){var t=this._armatures[this._curArmatureIndex];t&&t.pause(e)},t.prototype.stop=function(){var e=this._armatures[this._curArmatureIndex];e&&e.stop()},t.prototype.stopByFrame=function(e,t){var n=this._armatures[this._curArmatureIndex];if(n)n.stopByFrame(e,t);else{var a=this._actions[e];n=this._armatures[a],n.stopByFrame(e,t)}},t.prototype.remove=function(){var e=this._armatures[this._curArmatureIndex];e&&(e.stop(),e.parent.removeChild(e),this._curArmatureIndex=null)},Object.defineProperty(t.prototype,"curArmatureIndex",{set:function(e){this._curArmatureIndex=e},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(DragonBonesArmatureContainer.prototype,"DragonBonesArmatureContainer");var DragonBonesFactory=function(){function e(){this._factory=new dragonBones.EgretFactory,this._clocks=new Array,this._clockLen=0}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.addTextureAtlas=function(e,t){return this._factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(e,t))},e.prototype.initDragonBonesArmatureFile=function(e,t,n){this._factory.parseDragonBonesData(e),this._factory.parseTextureAtlasData(t,n)},e.prototype.buildArmature=function(e,t){return this._factory.buildArmature(e,t)},e.prototype.buildArmatureDisplay=function(e,t){return this._factory.buildArmatureDisplay(e,t)},e.prototype.createWorldClock=function(e){for(var t=0;t<this._clockLen;t++)if(this._clocks[t].timeScale==e)return this._clocks[t];var n=new dragonBones.WorldClock;return n.timeScale=e,this._clocks.push(n),this._clockLen=this._clocks.length,n},e.prototype.update=function(e){this.onStartTick(e)},e.prototype.onStartTick=function(e){for(var t=0;t<this._clocks.length;t++){var n=this._clocks[t];n.advanceTime(.001)}return!1},e.prototype.stopTimer=function(){egret.stopTick(this.onStartTick,this)},e}();__reflect(DragonBonesFactory.prototype,"DragonBonesFactory");var GameManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return null==this._Instance&&(this._Instance=new t),this._Instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){GameConfig.init(),PanelManager.initPanel(),this._permanentUI=new PermanentUI,Common.gameScene().uiLayer.addChild(this._permanentUI),this._gameState=EGameState.Ready,Common.dispatchEvent(MainNotify.openGameStartPanel)},t.prototype.stop=function(){this._gameState==EGameState.Start&&(this._gameState=EGameState.End,PanelManager.gameScenePanel.exit(),ShakeTool.getInstance().shakeObj(t.Instance.imageScene,5,4,10,this._onshake,this))},t.prototype.endLevel=function(){this._gameState==EGameState.Start&&(this._gameState=EGameState.EndLevel,PanelManager.gameScenePanel.exit(),Common.dispatchEvent(MainNotify.openGameOverPanel))},t.prototype.start=function(){this._time=0,this._gameState=EGameState.Start,this._startTime=egret.getTimer(),this._lastTime=this._startTime,this._gameSlowDelay=-1},t.prototype.pause=function(e){void 0===e&&(e=!1),this._gameState=EGameState.Pause,e||Common.dispatchEvent(MainNotify.openGamePausePanel)},t.prototype.stageToBack=function(){this._gameState==EGameState.Start&&t.Instance.pause()},t.prototype.stageToFront=function(){},t.prototype["continue"]=function(){this._gameState=EGameState.Start,this._startTime=egret.getTimer(),this._lastTime=this._startTime},t.prototype.gameSlow=function(){this._gameSlowDelay=0},Object.defineProperty(t.prototype,"imageScene",{get:function(){return this._permanentUI.sceneBg},enumerable:!0,configurable:!0}),t.prototype.updateSceneBg=function(e,t){this._permanentUI.updateScene(e,t)},t.prototype.updateSceneSun=function(e){this._permanentUI.updateSun(e)},t.prototype.updateSceneCloud=function(e,t){this._permanentUI.updateCloud(e,t)},t.prototype.update=function(){if(this._gameState!=EGameState.StageBack){null!=this._permanentUI&&this._permanentUI.update(),this._startTime=egret.getTimer();var e=this._startTime-this._lastTime;if(null!=PanelManager.capsulePanel&&PanelManager.capsulePanel.update(e),this._gameState==EGameState.Ready)return void(this._lastTime=this._startTime);this._gameSlowDelay>=0&&(this._gameSlowDelay+=e,e*=.4,this._gameSlowDelay>=1e3&&(this._gameSlowDelay=-1)),null!=PanelManager.gameScenePanel&&PanelManager.gameScenePanel.update(e),DragonBonesFactory.getInstance().update(e),this._lastTime=this._startTime}},Object.defineProperty(t.prototype,"gameState",{get:function(){return this._gameState},set:function(e){this._gameState=e},enumerable:!0,configurable:!0}),t.prototype._onshake=function(){this._gameState==EGameState.End&&Common.dispatchEvent(MainNotify.openGameOverPanel)},t}(egret.Sprite);__reflect(GameManager.prototype,"GameManager");var PanelManager;!function(e){function t(){null==e.gameStartPanel&&(e.gameStartPanel=new GameStartPanel),e.gameStartPanel.onEnter()}function n(){null!=e.gameStartPanel&&e.gameStartPanel.onExit()}function a(){null==e.gameScenePanel&&(e.gameScenePanel=new GameScenePanel),e.gameScenePanel.onEnter()}function i(){null!=e.gameScenePanel&&e.gameScenePanel.onExit()}function o(){null==e.settingPanel&&(e.settingPanel=new SettingPanel),e.settingPanel.onEnter()}function r(){null!=e.settingPanel&&e.settingPanel.onExit()}function s(){null==e.gameOverPanel&&(e.gameOverPanel=new GameOverPanel),e.gameOverPanel.onEnter()}function l(){null!=e.gameOverPanel&&e.gameOverPanel.onExit()}function h(){null==e.gamePausetPanel&&(e.gamePausetPanel=new GamePausePanel),e.gamePausetPanel.onEnter()}function u(){null!=e.gamePausetPanel&&e.gamePausetPanel.onExit()}function m(){null==e.actorListPanel&&(e.actorListPanel=new ActorListPanel),e.actorListPanel.onEnter()}function c(){null!=e.actorListPanel&&e.actorListPanel.onExit()}function g(){null==e.gameSelectLevel&&(e.gameSelectLevel=new GameSelectLevel),e.gameSelectLevel.onEnter()}function p(){null!=e.gameSelectLevel&&e.gameSelectLevel.onExit()}function d(){null==e.rechargePanel&&(e.rechargePanel=new RechargeUI),e.rechargePanel.onEnter()}function _(){null!=e.rechargePanel&&e.rechargePanel.onExit()}function f(){null==e.signPanel&&(e.signPanel=new SignPanel),e.signPanel.onEnter()}function y(){null!=e.signPanel&&e.signPanel.onExit()}function C(){null==e.capsulePanel&&(e.capsulePanel=new CapsulePanel),e.capsulePanel.onEnter()}function v(){null!=e.capsulePanel&&e.capsulePanel.onExit()}function b(){null==e.getRewardPanel&&(e.getRewardPanel=new GetRewardUI),e.getRewardPanel.onEnter()}function S(){null!=e.getRewardPanel&&e.getRewardPanel.onExit()}function E(){Common.addEventListener(MainNotify.openGameStartPanel,t,e),Common.addEventListener(MainNotify.closeGameStartPanel,n,e),Common.addEventListener(MainNotify.openGamePanel,a,e),Common.addEventListener(MainNotify.closeGamePanel,i,e),Common.addEventListener(MainNotify.openSettingPanel,o,e),Common.addEventListener(MainNotify.closeSettingPanel,r,e),Common.addEventListener(MainNotify.openGameOverPanel,s,e),Common.addEventListener(MainNotify.closeGameOverPanel,l,e),Common.addEventListener(MainNotify.openGamePausePanel,h,e),Common.addEventListener(MainNotify.closeGamePausePanel,u,e),Common.addEventListener(MainNotify.openActorListPanel,m,e),Common.addEventListener(MainNotify.closeActorListPanel,c,e),Common.addEventListener(MainNotify.openGameSelectLevel,g,e),Common.addEventListener(MainNotify.closeGameSelectLevel,p,e),Common.addEventListener(MainNotify.openRechargePanel,d,e),Common.addEventListener(MainNotify.closeRechargePanel,_,e),Common.addEventListener(MainNotify.openSignPanel,f,e),Common.addEventListener(MainNotify.closeSignPanel,y,e),Common.addEventListener(MainNotify.openCapsulePanel,C,e),Common.addEventListener(MainNotify.closeCapsulePanel,v,e),Common.addEventListener(MainNotify.openGetRewardPanel,b,e),Common.addEventListener(MainNotify.closeGetRewardPanel,S,e)}e.initPanel=E}(PanelManager||(PanelManager={}));var ETipsType;!function(e){e[e.None=1]="None",e[e.DownToUp=2]="DownToUp"}(ETipsType||(ETipsType={}));var TipsManager;!function(e){function t(e,t,n,i,o,r,s){void 0===t&&(t=Common.TextColors.red),void 0===n&&(n=ETipsType.DownToUp),void 0===i&&(i=40),void 0===o&&(o=""),void 0===r&&(r=Config.stageHalfWidth),void 0===s&&(s=Config.stageHalfHeight);var l=GameObjectPool.getInstance().createObject(Tips,"Tips");switch(l.data.desc=e,l.data.descColor=t,l.data.descSize=i,l.data.tipsBg=o,l.init(),l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=r,l.y=s-200,a.push(l),Common.gameScene().tipsLayer.addChild(l),n){case ETipsType.None:l.alpha=0,egret.Tween.get(l).to({alpha:1},300).call(this.removeTips,this);break;case ETipsType.DownToUp:l.alpha=0,l.y+=l.height,egret.Tween.get(l).to({alpha:1,y:l.y-l.height},500,egret.Ease.backOut).call(this.removeTips,this)}}function n(){if(null!=a&&a.length>0){var e=function(){var e=a.pop();Common.gameScene().tipsLayer.contains(e)&&(Common.gameScene().tipsLayer.removeChild(e),GameObjectPool.getInstance().destroyObject(e))};egret.Tween.get(a).to({alpha:0},300).call(e,this)}}var a=[];e.show=t,e.removeTips=n}(TipsManager||(TipsManager={}));var Bullet=function(e){function t(){var t=e.call(this)||this;return t._armatureContainer=new DragonBonesArmatureContainer,t.addChild(t._armatureContainer),t}return __extends(t,e),t.prototype.Init=function(e,t,n){this.m_target=e;var a=DragonBonesFactory.getInstance().buildArmatureDisplay(t,t);null==this._armature&&(this._armature=new DragonBonesArmature(a)),this._armature.ArmatureDisplay=a,this._armatureContainer.register(this._armature,[t]),this._armatureContainer.play(t,0),this.m_isDead=!1,this._type=n},t.prototype.destroy=function(){this.m_isDead=!0,this._armatureContainer.clear(),GameObjectPool.getInstance().destroyObject(this)},t.prototype.update=function(e){if(!this.m_isDead){var t=this.m_target.y-this.m_target.h/2;this.m_radian=MathUtils.getRadian2(this.x,this.y,this.m_target.x,t),this.rotation=MathUtils.getAngle(this.m_radian)+90;var n=MathUtils.getDistance(this.m_target.x,t,this.x,this.y);if(140>=n){if(this.destroy(),PanelManager.gameScenePanel.removeBullet(this),this._type==EEffectType.Fire){var a=GameVoice.burnSound.play(0,1);a.volume=GameConfig.soundValue/100}}else{var i=2*e,o=Math.cos(this.m_radian)*i,r=Math.sin(this.m_radian)*i,s=parseFloat(o.toFixed(2)),l=parseFloat(r.toFixed(2));this.x+=s,this.y+=l}}},t}(egret.DisplayObjectContainer);__reflect(Bullet.prototype,"Bullet");var SkillBase=function(){function e(){}return e}();__reflect(SkillBase.prototype,"SkillBase");var Common;!function(e){function t(){return null==e.curScene&&(e.curScene=new GameScene),e.curScene}function n(){GameVoice.btnSound.play(0,1).volume=GameConfig.soundValue/100}function a(t){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n,e)}function i(t){var n=!1,a=new Date,i=new Date(t);if(null!=a&&null!=i){var r=a.getFullYear(),s=i.getFullYear(),l=a.getMonth(),h=i.getMonth(),u=a.getDate(),m=i.getDate();r==s&&l==h&&u==m&&(n=!0);var c=o(a);e.updatelastLoginTime(c)}return n}function o(e){var t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate();return t+"/"+n+"/"+a}function r(){egret.ExternalInterface.addCallback("sendToEgret",function(e){GameConfig.account=e}),egret.ExternalInterface.call("read",GameConfig.game+"account")}function s(e){GameConfig.account=e,egret.ExternalInterface.call("write",GameConfig.game+"account:"+e)}function l(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"maxScore");null==e?GameConfig.maxScore=0:GameConfig.maxScore=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.maxScore=parseInt(e):GameConfig.maxScore=0}),egret.ExternalInterface.call("read",GameConfig.game+"maxScore")}function h(e){e>GameConfig.maxScore&&(GameConfig.maxScore=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"maxScore",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"maxScore:"+e))}function u(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"guideIndex");null==e?GameConfig.guideIndex=0:GameConfig.guideIndex=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.guideIndex=parseInt(e):GameConfig.guideIndex=0}),egret.ExternalInterface.call("read",GameConfig.game+"guideIndex")}function m(e){GameConfig.guideIndex=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"guideIndex",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"guideIndex:"+e)}function c(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"maxCombo");null==e?GameConfig.maxCombo=0:GameConfig.maxCombo=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.maxCombo=parseInt(e):GameConfig.maxCombo=0}),egret.ExternalInterface.call("read",GameConfig.game+"maxCombo")}function g(e){e>GameConfig.maxCombo&&(GameConfig.maxCombo=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"maxCombo",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"maxCombo:"+e))}function p(e){GameConfig.isWebView||egret.ExternalInterface.call("gameScore",e.toString())}function d(){if(GameConfig.isWebView){var t=NativeApi.getLocalData(GameConfig.game+"babyUnlockList");null==t?(GameConfig.babyUnlockList=new Array,GameConfig.babyUnlockList.push(10010),e.updateUnlockBaby()):GameConfig.babyUnlockList=JSON.parse(t)}else egret.ExternalInterface.addCallback("sendToEgret",function(t){null!=t&&t.length>0?GameConfig.babyUnlockList=JSON.parse(t):(GameConfig.babyUnlockList=new Array,GameConfig.babyUnlockList.push(10010),e.updateUnlockBaby())}),egret.ExternalInterface.call("read",GameConfig.game+"babyUnlockList")}function _(){if(GameConfig.babyUnlockList.length>0){var e=JSON.stringify(GameConfig.babyUnlockList);GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"babyUnlockList",e):egret.ExternalInterface.call("write",GameConfig.game+"babyUnlockList:"+e)}}function f(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"curBaby");null==e?GameConfig.curBaby=10010:GameConfig.curBaby=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.curBaby=parseInt(e):GameConfig.curBaby=10010}),egret.ExternalInterface.call("read",GameConfig.game+"curBaby")}function y(e){GameConfig.curBaby=e,GameConfig.curBabyData=GameConfig.actorTable[e.toString()],GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"curBaby",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"curBaby:"+e)}function C(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"curChpter");null==e?GameConfig.curChpter=1001:GameConfig.curChpter=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.curChpter=parseInt(e):GameConfig.curChpter=1001}),egret.ExternalInterface.call("read",GameConfig.game+"curChpter")}function v(e){GameConfig.curChpter=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"curChpter",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"curChpter:"+e)}function b(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"curLevel");null==e?GameConfig.curLevel=0:GameConfig.curLevel=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.curLevel=parseInt(e):GameConfig.curLevel=0}),egret.ExternalInterface.call("read",GameConfig.game+"curLevel")}function S(e){GameConfig.curLevel=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"curLevel",e.toString()):egret.ExternalInterface.call("write",GameConfig.game+"curLevel:"+e)}function E(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"candy");null==e?GameConfig.candy=0:GameConfig.candy=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.candy=parseInt(e):GameConfig.candy=0}),egret.ExternalInterface.call("read",GameConfig.game+"candy")}function G(e){GameConfig.candy+=e,GameConfig.candy=Math.max(0,GameConfig.candy),GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"candy",GameConfig.candy.toString()):egret.ExternalInterface.call("write",GameConfig.game+"candy:"+GameConfig.candy)}function A(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"lastLoginTime");if(null==e){var t=new Date;GameConfig.lastLoginTime=o(t)}else GameConfig.lastLoginTime=e}else egret.ExternalInterface.addCallback("sendToEgret",function(e){if(null!=e&&e.length>0)GameConfig.lastLoginTime=e;else{var t=new Date;GameConfig.lastLoginTime=o(t)}}),egret.ExternalInterface.call("read",GameConfig.game+"lastLoginTime")}function D(e){GameConfig.lastLoginTime=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"lastLoginTime",e):egret.ExternalInterface.call("write",GameConfig.game+"lastLoginTime:"+e)}function P(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"sign");null==e?GameConfig.sign=0:GameConfig.sign=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.sign=parseInt(e):GameConfig.sign=0}),egret.ExternalInterface.call("read",GameConfig.game+"sign")}function w(e){GameConfig.sign=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"sign",GameConfig.sign.toString()):egret.ExternalInterface.call("write",GameConfig.game+"sign:"+GameConfig.sign)}function B(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"babylistIndex");null==e?GameConfig.babylistIndex=0:GameConfig.babylistIndex=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.babylistIndex=parseInt(e):GameConfig.babylistIndex=0}),egret.ExternalInterface.call("read",GameConfig.game+"babylistIndex")}function R(e){GameConfig.babylistIndex=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"babylistIndex",GameConfig.babylistIndex.toString()):egret.ExternalInterface.call("write",GameConfig.game+"babylistIndex:"+GameConfig.babylistIndex)}function T(){if(GameConfig.isWebView){var e=NativeApi.getLocalData(GameConfig.game+"signCount");null==e?GameConfig.signCount=0:GameConfig.signCount=parseInt(e)}else egret.ExternalInterface.addCallback("sendToEgret",function(e){null!=e&&e.length>0?GameConfig.signCount=parseInt(e):GameConfig.signCount=0}),egret.ExternalInterface.call("read",GameConfig.game+"signCount")}function M(e){GameConfig.signCount=e,GameConfig.isWebView?NativeApi.setLocalData(GameConfig.game+"signCount",GameConfig.signCount.toString()):egret.ExternalInterface.call("write",GameConfig.game+"signCount:"+GameConfig.signCount)}e.gameScene=t,e.addTouchBegin=a,e.isTowDataSame=i,e.getCurDateString=o,e.getAccount=r,e.updateAccount=s,e.getMaxScore=l,e.updateMaxScore=h,e.getGuide=u,e.updateGuide=m,e.getMaxCombo=c,e.updateMaxCombo=g,e.updateCurrentScore=p,e.getUnlockBaby=d,e.updateUnlockBaby=_,e.getCurBaby=f,e.updateCurBaby=y,e.getCurChpter=C,e.updateCurChpter=v,e.getCurLevel=b,e.updateCurLevel=S,e.getCurCandy=E,e.updateCurCandy=G,e.getlastLoginTime=A,e.updatelastLoginTime=D,e.getSign=P,e.updateSign=w,e.getBabylistIndex=B,e.updateBabylistIndex=R,e.getSignCount=T,e.updateSignCount=M}(Common||(Common={}));var GameScene=function(e){function t(){var t=e.call(this)||this;return t.uiLayer=new egret.DisplayObjectContainer,t.topLayer=new egret.DisplayObjectContainer,t.effectLayer=new egret.DisplayObjectContainer,t.mainUILayer=new egret.DisplayObjectContainer,t.maskLayer=new egret.DisplayObjectContainer,t.tipsLayer=new egret.DisplayObjectContainer,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.addChild(this.uiLayer),this.addChild(this.topLayer),this.addChild(this.effectLayer),this.addChild(this.mainUILayer),this.addChild(this.maskLayer),this.addChild(this.tipsLayer)},t}(egret.DisplayObjectContainer);__reflect(GameScene.prototype,"GameScene");var Gesture=function(){function e(){this._symbol=["28","46","82","64","141","585","3","7","5","1","4321876","2345678"],this._symbolG=[0,0,3,3,5,5,1,1,2,2,4,4]}return e.prototype.init=function(){this._gestureData=[],this._gestureRes=RES.getRes("gesture_json");for(var e=0;e<this._gestureRes.length;e++)for(var t=this._gestureRes[e].data,n=0;n<t.length;n++){var a={type:-1,data:""};a.type=this._gestureRes[e].type,a.data=t[n],this._gestureData.push(a)}},Object.defineProperty(e.prototype,"gestureRes",{get:function(){return this._gestureRes},enumerable:!0,configurable:!0}),e.prototype.addEvent=function(e,t){this._layer=e,this._group=t,this._group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._mouseDown,this),this._group.addEventListener(egret.TouchEvent.TOUCH_END,this._mouseUp,this),this._group.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._mouseUp,this),this._group.addEventListener(egret.TouchEvent.TOUCH_MOVE,this._mouseMove,this)},e.prototype.removeEvent=function(){this._layer.graphics.clear(),this._group.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this._mouseDown,this),this._group.removeEventListener(egret.TouchEvent.TOUCH_END,this._mouseUp,this),this._group.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._mouseUp,this),this._group.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this._mouseMove,this)},e.prototype._mouseDown=function(e){if(!this._isDown){this._isDown=!0,this._layer.graphics.clear(),this._mouseDatas=[],this._lineData=[],this._catmullRom=[],this._catmullIndex=0;var t=new egret.Point(e.stageX,e.stageY);this._mouseDatas.push(t),this._lineData.push(t),this._currentPoint=t}},e.prototype._mouseMove=function(e){if(this._isDown){var t=GameObjectPool.getInstance().createObject(egret.Point,"egretPoint");t.x=e.stageX,t.y=e.stageY,this._mouseDatas.push(t),this._lineData.push(t),this._layer.graphics.lineStyle(16,16777215),this._layer.graphics.lineTo(t.x,t.y),this._layer.graphics.endFill(),this._currentPoint=t}},e.prototype._mouseUp=function(e){if(this._isDown){this._isDown=!1;var t=new egret.Point(e.stageX,e.stageY);this._mouseDatas.push(t),this._lineData.push(t),this._layer.graphics.clear(),this._motion()}},e.prototype._motion=function(){var e=[],t=0,n=this._mouseDatas.length;e.push(this._mouseDatas[t]);for(var a=0;n>a;a++)egret.Point.distance(this._mouseDatas[t],this._mouseDatas[a])>40&&(t=a,e.push(this._mouseDatas[t]));this._mouseDatas=e,this.parseDirection()},e.prototype.parseDirection=function(){this._dirsArr=[];for(var e=this._mouseDatas.length,t=0;e>t;t++)if(this._mouseDatas[t+1]){var n=this._mouseDatas[t],a=this._mouseDatas[t+1],i=n.y-a.y,o=egret.Point.distance(n,a),r=Math.asin(i/o),s=Number((57.29578*r).toFixed(1)),l=this._quadrant(n,a),h=this._getDirByAngQuad(s,l);this._dirsArr.push(h)}var u=this._repDiff(this._dirsArr),m=this._sweep(u);this._disEvent(m)},e.prototype._disEvent=function(e){if(GameConfig.gestureType=e,-1!=e){Common.dispatchEvent(MainNotify.gestureAction),this._catmullIndex=0;for(var t=0;t<this._gestureRes.length;t++)if(e==this._gestureRes[t].type){this._layer.graphics.moveTo(this._lineData[0].x,this._lineData[0].y),this._layer.graphics.lineStyle(16,this._gestureRes[t].color);for(var n=this._lineData.length;n>=0;n--)n%2>0&&this._lineData.splice(n,1);this._bezierInterpolation(),this._layer.graphics.endFill(),egret.setTimeout(this._clearGraphics,this,200);break}}},e.prototype._bezierInterpolation=function(){for(var e=.6,t=[],n=this._lineData.length,a=0;a<this._lineData.length;a++){var i=(a+1)%n,o=this._lineData[a],r=this._lineData[i];if(void 0!=r){var s=new egret.Point;s.x=.5*(o.x+r.x),s.y=.5*(o.y+r.y),t.push(s)}}for(var l=new Array(2*n),a=0;n>a;a++){var i=(a+1)%n,h=(a+n-1)%n,u=new egret.Point;u.x=(t[a].x+t[h].x)/2,u.y=(t[a].y+t[h].y)/2;var m=this._lineData[a].x-u.x,c=this._lineData[a].y-u.y,g=2*a;l[g]=new egret.Point,l[g].x=t[h].x+m,l[g].y=t[h].y+c;var p=(l[g].x-this._lineData[a].x)*e,d=(l[g].y-this._lineData[a].y)*e;l[g].x=this._lineData[a].x+p,l[g].y=this._lineData[a].y+d;var _=(g+1)%(2*n);l[_]=new egret.Point,l[_].x=t[a].x+m,l[_].y=t[a].y+c,p=(l[_].x-this._lineData[a].x)*e,d=(l[_].y-this._lineData[a].y)*e,l[_].x=this._lineData[a].x+p,l[_].y=this._lineData[a].y+d}var f=[];this._lineData[0]&&this._lineData[1]&&(this._layer.graphics.moveTo(this._lineData[0].x,this._lineData[0].y),this._layer.graphics.lineTo(this._lineData[1].x,this._lineData[1].y));for(var a=1;n>a;a++){f[0]=this._lineData[a];var g=2*a;f[1]=l[g+1];var _=(g+2)%(2*n);f[2]=l[_];var i=(a+1)%n;i>0&&(f[3]=this._lineData[i],this._layer.graphics.moveTo(f[0].x,f[0].y),this._layer.graphics.cubicCurveTo(f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y))}},e.prototype._clearGraphics=function(){for(;this._lineData.length>0;){var e=this._lineData.pop();GameObjectPool.getInstance().destroyObject(e)}this._layer.graphics.clear(),this._lineData.length=0},e.prototype._sweep=function(e){for(var t=-1,n=-1,a=this._gestureData.length,i=0;a>i;i++){var o=this._levenshteinDistancePercent(this._gestureData[i].data,e);o>n&&(n=o,t=this._gestureData[i].type)}return.4>n&&(t=-1),t},e.prototype._repDiff=function(e){for(var t="",n=e.length,a=0,i=0;n>i;i++)a!=e[i]&&(a=e[i],t+=e[i]);return t},e.prototype._getDirByAngQuad=function(e,t){switch(t){case 1:return 22.5>=e&&e>=0?1:67.5>=e&&e>22.5?8:7;case 2:return 22.5>=e&&e>=0?5:67.5>=e&&e>22.5?6:7;case 3:return-67.5>=e&&e>=-90?3:-22.5>=e&&e>-67.5?4:5;case 4:return-67.5>=e&&e>=-90?3:-22.5>=e&&e>-67.5?2:1}},e.prototype._quadrant=function(e,t){return t.x>=e.x?t.y<=e.y?1:4:t.y<=e.y?2:3},e.prototype._levenshteinDistance=function(e,t){var n,a,i,o,r,s=e.length,l=t.length,h=[];if(0==s)return l;if(0==l)return s;for(n=0;s>=n;n++)h[n]=[],h[n][0]=n;for(a=0;l>=a;a++)h[0][a]=a;for(n=1;s>=n;n++)for(i=e.charAt(n-1),a=1;l>=a;a++)o=t.charAt(a-1),r=i==o?0:1,h[n][a]=this._minimum(h[n-1][a]+1,h[n][a-1]+1,h[n-1][a-1]+r);return h[s][l]},e.prototype._levenshteinDistancePercent=function(e,t){var n=e.length>t.length?e.length:t.length,a=this._levenshteinDistance(e,t);return 1-a/n},e.prototype._minimum=function(e,t,n){return t>e?n>e?e:n:n>t?t:n},e}();__reflect(Gesture.prototype,"Gesture");var ActorListPanel=function(e){function t(){var t=e.call(this)||this;return t.m_pageNum=5,t._imgPages=new Array,t._pages=new Array,t._actors=new Array,t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/listActorPanel.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){var e=Math.ceil(GameConfig.babyOpenList.length/9);this._pageReset(e),this.updateBabyInfo(GameConfig.curBaby),this._labCount.text=GameConfig.candy.toString(),this._labCount.x=280-this._labCount.width,this._imgCandy.x=this._labCount.x-63},t.prototype.onEnter=function(){this.touchChildren=!0,this.initData(),this.xuanzhuan.play(0),Common.updateBabylistIndex(1),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,this.xuanzhuan.stop(),Common.gameScene().uiLayer.removeChild(this)},t.prototype.updateBabyInfo=function(e){var t=GameConfig.actorTable[e.toString()];this._labActorName.text=t.name,this._labDesc.text=t.desc;var n=GameConfig.babyUnlockList.indexOf(e);0>n&&(this._labDesc.text=t.unlockDesc),this._actorArmatureContainer.clear();var a=DragonBonesFactory.getInstance().buildArmatureDisplay(t.action,t.action);null==this._actorArmature&&(this._actorArmature=new DragonBonesArmature(a)),this._actorArmature.ArmatureDisplay=a,this._actorArmatureContainer.register(this._actorArmature,["fangdazhao","idle","zoulu"]),this._actorArmatureContainer.play("idle",0),this._actorState=EMonsterState.Ready,this._actorArmatureContainer.scaleX=.5,this._actorArmatureContainer.scaleY=.5,this._actorArmatureContainer.addCompleteCallFunc(this._actorArmatureComplete,this);for(var i=0;i<GameConfig.babyOpenList.length;i++){var o=GameConfig.babyOpenList[i],r=GameConfig.actorTable[o],s=GameConfig.babyUnlockList.indexOf(o);this._actors[i].visible=!0,0>s?this._actors[i].actorIcon=r.lockIcon:this._actors[i].actorIcon=r.icon,this._actors[i].id=r.id,this._actors[i].setLight(!1),o==e&&this._actors[i].setLight(!0)}},t.prototype._pageReset=function(e){for(var t=0;t<this._imgPages.length;t++)this._imgPages[t].visible=!1,this._imgPages[t].source="actorList3_png";for(var t=0;e>t;t++){var n=108-21.5*e;this._imgPages[t].visible=!0,this._imgPages[t].x=n+43*t}this._imgPages[0].source="actorList4_png";for(var t=0;t<this._pages.length;t++)this._pages[t].visible=!1;for(var t=0;e>t;t++)this._pages[t].visible=!0;this._initActorIcon(),this._srollView.itemNum=e,this._srollView.reset(this._imgPages),this._srollView.spacing=20},t.prototype._initActorIcon=function(){for(var e=0;e<this._actors.length;e++)this._actors[e].visible=!1},t.prototype._onBtnReturn=function(){Common.dispatchEvent(MainNotify.closeActorListPanel),Common.dispatchEvent(MainNotify.openGameStartPanel)
},t.prototype._onBtnAddCandy=function(){Common.dispatchEvent(MainNotify.openRechargePanel)},t.prototype._onBtnFusion=function(){GameConfig.sceneType=1,Common.dispatchEvent(MainNotify.openCapsulePanel)},t.prototype._onGroupActor=function(){this._actorArmatureContainer.play("fangdazhao",1),this._actorState=EMonsterState.Attack},t.prototype._actorArmatureComplete=function(){Common.log(this._actorState),this._actorState==EMonsterState.Attack&&(this._actorArmatureContainer.play("idle",0),this._actorState=EMonsterState.Ready)},t.prototype._onLoop=function(){this.xuanzhuan.play(0)},t.prototype._updateCandy=function(){this._labCount.text=GameConfig.candy.toString()},t.prototype._onComplete=function(){this._imgPages.push(this._imgPage1),this._imgPages.push(this._imgPage2),this._imgPages.push(this._imgPage3),this._imgPages.push(this._imgPage4),this._imgPages.push(this._imgPage5),this._pages.push(this._page1),this._pages.push(this._page2),this._pages.push(this._page3),this._pages.push(this._page4),this._pages.push(this._page5);for(var e=203,t=0;t<this._pages.length;t++)for(var n=0;9>n;n++){var a=new ActorIR,i=n%3,o=Math.floor(n/3);a.x=e*i,a.y=e*o,a.scaleX=.9,a.scaleY=.9,this._actors.push(a),a.id=this._actors.length,this._pages[t].addChild(a)}this._actorArmatureContainer=new DragonBonesArmatureContainer,this._actorArmatureContainer.x=this._groupActor.width/2,this._actorArmatureContainer.y=this._groupActor.height,this._groupActor.addChild(this._actorArmatureContainer),this._btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnReturn,this),this._btnAddCandy.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnAddCandy,this),this._btnFusion.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnFusion,this),this._groupActor.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onGroupActor,this),this.xuanzhuan.addEventListener("complete",this._onLoop,this),Common.addTouchBegin(this._btnReturn),Common.addTouchBegin(this._btnAddCandy),Common.addEventListener(MainNotify.updateCandy,this._updateCandy,this)},t}(BasePanel);__reflect(ActorListPanel.prototype,"ActorListPanel");var ActorIR=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/actorIR.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actorIcon",{set:function(e){this._imgActor.source=e},enumerable:!0,configurable:!0}),t.prototype.setLight=function(e){this._imgBox.visible=e},t.prototype.init=function(){},t.prototype._onActorClick=function(){PanelManager.actorListPanel.updateBabyInfo(this._id);var e=GameConfig.babyUnlockList.indexOf(this._id);e>=0&&Common.updateCurBaby(this._id)},t.prototype._onComplete=function(){this._imgActor.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onActorClick,this)},t}(eui.Component);__reflect(ActorIR.prototype,"ActorIR");var Baby=function(e){function t(){var t=e.call(this)||this;t._tiredTime=0,t._actorArmatureContainer=new DragonBonesArmatureContainer,t._actorArmatureContainer.scaleX=.5,t._actorArmatureContainer.scaleY=.5,t.addChild(t._actorArmatureContainer),t._powerGroup=new egret.Sprite,t.addChild(t._powerGroup);var n=Common.createBitmap("gameProgressBg_png");t._powerGroup.addChild(n);var a=Common.createBitmap("power_Pro_png");return t._powerGroup.addChild(a),t._progress=new egret.Shape,a.mask=t._progress,t._powerGroup.addChild(t._progress),t._powerGroup.scaleX=.5,t._powerGroup.scaleY=.5,t._influenceActors=new Array,t._influenceBalls=new Array,t._actorsIndex=new Array,t}return __extends(t,e),t.prototype.initData=function(){this._actorArmatureContainer.clear();var e=DragonBonesFactory.getInstance().buildArmatureDisplay(GameConfig.curBabyData.action,GameConfig.curBabyData.action);null==this._actorArmature&&(this._actorArmature=new DragonBonesArmature(e)),this._actorArmature.ArmatureDisplay=e,this._actorArmatureContainer.register(this._actorArmature,["fangdazhao","idle","zoulu"]),this.gotoIdle(),this._actorSpeed=.5,this._actorArmatureContainer.scaleX=.5*GameConfig.curBabyData.direction,this.x=Config.stageHalfWidth,this._actorArmatureContainer.addCompleteCallFunc(this._onArmatureComplete,this),this._powerGroup.x=-this.width/2,this._powerGroup.y=-1*this.height,this._powerGroup.visible=!1;var t=GameConfig.curBabyData.skillId;null!=t&&t>0?this.skillData=GameConfig.babySkillTable[t.toString()]:(console.error("不存在技能ID"),this.skillData=null)},t.prototype.gotoIdle=function(){this._state=EBabyState.Idle,this._actorArmatureContainer.play("idle",0)},t.prototype.gotoRun=function(){this._state=EBabyState.Run,this._actorArmatureContainer.play("zoulu",0)},t.prototype.gotoAttack=function(){this._state=EBabyState.Attack,this._actorArmatureContainer.play("fangdazhao",1);var e=RES.getRes(this.skillData.music),t=e.play(0,1);t.volume=GameConfig.soundValue/100},t.prototype.gotoTired=function(){this._state=EBabyState.Tired,this._actorArmatureContainer.play("idle",0),this._tiredTime=0},t.prototype.releaseSkill=function(e,t,n){if(void 0===n&&(n=null),e>=100&&this.skillData.method==t)switch(this.skillData.method){case ESkillReleaseType.Immediately:this.releaseImmediately();break;case ESkillReleaseType.Range:this.releaseRange(n)}},t.prototype.releaseRange=function(e){var t=this.skillData.range*Config.stageHeight;this.skillData.range>0&&e.state==EMonsterState.Ready&&e.y>=t&&this.canRelease()&&(PanelManager.gameScenePanel.releaseSkill(),this.skillData.sceneEffect&&""!=this.skillData.sceneEffect)},t.prototype.releaseImmediately=function(){this.canRelease()&&PanelManager.gameScenePanel.releaseSkill()},t.prototype.canRelease=function(){var e=!1,t=PanelManager.gameScenePanel.getAllActors();switch(this._influenceActors.length=0,this._influenceBalls.length=0,this._actorsIndex.length=0,this.skillData.rangeType){case ESkillRange.All:this.selectRangeAll(),e=!0;break;case ESkillRange.Random:this.selectRangeRandom(t);break;case ESkillRange.FrontToBack:this.selectRangeFrontToBack(t)}return!e&&(this._influenceActors.length>0||this._influenceBalls.length>0)&&(e=!0),e},t.prototype.releaseResult=function(){for(var e=0;e<this._influenceActors.length;e++){var t=this._influenceActors[e];t.updateEffectArmature(this.skillData),t.playEffect(this.skillData)}for(var e=0;e<this._influenceBalls.length;e++){var n=this._influenceBalls[e];n.updateEffectArmature(this.skillData),n.playEffect(this.skillData)}},t.prototype.selectRangeAll=function(){switch(this.skillData.result){case ESkillResult.ContinuedKill:PanelManager.gameScenePanel.setSkillDuration();break;case ESkillResult.SlowSpeed:PanelManager.gameScenePanel.setSkillDuration()}},t.prototype.selectRangeRandom=function(e){for(var t=0;t<e.length;t++)this._actorsIndex.push(t);if(MathUtils.shuffle(this._actorsIndex),this.skillData.param&&this.skillData.param.length>0){var n=this.skillData.param[0];if(this.skillData.param.lenght>1&&(n=parseInt(this.skillData.param[0])),n=Math.min(n,e.length),this.skillData.skillHang==ESkillHand.Ballon)for(var t=0;t<this._actorsIndex.length;t++){var a=this._actorsIndex[t],i=e[a];if(i.balloons.length>0&&i.state==EMonsterState.Ready&&i.y>=250)for(var o=0;o<i.balloons.length&&!(this._influenceBalls.length>=n);o++)this._influenceBalls.push(i.balloons[o])}else for(var t=0;n>t;t++){var a=this._actorsIndex[t],i=e[a];i.state==EMonsterState.Ready&&i.y>=250&&this._influenceActors.push(i)}}},t.prototype.selectRangeFrontToBack=function(e){if(e.sort(function(e,t){return t.y-e.y}),this.skillData.param&&this.skillData.param.length>0){var t=this.skillData.param[0];this.skillData.param.lenght>1&&(t=parseInt(this.skillData.param[0])),t=Math.min(t,e.length);for(var n=0,a=0;a<e.length;a++){var i=e[a];if(i.state==EMonsterState.Ready&&i.y>=250)if(this.skillData.skillHang==ESkillHand.Ballon)for(var o=0;o<i.balloons.length&&!(n>=t);o++)this._influenceBalls.push(i.balloons[o]),n++;else{if(n>=t)break;this._influenceActors.push(i),n++}}}},t.prototype.skillResultKill=function(){},t.prototype.update=function(e){this._state==EBabyState.Run&&(this.x+=this._actorSpeed,this.x>=600&&(this._actorSpeed=-.5,this._actorArmatureContainer.scaleX=-.5*GameConfig.curBabyData.direction,this.gotoTired()),this.x<=130&&(this._actorSpeed=.5,this._actorArmatureContainer.scaleX=.5*GameConfig.curBabyData.direction,this.gotoTired())),this._state==EBabyState.Tired&&(this._tiredTime+=e,this._tiredTime>=2e3&&(this.gotoRun(),this._tiredTime=0))},t.prototype.updateProgress=function(e){var t=this._powerGroup.height;this._progress.graphics.clear(),this._progress.graphics.beginFill(65535),this._progress.graphics.moveTo(t,t),this._progress.graphics.lineTo(2*t,t),this._progress.graphics.drawArc(t,t,t,Math.PI,e*Math.PI/180,!1),this._progress.graphics.lineTo(t,t),this._progress.graphics.endFill(),this._progress.y=-5},t.prototype._onArmatureComplete=function(){this._state==EBabyState.Attack&&this.gotoRun()},t}(egret.DisplayObjectContainer);__reflect(Baby.prototype,"Baby");var BabySkill=function(){function e(){}return e}();__reflect(BabySkill.prototype,"BabySkill");var Balloon=function(e){function t(){var t=e.call(this)||this;t.name="Balloon",t._gestureData=new Array,t._rop=Common.createBitmap("imgRop_png"),t.addChild(t._rop),t._balloonArmatureContainer=new DragonBonesArmatureContainer,t.addChild(t._balloonArmatureContainer),t._animations=["hong","huang","lan","explore","lv","zi"];var n=DragonBonesFactory.getInstance().buildArmatureDisplay("qiqiu","qiqiu");null==t._balloonArmature&&(t._balloonArmature=new DragonBonesArmature(n)),t._balloonArmature.ArmatureDisplay=n,t._balloonArmatureContainer.register(t._balloonArmature,t._animations),t._balloonArmatureContainer.scaleX=1,t._balloonArmatureContainer.scaleY=1,t._effectArmatureContainer=new DragonBonesArmatureContainer,t.addChild(t._effectArmatureContainer),t._gesture=new egret.Bitmap,t.addChild(t._gesture),t._gesture.scaleX=.55,t._gesture.scaleY=.55,t._guideArmatureContainer=new DragonBonesArmatureContainer,t.addChild(t._guideArmatureContainer);var a=DragonBonesFactory.getInstance().buildArmatureDisplay("xinshouyindao","xinshouyindao"),i=new DragonBonesArmature(a);return i.ArmatureDisplay=a,t._guideArmatureContainer.register(i,["xinshouyindao2"]),t._guideArmatureContainer.y=30,t._guideArmatureContainer.scaleX=.8,t._guideArmatureContainer.scaleY=.8,t}return __extends(t,e),t.prototype.init=function(e,t){this._score=0,this._root=t,this._rop.scaleX=0,this._rop.scaleY=0,this._rop.height=0,this._isChangeEasy=!1,this.updateGesture(e,!0),this._guideArmatureContainer.visible=!1,this._effectResult=ESkillResult.Invalid,this._effectArmatureContainer.visible=!1,this._balloonArmatureContainer.removeCompleteCallFunc(this._onBalloonComplete,this)},t.prototype.guideStart=function(){this._guideArmatureContainer.visible=!0,this._guideArmatureContainer.play("xinshouyindao2",0)},t.prototype.updateEffectArmature=function(e){this._effectArmatureContainer.clear();var t=DragonBonesFactory.getInstance().buildArmatureDisplay(e.skillFile,e.skillFile);null==this._effectArmature&&(this._effectArmature=new DragonBonesArmature(t)),this._effectArmature.ArmatureDisplay=t,this._effectArmatureContainer.register(this._effectArmature,[e.skill]),this._effectArmatureContainer.scaleX=1,this._effectArmatureContainer.scaleY=1,this._effectArmatureContainer.x=e.skillPosX,this._effectArmatureContainer.y=e.skillPosY,this._changeType=e.param[1],this._effectResult=e.result,this._effectArmatureContainer.addCompleteCallFunc(this._onEffectArmatureComplete,this)},t.prototype.playEffect=function(e){if(this._root.state==EMonsterState.Ready){switch(this._effectResult){case ESkillResult.Kill:this._type=-1;break;case ESkillResult.GestureChange:this._type=0}this._effectArmatureContainer.visible=!0,this._effectArmatureContainer.play(e.skill,1)}},t.prototype.updateGesture=function(e,t){if(void 0===t&&(t=!1),e.length>0){var n=MathUtils.getRandom(e.length-1);this._gesture.texture=RES.getRes(e[n].path),this._gesture.anchorOffsetX=this._gesture.width/2,this._gesture.anchorOffsetY=this._gesture.height/2,this._gesture.x=this._balloonArmatureContainer.x+1,this._gesture.y=this._balloonArmatureContainer.y-38,this._gesture.visible=!0,this._type=e[n].type,this._score=e[n].count,this._animationName=e[n].balloon,e.splice(n,1),this._balloonArmatureContainer.play(this._animationName,1),this._balloonArmatureContainer.pause(this._animationName)}this.scaleX=1,this.scaleY=1,e.length<=0&&this._root.resetGestureData()},t.prototype.changeToEasy=function(){this._isChangeEasy=!0,this._type=0,this._effectArmatureContainer.play("bianhua",1,1,0,1.6)},t.prototype.updateColorAndGesture=function(){this._type=0,this._gesture.visible=!1,this._balloonArmatureContainer.play("explore",1,1,0,3),this._balloonArmatureContainer.addCompleteCallFunc(this._onBalloonComplete,this)},t.prototype.calculateRop=function(e,t){var n=MathUtils.getDistance(e,t,0,-60),a=MathUtils.getRadian2(e,t,0,-60),i=MathUtils.getAngle(a)-90;this._ropRotation=i,this._rop.height=n},Object.defineProperty(t.prototype,"ropRotation",{get:function(){return this._ropRotation},enumerable:!0,configurable:!0}),t.prototype.setLine=function(){this._rop.x=this._balloonArmatureContainer.x,this._rop.y=this._balloonArmatureContainer.y-10,this.calculateRop(this.x,this.y),this._rop.rotation=this._ropRotation,this._rop.scaleX=1,this._rop.scaleY=1},t.prototype.balloonExplore=function(e){void 0===e&&(e=!1),this._rop.scaleX=0,this._rop.scaleY=0,this._gesture.visible=!1,this._balloonArmatureContainer.play(this._animationName,1);var t=GameVoice.ballonBoomSound.play(0,1);t.volume=GameConfig.soundValue/100,GameConfig.balloonScore+=this._score,0==e&&this._balloonArmatureContainer.addCompleteCallFunc(this._onBalloonComplete,this),0==e&&null!=this._root.balloons&&this._root.balloons.length<=0&&this._root.gotoDead()},t.prototype._onBalloonBoom=function(){},t.prototype.destroy=function(){},t.prototype.update=function(e){},Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rop",{get:function(){return this._rop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 80},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),t.prototype._onBalloonComplete=function(e){0==this._type?this.updateGesture(this._root.gestureData):-1==this.type?(this._root.balloonExploreHandle(),GameObjectPool.getInstance().destroyObject(this)):(this._root.balloonExploreHandle(),GameObjectPool.getInstance().destroyObject(this),Common.log("_onBalloonComplete"),this._root.removeBalloon(this))},t.prototype._onEffectArmatureComplete=function(e){switch(this._effectResult){case ESkillResult.Kill:this._effectResult=ESkillResult.Invalid,this._root.ballExplosion(this),this.balloonExplore();break;case ESkillResult.GestureChange:this._gestureData.length=0;for(var t=0;t<GameConfig.gestureConfig.length;t++)GameConfig.gestureConfig[t].type==this._changeType&&this._gestureData.push(GameConfig.gestureConfig[t]);Common.log("_onEffectArmatureComplete"),this.updateGesture(this._gestureData)}},t}(egret.Sprite);__reflect(Balloon.prototype,"Balloon");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPause=!1,t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype._onResize=function(e){Config.stageWidth=this.stage.stageWidth,Config.stageHeight=this.stage.stageHeight,Config.stageHalfWidth=this.stage.stageWidth/2,Config.stageHalfHeight=this.stage.stageHeight/2,Config.stageLeft=Config.stageWidth/3,Config.stageCenter=2*Config.stageWidth/3},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){GameManager.Instance.update()}}),egret.lifecycle.onPause=function(){GameManager.Instance.stageToBack(),egret.ticker.pause()},egret.lifecycle.onResume=function(){GameManager.Instance.stageToFront(),egret.ticker.resume()},this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,this.stage.setContentSize(730,1392),this.stage.maxTouches=1;var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.addChild(Common.gameScene()),this._onResize(null),RES.loadConfig("resource/default.res.json","resource/"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.addEventListener(egret.Event.RESIZE,this._onResize,this)},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),NativeApi.setLocalData("webView","1"),RES.loadGroup("preload",0)},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){var t=this;"preload"==e.groupName?(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.loadGroup("enter",1),this._rect=Common.createBitmap("black_png"),this._rect.width=Config.stageWidth,this._rect.height=Config.stageHeight,this._rect.visible=!1,this.stage.addChild(this._rect)):"enter"==e.groupName&&(this._rect.visible=!0,Animations.fadeOut(this._rect),Animations.fadeIn(this.loadingView,500,function(){t._rect.visible=!1,t.stage.removeChild(t.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceProgress,t),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,t.onItemLoadError,t),t.isResourceLoadEnd=!0,t.createScene()}))},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&(null==NativeApi.getLocalData("webView")&&(GameConfig.isWebView=!1),Common.getMaxScore(),Common.getUnlockBaby(),Common.getCurBaby(),Common.getCurChpter(),Common.getCurLevel(),Common.getCurCandy(),Common.getlastLoginTime(),Common.getSign(),Common.getBabylistIndex(),Common.isTowDataSame(GameConfig.lastLoginTime)||1!=GameConfig.sign||Common.updateSign(0),Common.getSignCount(),this.startCreateScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"enter"==e.groupName&&this.loadingView.onProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){GameManager.Instance.init()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.color=16362243,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t.CreatLoadingUI(),t}return __extends(t,e),t.prototype.CreatLoadingUI=function(){Animations.fadeOut(this);var e=Common.createBitmap("loadBg_png");e.width=Config.stageWidth,e.height=Config.stageHeight,this.addChild(e),GameConfig.initBattleDragonBones("huoyedoudong"),this.armatureContainer=new DragonBonesArmatureContainer,this.addChild(this.armatureContainer);var t=DragonBonesFactory.getInstance().buildArmatureDisplay("huoyedoudong","huoyedoudong"),n=new DragonBonesArmature(t);n.ArmatureDisplay=t,this.armatureContainer.register(n,["huoyedoudong"]),this.armatureContainer.x=e.width/2-15,this.armatureContainer.y=.65*Config.stageHalfHeight,this.armatureContainer.play("huoyedoudong",0)},t.prototype.updateName=function(e){},t.prototype.createLogo=function(){var e=Config.stageWidth,t=Config.stageHeight,n=new Common.MoonDisplayObject;n.type=Common.Const.SHAPE_CIRCLE,n.data={r:50,c:14781965},n.setBackground(16777215,2),n.x=e>>1,n.y=n.height,this.addChild(n);var a=Common.createText("GALE",0,0);a.size=40,a.x=n.x-(a.width>>1),a.y=n.y-(a.height>>1)-15,this.addChild(a),a=Common.createText("GAME",0,0),a.size=30,a.x=n.x-(a.width>>1),a.y=n.y-(a.height>>1)+15,this.addChild(a),a=Common.createText("孢子游戏",0,0),a.size=40,a.textColor=14720801,a.x=e-a.width-10,a.y=t-a.height-10,this.addChild(a)},t.prototype.createAirFan=function(){this.airFan=new egret.Sprite,this.addChild(this.airFan);for(var e=0;4>e;e++){var t=new egret.Sprite;this.airFan.addChild(t),t.graphics.lineStyle(0),t.graphics.beginFill(16777215),t.graphics.cubicCurveTo(-29,-28,29,-28,0,0),t.graphics.endFill(),t.rotation=90*e}},t.prototype.update=function(e){e>=1||e>.99&&this.stop()},t.prototype.play=function(){this.stop(),egret.startTick(this.loop,this)},t.prototype.stop=function(){egret.stopTick(this.loop,this)},t.prototype.loop=function(e){return this.airFan.rotation+=3,!0},t.prototype.addToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)},t.prototype.onProgress=function(e,t){},t.prototype.createBgGradientFill=function(e,t){void 0===e&&(e=16635225),void 0===t&&(t=14720801);var n=Config.stageWidth,a=Config.stageHeight,i=new egret.Matrix;i.createGradientBox(2*n,2*a,Math.PI/2);var o=new egret.Sprite;return o.graphics.beginGradientFill(egret.GradientType.RADIAL,[e,t],[1,1],[0,255],i),o.graphics.drawRect(0,0,n,a),this.addChild(o),o},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var CapsuleData=function(){function e(){this.consume=20,this.resultType=0}return Object.defineProperty(e.prototype,"result",{get:function(){for(var e=MathUtils.getRandom(1,this._capsuleWeight),t=null,n=0;n<GameConfig.capsuleConfig.length;n++){var a=GameConfig.capsuleConfig[n],i=GameConfig.capsuleTable[a.id.toString()];if(e<=i.range){t=i;break}}switch(1==GameConfig.babyUnlockList.length&&(t.type=ECapsule.BlueBaby),t.type){case ECapsule.Candy:this._capsuleCandy(t.value);break;case ECapsule.GreenBaby:this._capsuleBaby(EBabyQuality.Green);break;case ECapsule.BlueBaby:this._capsuleBaby(EBabyQuality.Blue);break;case ECapsule.PurpleBaby:this._capsuleBaby(EBabyQuality.Purple)}if(t.type!=ECapsule.Candy){var o=GameConfig.babyUnlockList.indexOf(this._result.id);0>o?(GameConfig.rewardType=EReward.AssignBaby,GameConfig.babyUnlockList.push(this._result.id),Common.updateUnlockBaby()):this._capsuleCandy(this._result.candy)}return this._result},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._capsuleWeight=0,this._babys=new Array;for(var e=0;e<GameConfig.capsuleConfig.length;e++){var t=GameConfig.capsuleConfig[e].id,n=GameConfig.capsuleTable[t.toString()];this._capsuleWeight+=n.weight,n.range=this._capsuleWeight}},e.prototype._capsuleCandy=function(e){GameConfig.rewardCandy=e,GameConfig.rewardType=EReward.Candy,Common.updateCurCandy(e),Common.dispatchEvent(MainNotify.updateCandy)},e.prototype._capsuleBaby=function(e){this._babys.length=0;for(var t=0,n=0;n<GameConfig.actorConfig.length;n++){var a=GameConfig.actorConfig[n];a.quality==e&&this._babys.push(a)}for(var n=0;n<this._babys.length;n++){var i=this._babys[n].id,o=GameConfig.actorTable[i.toString()];t+=o.weight,o.range=t}for(var r=MathUtils.getRandom(1,t),n=0;n<this._babys.length;n++){var a=this._babys[n],o=GameConfig.actorTable[a.id.toString()];if(r<=o.range){this._result=o;break}}},e}();__reflect(CapsuleData.prototype,"CapsuleData");var CapsulePanel=function(e){function t(){var t=e.call(this)||this;return t._btnDelay=-1,t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/choujiang.exml",t}return __extends(t,e),t.prototype.initPanel=function(){this._data=new CapsuleData,this._data.init()},t.prototype.initData=function(){},t.prototype.onEnter=function(){this._hookStop(),this._btnStop(),this._remoteStop(),this._candy.text=GameConfig.candy.toString(),this._candy.x=650-this._candy.width,this._imgCandy.x=this._candy.x-73,this._btnDelay=-1,this._isCapture=!1,this._hookMove.play(0),this.anjian.play(0),null!=GameVoice.beginBGMChannel&&GameVoice.beginBGMChannel.stop(),this._bgmChannel=GameVoice.rewardBGM.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this._btnDelay=-1,this._bgmChannel.stop(),Common.gameScene().uiLayer.removeChild(this)},t.prototype.update=function(e){this._btnDelay<0||(this._btnDelay+=e,this._btnDelay>=2e3&&(this._btnDelay=-1,this.anjian.play(0)))},t.prototype._onClose=function(){Common.dispatchEvent(MainNotify.closeCapsulePanel),0==GameConfig.sceneType&&Common.dispatchEvent(MainNotify.openGameStartPanel)},t.prototype._onBtnCapsule=function(){return GameConfig.candy<this._data.consume?void TipsManager.show("no enough candy!"):(this.touchChildren=!1,this._isCapture=!0,this._btnDelay=-1,this._btnStop(),GameConfig.rewardData=Common.cloneObj(this._data.result),this.anjian.play(0),this.yaogan.play(0),Common.updateCurCandy(-this._data.consume),void Common.dispatchEvent(MainNotify.updateCandy))},t.prototype._onShow=function(){this.touchChildren=!0},t.prototype._onHide=function(){Common.dispatchEvent(MainNotify.closeCapsulePanel)},t.prototype._onHookComplete=function(){this._hookMove.play(),this._hookStop(),this.touchChildren=!0;var e=RES.getRes("getBaby_mp3");GameConfig.rewardType==EReward.Candy&&(e=RES.getRes("getCandy_mp3"));e.play(0,1);Common.dispatchEvent(MainNotify.openGetRewardPanel)},t.prototype._onBtnComplete=function(){if(this._isCapture){this._isCapture=!1,this._hookMove.pause(),this._btnDelay=0,this.zhua.play(0);var e=GameVoice.rewardVoice.play(0,1);e.volume=GameConfig.soundValue/100,this._hook.alpha=1}else this._btnDelay=0},t.prototype._hookMoveComplete=function(){this._hookMove.play(0)},t.prototype._updateCandy=function(){this._candy.text=GameConfig.candy.toString()},t.prototype._onBtnRecharge=function(){Common.dispatchEvent(MainNotify.openRechargePanel)},t.prototype._remoteStop=function(){this._remote1.alpha=1,this._remote2.alpha=0,this._remote3.alpha=0},t.prototype._btnStop=function(){this._btnCapture.alpha=1,this._imgCapture.alpha=0},t.prototype._hookStop=function(){this._hook.alpha=0,this._hookFirst.alpha=1},t.prototype.onComplete=function(){this._onResize(),this._hookMove.addEventListener("complete",this._hookMoveComplete,this),this.anjian.addEventListener("complete",this._onBtnComplete,this),this.zhua.addEventListener("complete",this._onHookComplete,this),this.m_btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onClose,this),this._btnCapture.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnCapsule,this),this._btnRecharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnRecharge,this),Common.addTouchBegin(this.m_btnReturn),Common.addTouchBegin(this._btnCapture),Common.addEventListener(MainNotify.updateCandy,this._updateCandy,this)},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(CapsulePanel.prototype,"CapsulePanel");var GameOverPanel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/gameOverPanel.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){},t.prototype.onEnter=function(){this.touchChildren=!1,this.m_isAgain=!1,this.m_labScore.text=PanelManager.gameScenePanel.sceneData.realScore.toString(),this.m_labLianji.text="X"+GameConfig.curCombo.toString();var e="C";switch(e=GameConfig.curCombo<=3?"C":GameConfig.curCombo>3&&GameConfig.curCombo<=6?"B":GameConfig.curCombo>6&&GameConfig.curCombo<=10?"A":GameConfig.curCombo>10&&GameConfig.curCombo<=15?"S":"S+",this.m_labPingfen.text=e,GameConfig.gameMode){case EBattleMode.Level:Common.updateMaxScore(PanelManager.gameScenePanel.sceneData.realScore);break;case EBattleMode.Endless:break;case EBattleMode.Timelimite:}this.Show.play(0),GameManager.Instance.gameState==EGameState.EndLevel?GameVoice.vectory.play(0,1).volume=GameConfig.soundValue/100:GameVoice.jiesuanSound.play(0,1).volume=GameConfig.soundValue/100,this._labCandy.text=PanelManager.gameScenePanel.sceneData.addCandy.toString(),PanelManager.gameScenePanel.sceneData.addCandy=0,Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,this.Hide.play(0)},t.prototype._onBtnReturn=function(){this.touchChildren=!1,Common.dispatchEvent(MainNotify.closeGameOverPanel)},t.prototype._onBtnAgain=function(){this.touchChildren=!1,this.m_isAgain=!0,this.Hide.play(0)},t.prototype._onShow=function(){this.touchChildren=!0},t.prototype._onHide=function(){Common.gameScene().uiLayer.removeChild(this),this.m_isAgain?GameManager.Instance.gameState==EGameState.EndLevel?PanelManager.gameScenePanel.continueLevel():(PanelManager.gameScenePanel.init(),GameManager.Instance.start()):(GameManager.Instance.gameState=EGameState.Ready,Common.dispatchEvent(MainNotify.closeGamePanel),Common.dispatchEvent(MainNotify.openGameStartPanel))},t.prototype.onComplete=function(){this._onResize(),this.m_btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnReturn,this),this.m_btnAgain.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnAgain,this),Common.addTouchBegin(this.m_btnReturn),Common.addTouchBegin(this.m_btnAgain),this.Show.addEventListener("complete",this._onShow,this),this.Hide.addEventListener("complete",this._onHide,this)},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(GameOverPanel.prototype,"GameOverPanel");var GamePausePanel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/quitPanel.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){},t.prototype.onEnter=function(){this.touchChildren=!1,this.show.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,this.hide.play(0)},t.prototype._onBtnReturn=function(){this._state=EGamePauseState.Return,Common.dispatchEvent(MainNotify.closeGamePausePanel)},t.prototype._onBtnAgain=function(){this._state=EGamePauseState.Again,Common.dispatchEvent(MainNotify.closeGamePausePanel)},t.prototype._onBtnContinue=function(){this._state=EGamePauseState.Continue,Common.dispatchEvent(MainNotify.closeGamePausePanel)},t.prototype._onShow=function(){this.touchChildren=!0},t.prototype._onHide=function(){switch(Common.gameScene().uiLayer.removeChild(this),this._state){case EGamePauseState.Continue:GameManager.Instance.start();break;case EGamePauseState.Again:GameManager.Instance.start(),PanelManager.gameScenePanel.init();break;case EGamePauseState.Return:GameManager.Instance.gameState=EGameState.Ready,Common.dispatchEvent(MainNotify.closeGamePanel),Common.dispatchEvent(MainNotify.openGameStartPanel)}},t.prototype.onComplete=function(){this._onResize(),this.m_btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnReturn,this),this.m_btnContinue.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnContinue,this),Common.addTouchBegin(this.m_btnReturn),Common.addTouchBegin(this.m_btnContinue),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._onHide,this)},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(GamePausePanel.prototype,"GamePausePanel");var GameSceneData=function(){function e(){this.needScore=0,this.lastScore=0,this.midOffset=120,this.leftRightOffset=90,this.addPower=0,this.addCandy=0,this.allActors=new Array}return e.prototype.getSummonTargetX=function(e,t,n,a,i,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===i&&(i=ESummonType.Balloon),void 0===o&&(o=!1);
var r=t;switch(e){case EMonsterPos.Left:1==n?i==ESummonType.Balloon&&(r+=this.leftRightOffset):2==n?r+=2*this.leftRightOffset*a-this.leftRightOffset:3==n?i==ESummonType.Monster?r+=80*a-80:0>=a?r-=this.leftRightOffset:r+=this.leftRightOffset*a:i==ESummonType.Monster?r+=80*a-120:0>=a?r-=this.leftRightOffset:r+=this.leftRightOffset*a;break;case EMonsterPos.Middle:1==n?i==ESummonType.Balloon&&(r+=this.midOffset):2==n?r+=2*this.midOffset*a-this.midOffset:3==n?i==ESummonType.Monster?r+=this.leftRightOffset*a-this.leftRightOffset:0>=a?r-=this.midOffset:r+=this.midOffset*a:r+=i==ESummonType.Monster?80*a-120:1>=a?this.midOffset*a-200:this.midOffset*(a-1);break;case EMonsterPos.Right:1==n?i==ESummonType.Balloon&&(r-=this.leftRightOffset):2==n?r+=2*this.leftRightOffset*a-this.leftRightOffset:3==n?i==ESummonType.Monster?r+=this.leftRightOffset*a-this.leftRightOffset:0>=a?r+=this.leftRightOffset:r-=this.leftRightOffset*a:i==ESummonType.Monster?r+=80*a-120:0>=a?r+=this.leftRightOffset:r-=this.leftRightOffset*(a-1)}return r},e.prototype.getSummonTargetY=function(){},Object.defineProperty(e.prototype,"level",{get:function(){var e=0;if(0==GameConfig.guideIndex)e=1e3;else switch(GameConfig.gameMode){case EBattleMode.Level:var t=PanelManager.gameSelectLevel.selectChater,n=GameConfig.chapterTable[t.toString()];t>=GameConfig.curChpter?(GameConfig.curLevel<=0&&Common.updateCurLevel(10101),e=GameConfig.curLevel):e=n.begin,GameConfig.curBattleChapter=t;break;case EBattleMode.Endless:e=1001;break;case EBattleMode.Timelimite:}return this.levelData=GameConfig.levelTable[e.toString()],e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelData",{get:function(){return this._levelData},set:function(e){this._levelData=e,this.needScore=this._levelData.normalCount},enumerable:!0,configurable:!0}),e.prototype.getLastLevel=function(e){for(var t=0;t<GameConfig.levelConfig.length;t++){var n=GameConfig.levelConfig[t];if(n.next==e)return n.key}return-1},e.prototype.updateCandy=function(e){this.addCandy+=e,Common.updateCurCandy(e)},e.prototype.comboRewardCandy=function(e){if(e>0&&e%15==0){var t=Math.floor(e/15);this.extra+=t,this.extra=Math.min(3,this.extra)}},e}();__reflect(GameSceneData.prototype,"GameSceneData");var GameScenePanel=function(e){function t(){var t=e.call(this)||this;return t._arrayProgress=new Array,t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/gameScenePanel.exml",t.m_monsters=new Array,t.m_luckyActors=new Array,t.m_summonActors=new Array,t.m_spiderActors=new Array,t._data=new GameSceneData,t}return __extends(t,e),t.prototype.initPanel=function(){this.m_gestureShape=new egret.Shape,this.m_gesture=new Gesture,this.m_gesture.init(),this.m_currentItemId=0,this._particleLayer=new egret.Sprite,this.addChild(this._particleLayer)},t.prototype.init=function(){switch(this.clearAllActor(),this.touchChildren=!1,this.readyAnimate.play(0),GameVoice.readyGoSound.play(0,1).volume=GameConfig.soundValue/100,this.m_imgEffectMask.visible=!1,this.m_rectWarning.visible=!1,this.m_bitLabScore.visible=!1,this.m_fntCombo.visible=!1,this.m_fntComboCount.visible=!1,this.m_spiderWebArmatureContainer.visible=!1,this.m_imgBossWarning.visible=!1,this.itemUnlockGroup.visible=!1,this._imgGuide.visible=!1,this._imgGuideTip.visible=!1,this.m_normalCount=0,this.m_gesture.addEvent(this.m_gestureShape,this.m_groupGesture),Common.addEventListener(MainNotify.gestureAction,this._onGesture,this),this.initData(),null!=GameVoice.battleBGMChannel&&GameVoice.battleBGMChannel.stop(),GameConfig.gameMode){case EBattleMode.Level:var e=GameConfig.chapterTable[this._data.levelData.section.toString()],t=RES.getRes(e.bgm);GameVoice.battleBGMChannel=t.play(0),this.m_groupGrogress.visible=!0,this._curLevel.visible=!0;break;case EBattleMode.Endless:GameVoice.battleBGMChannel=GameVoice.battleBGMSound.play(0),this.m_groupGrogress.visible=!1,this._curLevel.visible=!1;break;case EBattleMode.Timelimite:}GameVoice.battleBGMChannel.volume=.8*GameConfig.bgmValue/100},t.prototype.continueLevel=function(){var e=this._data.levelData.next,t=GameConfig.levelTable[e.toString()];return null==e||0>e||null==t?(this.returnSelectLevel(),void console.error("没有下一关卡数据")):void(t.section!=this._data.levelData.section?(this.updeLevelData(this._data.levelData.next,this._data.levelData.key),this.returnSelectLevel()):(this.touchChildren=!0,this.m_baby.gotoRun(),this.updeLevelData(this._data.levelData.next,this._data.levelData.key),this.m_gesture.addEvent(this.m_gestureShape,this.m_groupGesture),Common.addEventListener(MainNotify.gestureAction,this._onGesture,this),this.score=0,this.SetRealScore(0),GameManager.Instance.start()))},t.prototype.returnSelectLevel=function(){GameManager.Instance.gameState=EGameState.Ready,GameConfig.isOpenNewChapter=!1,PanelManager.gameSelectLevel.selectChater+1==GameConfig.curChpter&&(GameConfig.isOpenNewChapter=!0),Common.dispatchEvent(MainNotify.closeGamePanel),Common.dispatchEvent(MainNotify.openGameSelectLevel)},t.prototype.exit=function(){this.m_imgEffectMask.visible=!1,this.touchChildren=!1,this.m_gesture.removeEvent(),Common.removeEventListener(MainNotify.gestureAction,this._onGesture,this),this.m_baby.gotoIdle()},t.prototype.initData=function(){GameConfig.gestureType=0,this.m_monsterAddDelay=0,this.m_luckyAddDelay=0,this.power=0,this.m_skillDuration=-1,this.m_comboDelay=-1,this.m_comboCount=0,GameConfig.curCombo=0,this.m_isBoom=!1,this.m_baby.initData(),this._data.addCandy=0,this._data.extra=0;var e=this._data.level;this.score=0,this.SetRealScore(0),this.updeLevelData(e,null)},t.prototype.updeLevelData=function(e,t){switch(this.m_monsterAddDelay=0,this.m_levelState=ELevelType.Normal,this.m_isLuck=!1,this.m_rectWarning.fillColor=16711680,this._data.levelData=GameConfig.levelTable[e.toString()],GameConfig.gameMode){case EBattleMode.Level:var n=this._data.levelData.section,a=GameConfig.chapterTable[n.toString()];if(this._data.levelData.section>=GameConfig.curChpter){if(e>a.begin){var i=t;null==t&&(i=this._data.getLastLevel(e));var o=GameConfig.levelTable[i.toString()];this._data.lastScore=o.normalCount}Common.updateCurLevel(e),Common.updateCurChpter(this._data.levelData.section)}if(e>a.begin){var i=t;null==t&&(i=this._data.getLastLevel(e));var o=GameConfig.levelTable[i.toString()];this._data.lastScore=o.normalCount}this._curLevel.text=this._data.levelData.level.toString(),GameManager.Instance.updateSceneBg(a.bg,a.water),GameManager.Instance.updateSceneCloud(a.cloud1,a.cloud2),GameManager.Instance.updateSceneSun(a.sun);break;case EBattleMode.Endless:this.score=0,e==this._data.levelData.next;break;case EBattleMode.Timelimite:}GameConfig.gameSpeedPercent=this._data.levelData.speed,1e3==e&&(GameConfig.isGuide=!0,this.m_rectWarning.fillColor=0,this.m_isLuck=!0,this.m_gesture.removeEvent(),Common.removeEventListener(MainNotify.gestureAction,this._onGesture,this))},t.prototype.guideStart=function(){this.m_rectWarning.visible=!0,this.m_guideArmatureContainer.visible=!0,this._imgGuideTip.visible=!0,0==GameConfig.guideIndex?this.m_guideArmatureContainer.play("xinshouyindao",0):1==GameConfig.guideIndex?this.m_guideArmatureContainer.play("xinshouyindao4",0):this.m_guideArmatureContainer.play("xinshouyindao",0);for(var e=0;e<this.m_monsters.length;e++)for(var t=this.m_monsters[e],n=0;n<t.balloons.length;n++){var a=t.balloons[n];a.guideStart()}this.m_gesture.addEvent(this.m_gestureShape,this.m_groupGesture),Common.addEventListener(MainNotify.gestureAction,this._onGesture,this)},t.prototype.guideEnd=function(){this._imgGuideTip.visible=!1,this.m_rectWarning.visible=!1,GameConfig.isGuide=!1,this.power=0,Common.updateGuide(3),this.m_gesture.addEvent(this.m_gestureShape,this.m_groupGesture),Common.addEventListener(MainNotify.gestureAction,this._onGesture,this)},t.prototype.onEnter=function(){Common.curPanel=PanelManager.gameScenePanel,Common.gameScene().uiLayer.addChild(this),this.init()},t.prototype.onExit=function(){this.clearAllActor(),Common.gameScene().uiLayer.removeChild(this),this.exit(),GameVoice.battleBGMChannel.stop()},t.prototype.setSkillDuration=function(){this.m_baby.skillData.time>0&&(this.m_skillDuration=0)},t.prototype.update=function(e){var t=e;if(this.m_skillDuration>=0&&GameManager.Instance.gameState==EGameState.Start&&(this.m_skillDuration+=e,this.m_skillDuration>=this.m_baby.skillData.time&&(this.m_skillDuration=-1)),GameManager.Instance.gameState==EGameState.Start){if(this.m_skillDuration>=0)switch(this.m_baby.skillData.result){case ESkillResult.ContinuedKill:for(var n=this.m_baby.skillData.range*Config.stageHeight,a=0;a<this.m_monsters.length;a++){var i=this.m_monsters[a];i.state==EMonsterState.Ready&&i.y>=n&&i.gotoDead()}for(var a=0;a<this.m_summonActors.length;a++){var o=this.m_summonActors[a];o.state==EMonsterState.Ready&&o.y>=n&&o.gotoDead()}break;case ESkillResult.SlowSpeed:t*=.2}if(this.m_levelState==ELevelType.Normal?this.m_monsterAddDelay+=t:this.m_monsterAddDelay=0,this.m_luckyAddDelay+=e,this.m_comboDelay>=0&&(this.m_comboDelay+=t,this.m_comboDelay>=GameConfig.comboDelay)){this.m_comboDelay=-1,GameConfig.curCombo=Math.max(this.m_comboCount,GameConfig.curCombo),this.m_comboCount=0,this.m_isBoom=!1,this.comboMove.stop(),this.comboEnd.play(0);for(var a=0;a<this.m_monsters.length;a++){var i=this.m_monsters[a];i.type==EMonsterDifficult.Normal&&i.resetVertical()}for(var a=0;a<this.m_summonActors.length;a++){var o=this.m_summonActors[a];o.resetVertical()}}for(var a=0;a<this.m_monsters.length;a++){var i=this.m_monsters[a];i.state==EMonsterState.Ready&&i.y>=this.m_imgGroundWarning.y&&!this.m_isWarning&&this._warning(),this.m_baby.releaseSkill(this.m_power,ESkillReleaseType.Range,i)}for(var a=0;a<this.m_summonActors.length;a++){var o=this.m_summonActors[a];o.state==EMonsterState.Ready&&o.y>=this.m_imgGroundWarning.y&&!this.m_isWarning&&this._warning(),this.m_baby.releaseSkill(this.m_power,ESkillReleaseType.Range,o)}this.m_score<this._data.needScore&&this.m_monsterAddDelay>=this._data.levelData.addTime&&(this.m_monsterAddDelay=0,this._createMonster(),GameConfig.isGuide&&this.m_score++),this.m_luckyAddDelay>=GameConfig.luckyActorAddDelay&&!GameConfig.isGuide&&(this.m_luckyAddDelay=0,this.createLuckyActor())}if(GameManager.Instance.gameState==EGameState.Start||GameManager.Instance.gameState==EGameState.End){for(var a=0;a<this.m_monsters.length;a++)this.m_monsters[a].update(t);for(var a=0;a<this.m_spiderActors.length;a++)this.m_spiderActors[a].update(t)}if(GameManager.Instance.gameState==EGameState.Start){for(var a=0;a<this.m_luckyActors.length;a++)this.m_luckyActors[a].update(t);for(var a=0;a<this.m_summonActors.length;a++)this.m_summonActors[a].update(t),this._summonActorHit(this.m_summonActors[a]);this.m_baby.update(e)}},t.prototype._summonActorHit=function(e){for(var t=0;t<this.m_summonActors.length;t++){var n=this.m_summonActors[t];if(n!=e){var a=MathUtils.getDistance(e.x,e.y,n.x,n.y),i=(e.w+n.w)/2;i>=a&&(e.x<n.x?e.x-=1:e.x+=1,e.x>=Config.stageWidth-e.w&&(e.x=Config.stageWidth-e.w),e.y<n.y&&(e.y-=1))}}},t.prototype.removeMonster=function(e){for(var t=0;t<this.m_monsters.length;t++)if(this.m_monsters[t]==e){this.m_groupGame.removeChild(this.m_monsters[t]),this.m_monsters.splice(t,1);break}this._changeLevel()},t.prototype.removeBullet=function(e){},t.prototype.removeLuckyActor=function(e){for(var t=0;t<this.m_luckyActors.length;t++)if(this.m_luckyActors[t]==e){this.m_groupGame.removeChild(this.m_luckyActors[t]),this.m_luckyActors.splice(t,1);break}},t.prototype.removeSummonActor=function(e){for(var t=0;t<this.m_summonActors.length;t++)if(this.m_summonActors[t]==e){this.m_groupGame.removeChild(this.m_summonActors[t]),this.m_summonActors.splice(t,1);break}this._changeLevel()},t.prototype.removeSpiderActor=function(e){for(var t=0;t<this.m_spiderActors.length;t++)if(this.m_spiderActors[t]==e){this.m_groupGame.removeChild(this.m_spiderActors[t]),this.m_spiderActors.splice(t,1);break}this._changeLevel()},t.prototype.clearAllActor=function(){for(;this.m_monsters.length>0;){var e=this.m_monsters.pop();e.destroy(),this.m_groupGame.removeChild(e)}for(;this.m_luckyActors.length>0;){var t=this.m_luckyActors.pop();t.destroy(),this.m_groupGame.removeChild(t)}for(;this.m_summonActors.length>0;){var n=this.m_summonActors.pop();n.destroy(),this.m_groupGame.removeChild(n)}for(;this.m_spiderActors.length>0;){var a=this.m_spiderActors.pop();a.destroy(),this.m_groupGame.removeChild(a)}},t.prototype.getAllActors=function(){this._data.allActors.length=0;for(var e=0;e<this.m_monsters.length;e++)this.m_monsters[e].state==EMonsterState.Ready&&this._data.allActors.push(this.m_monsters[e]);for(var e=0;e<this.m_summonActors.length;e++)this.m_summonActors[e].state==EMonsterState.Ready&&this._data.allActors.push(this.m_summonActors[e]);return this._data.allActors},t.prototype.isNoneAlive=function(){for(var e=0;e<this.m_monsters.length;e++)if(this.m_monsters[e].state==EMonsterState.Ready)return!1;for(var e=0;e<this.m_summonActors.length;e++)if(this.m_summonActors[e].state==EMonsterState.Ready)return!1;return!0},t.prototype.SetRealScore=function(e){this._data.realScore=e,this.m_bitLabScore.text=this._data.realScore.toString()},Object.defineProperty(t.prototype,"score",{get:function(){return this.m_score},set:function(e){this.m_score=e,this._setProgress(e)},enumerable:!0,configurable:!0}),t.prototype._setProgress=function(e){var t=this._imgProgressBg.width,n=this._data.needScore/5;this._data.needScore-this._data.lastScore<=0&&(n=this._data.needScore/5),n=Math.floor(n);for(var a=t/n,i=e%n,o=Math.floor(e/n),r=0;r<this._arrayProgress.length;r++)this._arrayProgress[r].visible=!1,o>r&&(this._arrayProgress[r].visible=!0,this._arrayProgress[r].width=t),r==o&&(this._arrayProgress[r].visible=!0,this._arrayProgress[r].width=a*i);this._imgBossIcon.source="battleBg08_png",this.m_score>=this._data.needScore&&(this._imgBossIcon.source="battleBg07_png")},t.prototype.updatePower=function(e){var t=this._imgPower.height+10;e=Math.min(1,e),this._progress.graphics.clear(),this._progress.graphics.beginFill(65535),this._progress.graphics.drawRect(this._imgPower.x,this._imgPower.y+t,t,110*-e),this._progress.graphics.endFill(),this._progress.y=-24},Object.defineProperty(t.prototype,"power",{get:function(){return this.m_power},set:function(e){null!=this.m_baby&&(this.m_power=e,this.updatePower(this.m_power/100),this.m_baby.releaseSkill(this.m_power,ESkillReleaseType.Immediately))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groundPos",{get:function(){return this.m_imgGroundLine.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guidePos",{get:function(){return this.m_imgGuide.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waterPos",{get:function(){return this.m_imgGroundWater.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"warningPos",{get:function(){return this.m_imgGroundWarning.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levelStage",{get:function(){return this.m_levelState},enumerable:!0,configurable:!0}),t.prototype.actorDeadHandle=function(){this.m_levelState==ELevelType.Normal&&this.m_score>=this._data.needScore&&this.isNoneAlive()&&(this.m_levelState=ELevelType.EliteWarning),this.m_levelState==ELevelType.EliteWarning&&(GameConfig.isGuide?(this.score=0,this.SetRealScore(0),this._imgGuide.visible=!0,GameConfig.guideIndex<=1?(GameConfig.guideIndex++,this._imgGuide.source="imgGuide"+GameConfig.guideIndex+"_png",this.yindao.play(0),this.m_rectWarning.visible=!1,this.m_guideArmatureContainer.visible=!1,this.updeLevelData(this._data.levelData.next,this._data.levelData.key),this.m_rectWarning.fillColor=0,this.m_gesture.removeEvent(),Common.removeEventListener(MainNotify.gestureAction,this._onGesture,this)):(this.m_guideArmatureContainer.stop(),this.m_guideArmatureContainer.visible=!1,this.updeLevelData(this._data.levelData.next,this._data.levelData.key),this._imgGuide.source="imgGuide3_png",this.yindao.play(0),this.guideEnd())):(this.m_levelState=ELevelType.End,this._enterWarning()))},Object.defineProperty(t.prototype,"boom",{get:function(){return this.m_isBoom},set:function(e){this.m_isBoom=e},enumerable:!0,configurable:!0}),t.prototype.updateBatter=function(){var e=0;if(this.m_isBoom){if(GameConfig.isGuide&&(GameVoice.gestureVoice.play(0,1).volume=GameConfig.soundValue/100),this.m_comboDelay=0,this.m_comboCount+=1,this.m_isBoom=!1,this.m_comboCount>=2){this.m_fntCombo.visible=!0,this.m_fntComboCount.visible=!0,this.m_fntComboCount.text="X"+this.m_comboCount,this.m_comboArmatureContainer.y=80,this.m_comboArmatureContainer.visible=!0,this.m_comboCount<6?(this.m_fntCombo.font=RES.getRes("comboBlueFnt_fnt"),this.m_fntComboCount.font=RES.getRes("comboBlueFnt_fnt"),this.m_comboArmatureContainer.play("lan",1),GameVoice.combo2Sound.play(0,1).volume=GameConfig.soundValue/100):this.m_comboCount>=6&&this.m_comboCount<11?(this.m_fntCombo.font=RES.getRes("comboYellowFnt_fnt"),this.m_fntComboCount.font=RES.getRes("comboYellowFnt_fnt"),this.m_comboArmatureContainer.play("lan",1),GameVoice.combo3Sound.play(0,1).volume=GameConfig.soundValue/100):this.m_comboCount>=11&&this.m_comboCount<16?(this.m_fntCombo.font=RES.getRes("comboRedFnt_fnt"),this.m_fntComboCount.font=RES.getRes("comboRedFnt_fnt"),this.m_comboArmatureContainer.play("huang",1),GameVoice.combo4Sound.play(0,1).volume=GameConfig.soundValue/100):this.m_comboCount>=16&&this.m_comboCount<26?(this.m_fntCombo.font=RES.getRes("comboPurpleFnt_fnt"),this.m_fntComboCount.font=RES.getRes("comboPurpleFnt_fnt"),this.m_comboArmatureContainer.play("hong",1),GameVoice.combo4Sound.play(0,1).volume=GameConfig.soundValue/100):(this.m_fntCombo.font=RES.getRes("comboGreenFnt_fnt"),this.m_fntComboCount.font=RES.getRes("comboGreenFnt_fnt"),this.m_comboArmatureContainer.play("hong",1),GameVoice.combo4Sound.play(0,1).volume=GameConfig.soundValue/100),this.comboBegin.play(0),e=this.m_comboCount,GameConfig.balloonScore+=e;for(var t=.02*Math.min(6,this.m_comboCount),n=0;n<this.m_monsters.length;n++){var a=this.m_monsters[n];a.type==EMonsterDifficult.Normal&&a.setVertical(t)}for(var n=0;n<this.m_summonActors.length;n++){var i=this.m_summonActors[n];i.setVertical(t)}this._data.comboRewardCandy(this.m_comboCount)}this.m_comboCount<=2?GameConfig.comboDelay=1200:GameConfig.comboDelay=1e3}this.m_levelState==ELevelType.Normal&&(this.score+=GameConfig.balloonScore-e),this._data.realScore+=GameConfig.balloonScore,this.SetRealScore(this._data.realScore),this.actorDeadHandle()},t.prototype._warning=function(){this.m_rectWarning.visible=!0,this.m_isWarning=!0,this.warning.play(0)},t.prototype._beginSkill=function(){GameManager.Instance.start(),this.m_baby.releaseResult()},t.prototype.releaseSkill=function(){if(this.m_power>=100){this.m_imgEffectMask.visible=!0,this.effectMask.play(0),GameManager.Instance.pause(!0);var e=GameVoice.skillBeginSound.play(0,1);e.volume=GameConfig.soundValue/100,this.power=0,this.m_baby.gotoAttack()}},t.prototype._changeLevel=function(){this.m_monsters.length<=0&&this.m_summonActors.length<=0&&this.m_spiderActors.length<=0&&this.m_levelState==ELevelType.Elite&&(GameConfig.gameMode==EBattleMode.Level?(this._data.updateCandy(this._data.levelData.candy+this._data.extra),this._data.extra=0,GameManager.Instance.endLevel()):this.updeLevelData(this._data.levelData.next,this._data.levelData.key))},t.prototype._enterWarning=function(){this.m_imgBossWarning.visible=!0,this.bossWarning.play(0),GameVoice.bossWarning.play(0,1)},t.prototype._enterBoss=function(){this.m_imgBossWarning.visible=!1,egret.setTimeout(this._bossArrive,this,1500)},t.prototype._bossArrive=function(){this.m_levelState=ELevelType.Elite;for(var e=0,t=0;t<this._data.levelData.elite.length;t++)e+=this._data.levelData.elite[t].prob,this._data.levelData.elite[t].weight=e;for(var n=MathUtils.getRandom(1,e),t=0;t<this._data.levelData.elite.length;t++)if(n<=this._data.levelData.elite[t].weight){this.m_bossData=this._data.levelData.elite[t];break}1006==this.m_bossData.id?this.playSpiderWebArmature("arrive1",1):this._createMonster()},Object.defineProperty(t.prototype,"boss",{get:function(){return this.m_bossData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sceneData",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baby",{get:function(){return this.m_baby},enumerable:!0,configurable:!0}),t.prototype._onGesture=function(){if(GameConfig.gestureType>0){GameConfig.balloonScore=0,this._data.addPower=0;for(var e=0;e<this.m_monsters.length;e++)for(var t=this.m_monsters[e],n=0;n<t.balloons.length;n++){var a=t.balloons[n];a.type==GameConfig.gestureType&&t.ballExplosion(a)}for(var e=0;e<this.m_luckyActors.length;e++){var i=this.m_luckyActors[e];i.ballon.type==GameConfig.gestureType&&i.updateGesture()}for(var e=0;e<this.m_summonActors.length;e++){var o=this.m_summonActors[e];o.gestureType==GameConfig.gestureType&&o.gotoDead()}for(var e=0;e<this.m_spiderActors.length;e++)for(var r=this.m_spiderActors[e],n=0;n<r.balloons.length;n++){var a=r.balloons[n];a.type==GameConfig.gestureType&&r.ballExplosion(a)}this.power+=this._data.addPower,this.updateBatter()}},t.prototype._onBtnPause=function(){GameManager.Instance.pause()},t.prototype._onReadyComplete=function(){this.touchChildren=!0,this.m_bitLabScore.visible=!0,GameManager.Instance.start(),this.m_baby.gotoRun()},t.prototype._onWarningComplete=function(){this.m_isWarning=!1,this.m_rectWarning.visible=!1},t.prototype._onComboBeginComplete=function(){this.comboMove.play(0)},t.prototype._onComboEndComplete=function(){this.m_fntCombo.visible=!1,this.m_fntComboCount.visible=!1},t.prototype._onComboMoveComplete=function(){this.comboMove.play(0)},t.prototype.playSpiderWebArmature=function(e,t){this.m_spiderWebArmatureContainer.visible=!0,this.m_spiderWebArmatureContainer.play(e,1),this.m_spiderStage=t},t.prototype._onSpiderWebArmatureComplete=function(){switch(this.m_spiderStage){case 1:this._createSpiderActor(),this.playSpiderWebArmature("arrive2",2);break;case 2:break;case 5:for(var e=0;e<this.m_spiderActors.length;e++)this.m_spiderActors[e].gotoMove()}},t.prototype._onSpiderWebArmatureFrame=function(){},t.prototype._comboArmature=function(){this.m_comboArmatureContainer.visible=!1},t.prototype.onComplete=function(){this.m_comboArmatureContainer=new DragonBonesArmatureContainer,this.m_groupScore.addChild(this.m_comboArmatureContainer);var e=DragonBonesFactory.getInstance().buildArmatureDisplay("Detonationexplosion","Detonationexplosion"),t=new DragonBonesArmature(e);t.ArmatureDisplay=e,this.m_comboArmatureContainer.register(t,["hong","huang","lan"]),this.m_comboArmatureContainer.x=this.m_groupScore.width/2,this.m_comboArmatureContainer.addCompleteCallFunc(this._comboArmature,this),this.m_spiderWebArmatureContainer=new DragonBonesArmatureContainer,this.m_groupGame.addChild(this.m_spiderWebArmatureContainer);var n=DragonBonesFactory.getInstance().buildArmatureDisplay("wang","wang"),a=new DragonBonesArmature(n);a.ArmatureDisplay=n,this.m_spiderWebArmatureContainer.register(a,["arrive1","arrive2","attack","dead","idle"]),this.m_spiderWebArmatureContainer.x=Config.stageHalfWidth,this.m_spiderWebArmatureContainer.y=420,this.m_spiderWebArmatureContainer.addCompleteCallFunc(this._onSpiderWebArmatureComplete,this),this.m_spiderWebArmatureContainer.addFrameCallFunc(this._onSpiderWebArmatureFrame,this),this.m_spiderWebArmatureContainer.scaleX=2.2,this.m_spiderWebArmatureContainer.scaleY=2.2,this.m_guideArmatureContainer=new DragonBonesArmatureContainer,this.m_groupFull.addChild(this.m_guideArmatureContainer);var i=DragonBonesFactory.getInstance().buildArmatureDisplay("xinshouyindao","xinshouyindao"),o=new DragonBonesArmature(i);o.ArmatureDisplay=i,this.m_guideArmatureContainer.register(o,["xinshouyindao","xinshouyindao4"]),this.m_guideArmatureContainer.x=50,this.m_guideArmatureContainer.y=-520,this.m_baby=new Baby,this.m_groupGame.addChild(this.m_baby),this.m_baby.y=.9*Config.stageHeight,this.addChild(this.m_gestureShape),this.readyAnimate.addEventListener("complete",this._onReadyComplete,this),this.m_btnPause.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnPause,this),this.warning.addEventListener("complete",this._onWarningComplete,this),this.comboBegin.addEventListener("complete",this._onComboBeginComplete,this),this.comboEnd.addEventListener("complete",this._onComboEndComplete,this),this.comboMove.addEventListener("complete",this._onComboMoveComplete,this),this.bossWarning.addEventListener("complete",this._enterBoss,this),this.effectMask.addEventListener("complete",this._beginSkill,this),Common.addTouchBegin(this.m_btnPause),this._progress=new egret.Shape,this._imgPower.mask=this._progress,this._powerGroup.addChild(this._progress),this._arrayProgress.push(this._imgProgress0),this._arrayProgress.push(this._imgProgress1),this._arrayProgress.push(this._imgProgress2),this._arrayProgress.push(this._imgProgress3),this._arrayProgress.push(this._imgProgress4),this._onResize()},t.prototype.setParticle=function(e,t,n){},t.prototype._createMonster=function(){var e=GameObjectPool.getInstance().createObject(Monster,"Monster");e.Init(this._data.levelData,this.m_levelState),e.updateEffectArmature(this.m_baby.skillData),this.m_monsters.push(e);for(var t=this.m_monsters.length-1;t>=0;t--)this.m_groupGame.addChild(this.m_monsters[t])},t.prototype.createLuckyActor=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var n=GameObjectPool.getInstance().createObject(LuckyActor,"LuckyActor");n.init(e,t),this.m_luckyActors.push(n),this.m_groupGame.addChild(n)},t.prototype._createSpiderActor=function(){var e=GameObjectPool.getInstance().createObject(SpiderActor,"SpiderActor");e.Init(this._data.levelData),this.m_spiderActors.push(e),this.m_groupGame.addChild(e)},t.prototype.createSummonActor=function(e,t,n,a,i,o,r){void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=!1);var s=GameObjectPool.getInstance().createObject(SummonActor,"SummonActor"),l=GameConfig.summonTable[e.id.toString()],h=this._data.getSummonTargetX(t,n,i,o,l.Type,r),u=a+MathUtils.getRandom(-20,20);s.init(e,h,u,n,a),this.m_summonActors.push(s);for(var m=this.m_summonActors.length-1;m>=0;m--)this.m_groupGame.addChild(this.m_summonActors[m])},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(GameScenePanel.prototype,"GameScenePanel");var GameSelectLevel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/guankajiemian.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){if(this._curChapterIndex=GameConfig.curChpter%1e3,this._curSelectChapter=GameConfig.curChpter,this._updateChapterInfo(),this._curSelectChapter==GameConfig.curChpter&&1==GameConfig.isOpenNewChapter){this.m_imgIcon.visible=!1;var e=GameConfig.chapterTable[this._curSelectChapter.toString()];this.m_imgChapter.source=e.unlockIcon,this.m_imgIcon.source="guankajiemian13_png"}this.m_imgEndlessBg.source="guankajiemian12_png",this.m_imgEndlessIcon.source="guankajiemian15_png",GameConfig.curChpter<=1001&&(this.m_imgEndlessBg.source="guankajiemian16_png",this.m_imgEndlessIcon.source="guankajiemian14_png")},t.prototype.onEnter=function(){this.touchChildren=!1,this.initData(),this.show.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,Common.gameScene().uiLayer.removeChild(this)},Object.defineProperty(t.prototype,"selectChater",{get:function(){return this._curSelectChapter},enumerable:!0,configurable:!0}),t.prototype._onShow=function(){GameConfig.isOpenNewChapter?(this.m_groupLock.visible=!0,this.suo.play(0)):this.touchChildren=!0},t.prototype._OnHide=function(){Common.dispatchEvent(MainNotify.closeGameSelectLevel),1==this._status?Common.dispatchEvent(MainNotify.openGamePanel):Common.dispatchEvent(MainNotify.openGameStartPanel)},t.prototype._OnLock=function(){this.touchChildren=!0,this.m_imgIcon.visible=!0;var e=GameConfig.chapterTable[this._curSelectChapter.toString()];this.m_imgChapter.source=e.icon},t.prototype._onMaskClick=function(){this.touchChildren=!1,this.hide.play(0),this._status=0},t.prototype._onChapterBegin=function(){this.m_imgChapter.alpha=.8},t.prototype._onChapterEnd=function(){this.m_imgChapter.alpha=1},t.prototype._onChapterClick=function(){this._isLock()||(this._beforeEnterBattle(),GameConfig.gameMode=EBattleMode.Level)},t.prototype._onEndlessBegin=function(){this.m_imgEndlessBg.alpha=.8},t.prototype._onEndlessEnd=function(){this.m_imgEndlessBg.alpha=1},t.prototype._onEndlessClick=function(){GameConfig.curChpter>1001&&(this._beforeEnterBattle(),GameConfig.gameMode=EBattleMode.Endless)},t.prototype._beforeEnterBattle=function(){this.touchChildren=!1,this.hide.play(0),this._status=1,GameVoice.beginBGMChannel.stop();var e=GameVoice.vectory.play(0,1);e.volume=GameConfig.soundValue/100},t.prototype._isLock=function(){return this._curSelectChapter>GameConfig.curChpter?!0:!1},t.prototype._updateChapterInfo=function(){var e=GameConfig.chapterTable[this._curSelectChapter.toString()];if(this.m_imgIcon.visible=!0,this.m_groupLock.visible=!1,this.m_imgChapter.source=e.icon,this.m_labChapter.text=this._curChapterIndex.toString(),this._curSelectChapter==GameConfig.curChpter&&GameConfig.curLevel>0){var t=GameConfig.levelTable[GameConfig.curLevel.toString()];this.m_labChapter.text=this._curChapterIndex.toString()+"-"+t.level.toString()}this.m_imgIcon.source="guankajiemian13_png",this._isLock()&&(this.m_imgChapter.source=e.unlockIcon,this.m_imgIcon.source="guankajiemian14_png")},t.prototype._onNextClick=function(){this._curChapterIndex<18&&(this._curSelectChapter++,this._curChapterIndex++,this._updateChapterInfo())},t.prototype._onLastClick=function(){this._curChapterIndex>1&&(this._curChapterIndex--,this._curSelectChapter--,this._updateChapterInfo())},t.prototype._onComplete=function(){this.m_imgMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onMaskClick,this),this.m_imgChapter.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._onChapterBegin,this),this.m_imgChapter.addEventListener(egret.TouchEvent.TOUCH_END,this._onChapterEnd,this),this.m_imgChapter.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._onChapterEnd,this),this.m_imgChapter.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onChapterClick,this),this.m_imgEndlessBg.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._onEndlessBegin,this),this.m_imgEndlessBg.addEventListener(egret.TouchEvent.TOUCH_END,this._onEndlessEnd,this),this.m_imgEndlessBg.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this._onEndlessEnd,this),this.m_imgEndlessBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onEndlessClick,this),this.m_btnNext.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onNextClick,this),this.m_btnLast.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onLastClick,this),Common.addTouchBegin(this.m_btnNext),Common.addTouchBegin(this.m_btnLast),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._OnHide,this),this.suo.addEventListener("complete",this._OnLock,this)},t}(BasePanel);__reflect(GameSelectLevel.prototype,"GameSelectLevel");var GameStartPanel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/gameStart.exml",t}return __extends(t,e),t.prototype.initPanel=function(){this.m_isInit=!1},t.prototype.initData=function(){this._actorArmatureContainer.clear();var e=DragonBonesFactory.getInstance().buildArmatureDisplay(GameConfig.curBabyData.action,GameConfig.curBabyData.action);null==this._actorArmature&&(this._actorArmature=new DragonBonesArmature(e)),this._actorArmature.ArmatureDisplay=e,this._actorArmatureContainer.register(this._actorArmature,["fangdazhao","idle","zoulu"]),this._actorArmatureContainer.play("idle"),this.m_labCandy.text=GameConfig.candy.toString();var t=GameConfig.curChpter%1e3;this.m_labEvent.text=GameConfig.maxScore.toString(),this.m_labGrade.text=t.toString(),this.m_btnAddCandy.x=100+this.m_labCandy.width
},t.prototype.onEnter=function(){this.touchChildren=!1;var e=GameConfig.chapterTable[GameConfig.curChpter.toString()];GameConfig.curBattleChapter>0&&(e=GameConfig.chapterTable[GameConfig.curBattleChapter.toString()]),GameManager.Instance.updateSceneBg(e.bg,e.water),GameManager.Instance.updateSceneCloud(e.cloud1,e.cloud2),GameManager.Instance.updateSceneSun(e.sun),this.show.play(0),this.initData(),this._onDialog(),null!=GameVoice.beginBGMChannel&&GameVoice.beginBGMChannel.stop(),GameVoice.beginBGMChannel=GameVoice.beginBGMSound.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,this.groupDialog.visible=!1,Common.gameScene().uiLayer.removeChild(this)},t.prototype._onHideCloth=function(){Common.dispatchEvent(MainNotify.closeGameStartPanel),Common.dispatchEvent(MainNotify.openGamePanel)},t.prototype._onStartGame=function(){this.touchChildren=!1,this._sceneType=1,this.m_maskRect.visible=!1,this.hide.play(0)},t.prototype._onBtnSetting=function(){Common.dispatchEvent(MainNotify.openSettingPanel)},t.prototype._onBtnAddCandy=function(){Common.dispatchEvent(MainNotify.openRechargePanel)},t.prototype._onBtnGift=function(){GameConfig.sceneType=0,Common.dispatchEvent(MainNotify.openCapsulePanel)},t.prototype._onBtnAd=function(){},t.prototype._onActorClick=function(){this.touchChildren=!1,this._sceneType=2,this.hide.play(0)},t.prototype._onInitGameComplete=function(){this.touchChildren=!0},t.prototype._onShow=function(){this.touchChildren=!0},t.prototype._onHide=function(){switch(Common.dispatchEvent(MainNotify.closeGameStartPanel),this._sceneType){case 1:GameConfig.isOpenNewChapter=!1,Common.dispatchEvent(MainNotify.openGameSelectLevel);break;case 2:Common.dispatchEvent(MainNotify.openActorListPanel)}},t.prototype._onBtnSign=function(){Common.dispatchEvent(MainNotify.openSignPanel)},t.prototype._updateCandy=function(){this.m_labCandy.text=GameConfig.candy.toString()},t.prototype._onDialog=function(){this.groupDialog.visible=!1,0==GameConfig.babylistIndex?this._setTimeOut(5e3):this._setTimeOut(3e4)},t.prototype._showDialog=function(){this.groupDialog.visible=!0,this.yuye.play(0)},t.prototype._setTimeOut=function(e){egret.setTimeout(this._showDialog,this,e)},t.prototype.onComplete=function(){this._onResize(),this.m_btnGameStart.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onStartGame,this),this.m_btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnSetting,this),this.m_btnAddCandy.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnAddCandy,this),this.m_btnGift.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnGift,this),this.m_btnAd.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnAd,this),this.m_btnSign.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnSign,this),Common.addTouchBegin(this.m_btnGameStart),Common.addTouchBegin(this.m_btnSetting),Common.addTouchBegin(this.m_btnAd),Common.addTouchBegin(this.m_btnAddCandy),Common.addTouchBegin(this.m_btnGift),Common.addTouchBegin(this.m_btnSign),this._actorArmatureContainer=new DragonBonesArmatureContainer,this._actorArmatureContainer.x=this.groupActor.width/2,this._actorArmatureContainer.y=this.groupActor.height,this.groupActor.addChild(this._actorArmatureContainer),this.groupActor.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onActorClick,this),this._liheArmatureContainer=new DragonBonesArmatureContainer,this._liheArmatureContainer.x=200,this._liheArmatureContainer.y=80,this.groupTopRight.addChild(this._liheArmatureContainer);var e=DragonBonesFactory.getInstance().buildArmatureDisplay("lihe","lihe"),t=new DragonBonesArmature(e);t.ArmatureDisplay=e,this._liheArmatureContainer.register(t,["newAnimation"]),this._liheArmatureContainer.play("newAnimation"),this._adArmatureContainer=new DragonBonesArmatureContainer,this._adArmatureContainer.x=84,this._adArmatureContainer.y=146,this.groupBtnAd.addChild(this._adArmatureContainer);var n=DragonBonesFactory.getInstance().buildArmatureDisplay("tubiao","tubiao"),a=new DragonBonesArmature(n);a.ArmatureDisplay=n,this._adArmatureContainer.register(a,["newAnimation"]),this._adArmatureContainer.play("newAnimation"),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._onHide,this),this.yuye.addEventListener("complete",this._onDialog,this),Common.addEventListener(MainNotify.updateCandy,this._updateCandy,this)},t.prototype._onResize=function(t){void 0===t&&(t=null),e.prototype._onResize.call(this,t)},t}(BasePanel);__reflect(GameStartPanel.prototype,"GameStartPanel");var GetRewardUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/getReward.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(e,t){},t.prototype.onEnter=function(){if(this.touchChildren=!1,this._lightShow.play(0),this._lightLoop.stop(),Common.log(GameConfig.rewardType),GameConfig.rewardType==EReward.Candy)this._imgItem.visible=!1,this._babyGroup.visible=!1,this._candCount.visible=!1;else{var e=GameConfig.rewardData;this._imgItem.visible=!1,this._babyGroup.visible=!0,this._candCount.visible=!1,this._actorArmatureContainer.clear();var t=DragonBonesFactory.getInstance().buildArmatureDisplay(e.action,e.action);null==this._actorArmature&&(this._actorArmature=new DragonBonesArmature(t)),this._actorArmature.ArmatureDisplay=t,this._actorArmatureContainer.register(this._actorArmature,["fangdazhao","idle","zoulu"]),this._actorArmatureContainer.play("idle"),this._actorArmatureContainer.visible=!1}Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){Common.gameScene().uiLayer.removeChild(this)},t.prototype._onClose=function(){},t.prototype._onShow=function(){},t.prototype._onHide=function(){},t.prototype._lightShowComplete=function(){this._lightLoop.play(0),this.touchChildren=!0,GameConfig.rewardType==EReward.Candy?(this._imgItem.visible=!0,this._candCount.visible=!0,this._candCount.text=GameConfig.rewardCandy.toString()):this._actorArmatureContainer.visible=!0},t.prototype._lightLoopComplete=function(){this._lightLoop.play(0)},t.prototype._onResult=function(){Common.dispatchEvent(MainNotify.closeGetRewardPanel)},t.prototype.onComplete=function(){this._onResize(),this._actorArmatureContainer=new DragonBonesArmatureContainer,this._actorArmatureContainer.x=this._babyGroup.width/2,this._actorArmatureContainer.y=this._babyGroup.height,this._babyGroup.addChild(this._actorArmatureContainer),this._lightShow.addEventListener("complete",this._lightShowComplete,this),this._lightLoop.addEventListener("complete",this._lightLoopComplete,this),this.groupResult.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onResult,this)},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(GetRewardUI.prototype,"GetRewardUI");var LuckyActor=function(e){function t(){var t=e.call(this)||this;return t._balloon=new Balloon,t._groupBalloon.addChild(t._balloon),t}return __extends(t,e),t.prototype.init=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._sumWeight=0;for(var n=0;n<GameConfig.luckyConfig.length;n++)this._sumWeight+=GameConfig.luckyConfig[n].Prob,GameConfig.luckyConfig[n].weight=this._sumWeight;this._data=this._randomLuckyActorData(),this._data?(this.initData(),this.initGraph(e,t)):Error("no wolf data")},t.prototype.initData=function(){var e=this._data.Animation,t=DragonBonesFactory.getInstance().buildArmatureDisplay(e,e);null==this._armature&&(this._armature=new DragonBonesArmature(t)),this._armature.ArmatureDisplay=t,this._armatureContainer.visible=!0,this._armatureContainer.register(this._armature,[DragonBonesAnimations.Idle,DragonBonesAnimations.Dead,DragonBonesAnimations.Run,DragonBonesAnimations.Hurt,DragonBonesAnimations.Explore]),this._state=EMonsterState.Ready,this._speedY=0,this._speedX=this._data.Speed/10,this._armatureContainer.scaleX=this._data.Scale,this._armatureContainer.scaleY=this._data.Scale,this._armatureContainer.addCompleteCallFunc(this._onArmatureComplete,this),this._rect.width=this._data.Width,this._rect.height=this._data.Height,this._width=this._data.Width,this._height=this._data.Height,this.resetGestureData()},t.prototype.resetGestureData=function(){this._gestureData.length=0;for(var e=0;e<this._data.balloon.length;e++){var t=this._data.balloon[e];1==this._data.balloon.length&&(t=t.toString()),this._gestureData.push(GameConfig.gestureTable[t])}},t.prototype.initGraph=function(e,t){this.x=Config.stageWidth+this._width/2,this.y=MathUtils.getRandom(Config.stageHalfHeight-200,Config.stageHalfHeight+200),null!=e&&null!=t&&(this.x=e,this.y=t),this.gotoIdle(),this._balloon.init(this._gestureData,this),this._setBallonPosition(this._balloon,1,0)},t.prototype.gotoIdle=function(){this._speedX=.16*1.3,this._state=EMonsterState.Ready,this._armatureContainer.play(DragonBonesAnimations.Idle,0)},t.prototype.gotoHurt=function(){this._speedX=.05,this._armatureContainer.play(DragonBonesAnimations.Hurt,1)},t.prototype.destroy=function(){this._armatureContainer.clear(),this._effectArmatureContainer.clear(),GameObjectPool.getInstance().destroyObject(this)},t.prototype.update=function(e){this._state==EMonsterState.Ready&&(this.x-=e*this._speedX,this.x<=-this._width/2&&(this.x=-this._width/2,this._state=EMonsterState.Dead,this.destroy(),PanelManager.gameScenePanel.removeLuckyActor(this)))},t.prototype.updateGesture=function(){this._balloon.updateColorAndGesture();var e=GameVoice.ballonBoomSound.play(0,1);e.volume=GameConfig.soundValue/100,GameConfig.balloonScore+=this._balloon.score,PanelManager.gameScenePanel.boom=!0,this.gotoHurt()},Object.defineProperty(t.prototype,"ballon",{get:function(){return this._balloon},enumerable:!0,configurable:!0}),t.prototype._onArmatureComplete=function(){this.gotoIdle()},t.prototype._randomLuckyActorData=function(){for(var e=MathUtils.getRandom(1,this._sumWeight),t=0;t<GameConfig.luckyConfig.length;t++)if(e<=GameConfig.luckyConfig[t].weight)return GameConfig.luckyConfig[t];return null},t}(BaseActor);__reflect(LuckyActor.prototype,"LuckyActor");var Monster=function(e){function t(){var t=e.call(this)||this;return t._balloons=new Array,t}return __extends(t,e),t.prototype.Init=function(e,t){var n=null;switch(this._summonType=-1,t){case ELevelType.Normal:n=e.normal,this._sumWeight=0;for(var a=0;a<n.length;a++)this._sumWeight+=n[a].prob,n[a].weight=this._sumWeight;for(var i=MathUtils.getRandom(1,this._sumWeight),a=0;a<n.length;a++)if(i<=n[a].weight){this._gesturDiff=n[a].diff,this._balloonMin=n[a].min,this._balloonMax=n[a].max;var o=n[a].summon;o>0&&(this._summonData=GameConfig.summonSkillTable[o],this._summonType=this._summonData.type),this._data=GameConfig.monsterTable[n[a].id.toString()],this._type=this._data.Difficult;break}break;case ELevelType.Elite:this._gesturDiff=PanelManager.gameScenePanel.boss.diff,this._balloonMin=PanelManager.gameScenePanel.boss.min,this._balloonMax=PanelManager.gameScenePanel.boss.max;var r=PanelManager.gameScenePanel.boss.summon;r>0&&(this._summonData=GameConfig.summonSkillTable[r],this._summonType=this._summonData.type),this._data=GameConfig.monsterTable[PanelManager.gameScenePanel.boss.id.toString()],this._type=this._data.Difficult,GameConfig.monsterPos=3;var s=.8*GameConfig.bgmValue/100;egret.Tween.get(GameVoice.battleBGMChannel).to({volume:.2},500).call(function(){var e=GameVoice.smallBossSound.play(0,1);e.volume=0,egret.Tween.get(e).to({volume:GameConfig.soundValue/100},2e3).call(function(){egret.Tween.get(GameVoice.battleBGMChannel).to({volume:s},500)})})}this._data?(this.initData(),this.initGraph()):Error("no wolf data")},t.prototype.initData=function(){e.prototype.initData.call(this);var t=this._data.Animation,n=DragonBonesFactory.getInstance().buildArmatureDisplay(t,t);switch(null==this._armature&&(this._armature=new DragonBonesArmature(n)),this._armature.ArmatureDisplay=n,this._armatureContainer.visible=!0,this._effectArmatureContainer.visible=!1,this._armatureContainer.register(this._armature,[DragonBonesAnimations.Idle,DragonBonesAnimations.Dead,DragonBonesAnimations.Run,DragonBonesAnimations.Hurt,DragonBonesAnimations.Explore]),this._state=EMonsterState.Ready,this._addNum=0,this._speedY=this._data.Speed/100*GameConfig.gameSpeedPercent,this._baseSpeedY=this._speedX,this._spFall=.9,this._speedX=.2,this._armatureContainer.scaleX=this._data.Scale,this._armatureContainer.scaleY=this._data.Scale,this._armatureContainer.addFrameCallFunc(this._onArmatureFrame,this),this._rect.width=this._data.Width,this._rect.height=this._data.Height,this._width=this._data.Width,this._height=this._data.Height,this._slowDelay=-1,this._gestureData.length=0,this.resetHardGesture(),this.resetCenterGesture(),this.resetNormalGesture(),this._gesturDiff){case EGestureDifficult.Mix:for(var a=0;a<GameConfig.gestureConfig.length;a++)this._gestureData.push(GameConfig.gestureConfig[a]);break;case EGestureDifficult.Easy:case EGestureDifficult.Normal:case EGestureDifficult.Center:case EGestureDifficult.Hard:for(var a=0;a<GameConfig.gestureConfig.length;a++)GameConfig.gestureConfig[a].difficult==this._gesturDiff&&this._gestureData.push(GameConfig.gestureConfig[a]);break;case EGestureDifficult.NAndH:var i=MathUtils.getRandom(this._normalGesture.length-1);this._gestureData.push(this._normalGesture[i]),i=MathUtils.getRandom(this._hardGesture.length-1),this._gestureData.push(this._hardGesture[i]);break;case EGestureDifficult.NAndHH:var o=MathUtils.getRandom(this._normalGesture.length-1);this._gestureData.push(this._normalGesture[o]),o=MathUtils.getRandom(this._hardGesture.length-1),this._gestureData.push(this._hardGesture[o]),this._hardGesture.splice(o,1),o=MathUtils.getRandom(this._hardGesture.length-1),this._gestureData.push(this._hardGesture[o]);break;case EGestureDifficult.NNAndH:var r=MathUtils.getRandom(this._hardGesture.length-1);this._gestureData.push(this._hardGesture[r]),r=MathUtils.getRandom(this._normalGesture.length-1),this._gestureData.push(this._normalGesture[r]),this._normalGesture.splice(r,1),r=MathUtils.getRandom(this._normalGesture.length-1),this._gestureData.push(this._normalGesture[r])}GameConfig.isGuide&&(this._gestureData.length=0,0==GameConfig.guideIndex&&this._gestureData.push(GameConfig.gestureTable[1002]),1==GameConfig.guideIndex&&this._gestureData.push(GameConfig.gestureTable[1001]),2==GameConfig.guideIndex&&this._gestureData.push(GameConfig.gestureTable[1002])),this._sumBalloon=0},t.prototype.initGraph=function(){switch(this.y=0,this.gotoIdle(),this.updateSignSlot(),GameConfig.monsterPos){case 1:this.x=MathUtils.getRandom(this._rect.width+50,Config.stageLeft-this._rect.width),this.ePos=EMonsterPos.Left,GameConfig.monsterPos=2;break;case 2:this.x=MathUtils.getRandom(Config.stageCenter+this._rect.width,Config.stageWidth-this._rect.width-50),this.ePos=EMonsterPos.Right,GameConfig.monsterPos=3;break;case 3:this.x=MathUtils.getRandom(Config.stageLeft+this._rect.width,Config.stageCenter-this._rect.width),this.ePos=EMonsterPos.Middle,GameConfig.monsterPos=1}},t.prototype.gotoIdle=function(){1009==this._data.ID?this._armatureContainer.play(DragonBonesAnimations.Idle,0,1,1,.65):1002==this._data.ID?this._armatureContainer.play(DragonBonesAnimations.Idle,0,1,1,.9):1011==this._data.ID?this._armatureContainer.play(DragonBonesAnimations.Idle,0,1,1,.65):1012==this._data.ID?this._armatureContainer.play(DragonBonesAnimations.Idle,0,1,1,.9):this._armatureContainer.play(DragonBonesAnimations.Idle,0)},t.prototype.gotoHurt=function(){this._armatureContainer.play(DragonBonesAnimations.Hurt,0)},t.prototype.gotoDead=function(){this._armatureContainer.play(DragonBonesAnimations.Dead,1),this._state=EMonsterState.Dead,this._data.Type==EMonsterType.FallDown&&(this._state=EMonsterState.FallDown),this._armatureContainer.addCompleteCallFunc(this._onArmatureComplet,this),PanelManager.gameScenePanel.sceneData.addPower+=this._data.Power,GameConfig.balloonScore+=this._data.Score,PanelManager.gameScenePanel.boom=!0,PanelManager.gameScenePanel.levelStage==ELevelType.Elite&&GameManager.Instance.gameSlow()},t.prototype.gotoRun=function(){this._destroyBalloon(),this._armatureContainer.play(DragonBonesAnimations.Run,0),GameManager.Instance.stop()},t.prototype.GotoFallWater=function(){this._effectArmatureContainer.clear();var e=DragonBonesFactory.getInstance().buildArmatureDisplay("shuihua","shuihua");null==this._effectArmature&&(this._effectArmature=new DragonBonesArmature(e)),this._effectArmature.ArmatureDisplay=e,this._effectArmatureContainer.register(this._effectArmature,["shuihua"]),this._effectArmatureContainer.scaleX=.8,this._effectArmatureContainer.scaleY=.8;var t=GameConfig.chapterTable[PanelManager.gameSelectLevel.selectChater.toString()];1==t.water?this._effectArmatureContainer.visible=!0:this._effectArmatureContainer.visible=!1,this._effectArmatureContainer.play("shuihua",1),ShakeTool.getInstance().shakeObj(GameManager.Instance.imageScene,2.3,4,8),this._effectArmatureContainer.addCompleteCallFunc(this.onEffectArmatureComplete,this)},t.prototype.gotoSlow=function(){},t.prototype.changeToEasy=function(){this._gestureData.length=0;for(var e=0;e<GameConfig.gestureConfig.length;e++){var t=GameConfig.gestureConfig[e];if(2==t.type)for(var n=0;3>n;n++)this._gestureData.push(t)}for(var e=0;e<this._balloons.length;e++)this._balloons[e].changeToEasy()},t.prototype.updateEffectArmature=function(t){e.prototype.updateEffectArmature.call(this,t)},t.prototype.playEffect=function(e){this._effectArmatureContainer.visible=!0,this._effectArmatureContainer.play(e.skill,1),this._state==EMonsterState.Ready&&(this._state=EMonsterState.Stop)},t.prototype.ballExplosion=function(e){if(this.y>=200&&this._state==EMonsterState.Ready||GameConfig.isGuide){this._exploreIndex=0;for(var t=0;t<this._balloons.length;t++){var n=this._balloons[t];if(n==e){PanelManager.gameScenePanel.boom=!0,this._balloons.splice(t,1),n.balloonExplore(),this._exploreIndex=t;break}}}},t.prototype.allBalloonExplosion=function(){for(;this._balloons.length>0;){var e=this._balloons.pop();e.balloonExplore()}},t.prototype.removeBalloon=function(e){this._groupBalloon.contains(e)?this._groupBalloon.removeChild(e):e.parent.removeChild(e)},t.prototype.update=function(t){if(e.prototype.update.call(this,t),this._state==EMonsterState.Ready)this.y+=t*this._speedY,GameConfig.isGuide?this.y>=PanelManager.gameScenePanel.guidePos&&(this.y=PanelManager.gameScenePanel.guidePos,this._state=EMonsterState.Stop,PanelManager.gameScenePanel.guideStart()):this.y>=PanelManager.gameScenePanel.groundPos&&(this.y=PanelManager.gameScenePanel.groundPos,this._state=EMonsterState.Run,this.gotoRun());else if(this._state==EMonsterState.FallDown&&(this.y+=t*this._spFall,this.y>=PanelManager.gameScenePanel.waterPos)){this.y=PanelManager.gameScenePanel.waterPos,this._state=EMonsterState.Drown,this._armatureContainer.visible=!1;var n=GameConfig.chapterTable[PanelManager.gameSelectLevel.selectChater.toString()];if(1==n.water)GameVoice.fallDownWaterSound.play(0,1);else{var a=RES.getRes("fallDownGround_mp3");a.play(0,1)}this.GotoFallWater()}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._armatureContainer.removeCompleteCallFunc(this._onArmatureComplet,this),this._effectArmatureContainer.removeCompleteCallFunc(this.onEffectArmatureComplete,this),this._effectArmatureContainer.removeFrameCallFunc(this.onEffectArmatureFram,this),this._destroyBalloon(),this._armatureContainer.clear(),this._effectArmatureContainer.clear(),GameObjectPool.getInstance().destroyObject(this)},t.prototype.destroyAndRemove=function(){e.prototype.destroyAndRemove.call(this),this.destroy(),PanelManager.gameScenePanel.removeMonster(this)},t.prototype.updateSignSlot=function(){this._destroyBalloon(),this._sumBalloon=MathUtils.getRandom(this._balloonMin,this._balloonMax);for(var e=0;e<this._sumBalloon;e++){var t=GameObjectPool.getInstance().createObject(Balloon,"Balloon");t.init(this._gestureData,this),this._setBallonPosition(t,this._sumBalloon,e),this._groupBalloon.addChild(t),this._score+=t.score,this._balloons.push(t)}},Object.defineProperty(t.prototype,"Score",{get:function(){return this._score},set:function(e){this._score=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t.prototype.onEffectArmatureComplete=function(){e.prototype.onEffectArmatureComplete.call(this)},t.prototype.onEffectArmatureFram=function(t){e.prototype.onEffectArmatureFram.call(this,t);var n=t.frameLabel;switch(n){case"xiaoshi":this._destroyBalloon(),this._armatureContainer.visible=!1}},t.prototype._spide=function(e,t,n,a,i){var o=GameVoice.spideBall.play(0,1);o.volume=GameConfig.soundValue/100,PanelManager.gameScenePanel.createSummonActor(e,this._ePos,t,n,a,i)},t.prototype._onArmatureFrame=function(e){var t=e.frameLabel;switch(t){case"vomit":if(GameManager.Instance.gameState==EGameState.Start&&void 0!=this._summonData&&1==this._summonType){var n=0;n=this._summonData.count>0?this._summonData.count:MathUtils.getRandom(this._summonData.min,this._summonData.max);for(var a=0;n>a;a++)egret.setTimeout(this._spide,this,200*a,this._summonData,this.x,this.y,n,a)}}},t.prototype._summon=function(e,t,n,a,i){var o=GameVoice.summon.play(0,1);o.volume=GameConfig.soundValue/100,PanelManager.gameScenePanel.createSummonActor(e,this._ePos,t,n,a,i)},t.prototype._onArmatureComplet=function(){if(this._state==EMonsterState.Dead){if(this._effectArmatureContainer.visible=!1,null!=this._summonData&&2==this._summonType){var e=0;e=this._summonData.count>0?this._summonData.count:MathUtils.getRandom(this._summonData.min,this._summonData.max);for(var t=0;e>t;t++)this._summon(this._summonData,this.x,this.y,e,t)}this.destroyAndRemove(),this._summonType=-1,this._state=EMonsterState.SummonFinish}else this._state==EMonsterState.FallDown&&this._armatureContainer.play(DragonBonesAnimations.Dead,0,2,6)},t.prototype._randomMonsterData=function(){for(var e=MathUtils.getRandom(1,this._sumWeight),t=0;t<GameConfig.monsterConfig.length;t++)if(e<=GameConfig.monsterConfig[t].weight)return GameConfig.monsterConfig[t];return null},t}(BaseActor);__reflect(Monster.prototype,"Monster");var PermanentUI=function(e){function t(){var t=e.call(this)||this;return t.m_cloud1Speed=.6,t.m_cloud2Speed=.3,t.m_cloud3Speed=.1,t.m_sunSpeed=.05,t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/permanentUI.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"sceneBg",{get:function(){return this.m_imgBg},enumerable:!0,configurable:!0}),t.prototype.updateScene=function(e,t){this.m_imgBg.source=e,0==t?this.groupRiver.visible=!1:this.groupRiver.visible=!0},t.prototype.updateSun=function(e){null==e?this.m_imgSun.visible=!1:(this.m_imgSun.visible=!0,this.m_imgSun.source=e)},t.prototype.updateCloud=function(e,t){this.m_cloud2.source=t,this.m_cloud3.source=e},t.prototype.update=function(){this.m_cloud1.x>=-this.m_cloud1.width?this.m_cloud1.x-=this.m_cloud1Speed:this.m_cloud1.x=Config.stageWidth,this.m_cloud2.x>=-this.m_cloud2.width?this.m_cloud2.x-=this.m_cloud2Speed:this.m_cloud2.x=Config.stageWidth,this.m_cloud3.x<=Config.stageWidth+this.m_cloud3.width?this.m_cloud3.x+=this.m_cloud1Speed:this.m_cloud3.x=-this.m_cloud3.width,this.m_imgSun.x<=Config.stageWidth+this.m_imgSun.width?this.m_imgSun.x+=this.m_sunSpeed:this.m_imgSun.x=-this.m_imgSun.width},t.prototype._onWaterComplete=function(){this.water.play(0)},t.prototype._onComplete=function(){ShakeTool.getInstance().setInitPos(this.m_imgBg.x,this.m_imgBg.y),this.water.play(0),this.water.addEventListener("complete",this._onWaterComplete,this)},t}(BasePanel);__reflect(PermanentUI.prototype,"PermanentUI");var RechargeUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/chongzhi.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){this.m_labCount.text=GameConfig.candy.toString(),this.m_labCount.x=720-this.m_labCount.width,this.m_imgCandy.x=this.m_labCount.x-this.m_imgCandy.width-10},t.prototype.onEnter=function(){this.touchChildren=!1,this.initData(),this.show.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){this.touchChildren=!1,Common.gameScene().uiLayer.removeChild(this)},t.prototype._onBtnReturn=function(){this.touchEnabled=!1,this.hide.play(0)},t.prototype._onShow=function(){this.touchChildren=!0},t.prototype._onHide=function(){Common.dispatchEvent(MainNotify.closeRechargePanel)},t.prototype._onComplete=function(){this.m_btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnReturn,this),this.m_imgMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnReturn,this),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._onHide,this)},t}(BasePanel);__reflect(RechargeUI.prototype,"RechargeUI");var SettingPanel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/settingPanel.exml",t}return __extends(t,e),t.prototype.initPanel=function(){},t.prototype.initData=function(){},t.prototype.onEnter=function(){Common.gameScene().uiLayer.addChild(this),this.m_sliderSound.maximum=100,this.m_sliderBGM.maximum=100,this.m_sliderSound.value=GameConfig.bgmValue,this.m_sliderBGM.value=GameConfig.soundValue,this.m_imgMask.touchEnabled=!1,this.show.play(0)},t.prototype.onExit=function(){Common.gameScene().uiLayer.removeChild(this)},t.prototype._onSoundSlider=function(e){var t=e.target;GameConfig.soundValue=t.pendingValue},t.prototype._onBGMSlider=function(e){var t=e.target;GameConfig.bgmValue=t.pendingValue,null!=GameVoice.beginBGMChannel&&(GameVoice.beginBGMChannel.volume=GameConfig.bgmValue/100)},t.prototype._onClose=function(){this.hide.play(0)},t.prototype._onShow=function(){this.m_imgMask.touchEnabled=!0},t.prototype._onHide=function(){Common.dispatchEvent(MainNotify.closeSettingPanel)},t.prototype.onComplete=function(){this._onResize(),this.m_sliderSound.addEventListener(egret.Event.CHANGE,this._onSoundSlider,this),this.m_sliderBGM.addEventListener(egret.Event.CHANGE,this._onBGMSlider,this),this.m_imgMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onClose,this),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._onHide,this)},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(SettingPanel.prototype,"SettingPanel");var SignPanel=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/game_skins/qiandao.exml",t}return __extends(t,e),t.prototype.initPanel=function(){this._signGroups=new Array},t.prototype.initData=function(){},t.prototype.onEnter=function(){this.m_imgMask.touchEnabled=!1,this.show.play(0),Common.gameScene().uiLayer.addChild(this)},t.prototype.onExit=function(){Common.gameScene().uiLayer.removeChild(this)},t.prototype._onClose=function(){this.hide.play(0)},t.prototype._onShow=function(){this.m_imgMask.touchEnabled=!0,this.m_scroll.verticalScrollBar.visible=!1,this.m_scroll.verticalScrollBar.autoVisibility=!1},t.prototype._onHide=function(){Common.dispatchEvent(MainNotify.closeSignPanel)},t.prototype.onComplete=function(){this._onResize(),this.m_imgMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onClose,this),this.show.addEventListener("complete",this._onShow,this),this.hide.addEventListener("complete",this._onHide,this),this._signGroups.length=0;for(var e=0;e<GameConfig.signConfig.length;e++){var t=GameConfig.signConfig[e],n=GameConfig.signTable[t.id.toString()],a=new SignIR;a.init(n,e),this.m_groupScroll.addChild(a),this._signGroups.push(a)}},t.prototype._onResize=function(e){void 0===e&&(e=null)},t}(BasePanel);__reflect(SignPanel.prototype,"SignPanel");var SignIR=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t._onComplete,t),t.skinName="resource/game_skins/qiandaoIR.exml",t}return __extends(t,e),t.prototype.init=function(e,t){var n=t+1;this.m_labDay.text=n.toString(),this.m_labCount.text="X1",e.rewardType==EReward.Candy&&(this.m_labCount.text="X"+e.reward),this.m_imgReward.source=e.icon,this.m_imgBg.source="qiandao2_png",this.m_imgGou.visible=!1,e.isGet?(this.m_imgBg.source="qiandao3_png",this.m_imgGou.visible=!0):(n==GameConfig.signCount&&1==GameConfig.sign&&(this.m_imgBg.source="qiandao3_png",this.m_imgGou.visible=!0),n==GameConfig.signCount+1&&0==GameConfig.sign&&(this.m_imgBg.source="qiandao3_png"),Common.log(n,GameConfig.signCount,GameConfig.sign)),this.id=e.id,this.index=t,this.data=e},t.prototype._onBtnSign=function(){var e=GameConfig.signTable[this.id.toString()];if(!e.isGet&&this.index==GameConfig.signCount&&0==GameConfig.sign)switch(Common.updateSign(1),GameConfig.signCount++,Common.updateSignCount(GameConfig.signCount),e.isGet=!0,this.m_imgGou.visible=!0,this.data.rewardType){case EReward.Candy:Common.updateCurCandy(this.data.reward),Common.dispatchEvent(MainNotify.updateCandy),GameConfig.rewardData=Common.cloneObj(this.data),GameConfig.rewardCandy=this.data.reward,GameConfig.rewardType=EReward.Candy,Common.dispatchEvent(MainNotify.openGetRewardPanel);break;case EReward.AssignBaby:var t=GameConfig.babyUnlockList.indexOf(this.data.reward);0>t&&(GameConfig.babyUnlockList.push(this.data.reward),Common.updateUnlockBaby());var n=GameConfig.actorTable[this.data.reward.toString()];GameConfig.rewardData=Common.cloneObj(n),GameConfig.rewardType=EReward.AssignBaby,Common.dispatchEvent(MainNotify.openGetRewardPanel)}},t.prototype._onComplete=function(){this.m_imgBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBtnSign,this)},t}(eui.Component);__reflect(SignIR.prototype,"SignIR");var SpiderActor=function(e){function t(){var t=e.call(this)||this;return t._balloons=new Array,t}return __extends(t,e),t.prototype.Init=function(e){var t=e.elite;this._sumWeight=0;for(var n=0;n<t.length;n++)this._sumWeight+=t[n].prob,t[n].weight=this._sumWeight;for(var a=MathUtils.getRandom(1,this._sumWeight),n=0;n<t.length;n++)if(a<=t[n].weight){this._gesturDiff=t[n].diff,this._balloonMin=t[n].min,this._balloonMax=t[n].max,this._summonData=t[n].summon,this._data=GameConfig.monsterTable[t[n].id.toString()],this._type=this._data.Difficult;break}this._data?(this.initData(),this.initGraph()):Error("no wolf data")},t.prototype.initData=function(){var e=this._data.Animation,t=DragonBonesFactory.getInstance().buildArmatureDisplay(e,e);null==this._armature&&(this._armature=new DragonBonesArmature(t)),this._armature.ArmatureDisplay=t,this._effectArmatureContainer.visible=!1,this._armatureContainer.register(this._armature,[DragonBonesAnimations.Idle,DragonBonesAnimations.Dead,DragonBonesAnimations.Run,DragonBonesAnimations.Hurt,DragonBonesAnimations.Explore,DragonBonesAnimations.Arrive,DragonBonesAnimations.Attack,DragonBonesAnimations.ReadyFall,DragonBonesAnimations.Move]),this._state=EMonsterState.Arrive,this._speedY=this._data.Speed/100*GameConfig.gameSpeedPercent,this._spFall=.7,this._speedX=.2,this._armatureContainer.scaleX=this._data.Scale,this._armatureContainer.scaleY=this._data.Scale,this._armatureContainer.addCompleteCallFunc(this._onArmatureComplete,this),this._armatureContainer.addFrameCallFunc(this._onArmatureFrame,this),this._armatureContainer.visible=!1,this._rect.width=this._data.Width,this._rect.height=this._data.Height,this._width=this._data.Width,this._height=this._data.Height,this._gestureData.length=0;for(var n=0;n<GameConfig.gestureConfig.length;n++)this._gesturDiff==EGestureDifficult.Mix?this._gestureData.push(GameConfig.gestureConfig[n]):GameConfig.gestureConfig[n].difficult==this._gesturDiff&&this._gestureData.push(GameConfig.gestureConfig[n]);this._sumBalloon=0,this._summonWave=0,this._spitStage=1,this._sumonDelay=-1},t.prototype.initGraph=function(){this.y=Config.stageHalfHeight-350,this.x=Config.stageHalfWidth,this.ePos=EMonsterPos.Middle,this._armatureContainer.visible=!0,this.gotoArrival()
},t.prototype.gotoArrival=function(){this._state=EMonsterState.Arrive,this._armatureContainer.play(DragonBonesAnimations.Arrive,1);var e=.8*GameConfig.bgmValue/100;egret.Tween.get(GameVoice.battleBGMChannel).to({volume:.2},500).call(function(){var t=GameVoice.spiderKingArrive.play(0,1);t.volume=0,egret.Tween.get(t).to({volume:GameConfig.soundValue/100},2e3).call(function(){egret.Tween.get(GameVoice.battleBGMChannel).to({volume:e},500)})})},t.prototype.Summon=function(e){void 0===e&&(e=2);for(var t=0;e>t;t++)PanelManager.gameScenePanel.createSummonActor(this._summonData,this._ePos,this.x-100,this.y-400,e,t,!0)},t.prototype.gotoIdle=function(){(GameManager.Instance.gameState==EGameState.Start||GameManager.Instance.gameState==EGameState.Pause)&&(this._state=EMonsterState.Ready,this._armatureContainer.play(DragonBonesAnimations.Idle,1),PanelManager.gameScenePanel.playSpiderWebArmature("idle",4))},t.prototype.gotoAttack=function(){(GameManager.Instance.gameState==EGameState.Start||GameManager.Instance.gameState==EGameState.Pause)&&(this._state=EMonsterState.Attack,this._isSpit=!1,this._armatureContainer.play(DragonBonesAnimations.Attack,1),PanelManager.gameScenePanel.playSpiderWebArmature("attack",3))},t.prototype.gotoSummonFinish=function(){(GameManager.Instance.gameState==EGameState.Start||GameManager.Instance.gameState==EGameState.Pause)&&(this._state=EMonsterState.SummonFinish,PanelManager.gameScenePanel.playSpiderWebArmature("dead",5))},t.prototype.gotoMove=function(){(GameManager.Instance.gameState==EGameState.Start||GameManager.Instance.gameState==EGameState.Pause)&&(this._state=EMonsterState.Move,this._sumonDelay=0,this.updateSignSlot(),this._armatureContainer.play(DragonBonesAnimations.Move,0))},t.prototype.gotoDead=function(){GameManager.Instance.gameState==EGameState.Start&&(this._armatureContainer.play(DragonBonesAnimations.Dead,1),this._state=EMonsterState.FallDown,PanelManager.gameScenePanel.sceneData.addPower+=this._data.Power,GameManager.Instance.gameSlow())},t.prototype.gotoExplore=function(){},t.prototype.gotoRun=function(){this._destroyBalloon(),this._armatureContainer.play(DragonBonesAnimations.Run,0),GameManager.Instance.stop()},t.prototype.GotoFallWater=function(){this._effectArmatureContainer.clear();var e=DragonBonesFactory.getInstance().buildArmatureDisplay("shuihua","shuihua");null==this._effectArmature&&(this._effectArmature=new DragonBonesArmature(e)),this._effectArmature.ArmatureDisplay=e,this._effectArmatureContainer.register(this._effectArmature,["shuihua"]),this._effectArmatureContainer.scaleX=1,this._effectArmatureContainer.scaleY=1,this._effectArmatureContainer.visible=!0,this._effectArmatureContainer.play("shuihua",1),ShakeTool.getInstance().shakeObj(GameManager.Instance.imageScene,2.3,4,6),this._effectArmatureContainer.addCompleteCallFunc(this._onEffectArmatureComplete,this)},t.prototype.gotoSlow=function(){},t.prototype.ballExplosion=function(e){if(this.y>=200&&this._state==EMonsterState.Move){PanelManager.gameScenePanel.boom=!0,this._exploreIndex=0;for(var t=0;t<this._balloons.length;t++){var n=this._balloons[t];if(n==e){this._balloons.splice(t,1),n.balloonExplore(),this._exploreIndex=t;break}}}},t.prototype.updateSignSlot=function(){this._destroyBalloon(),this._sumBalloon=MathUtils.getRandom(this._balloonMin,this._balloonMax);for(var e=0;e<this._sumBalloon;e++){var t=GameObjectPool.getInstance().createObject(Balloon,"Balloon");t.init(this._gestureData,this),t.scaleX=1.2,t.scaleY=1.2,this._setBallonPosition(t,this._sumBalloon,e),this._groupBalloon.addChild(t),this._score+=t.score,this._balloons.push(t)}},t.prototype._setBallonPosition=function(e,t,n){void 0===n&&(n=0),1==t?(e.x=0,e.y=1.1*-this._rect.height):2==t?(e.x=n*(e.width+100)-100,e.y=1.1*-this._rect.height):3==t&&(0==n?(e.x=0,e.y=1.1*-this._rect.height):(e.x=(n-1)*(e.width+120)-100,e.y=.8*-this._rect.height)),e.setLine()},Object.defineProperty(t.prototype,"gestureData",{get:function(){return this._gestureData},set:function(e){this._gestureData=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedVertical",{set:function(e){this._speedY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedHorizon",{set:function(e){this._speedX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actorTableData",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.update=function(t){if(e.prototype.update.call(this,t),this._state==EMonsterState.Move)this.y+=t*this._speedY,this.y>=PanelManager.gameScenePanel.groundPos&&(this.y=PanelManager.gameScenePanel.groundPos,this._state=EMonsterState.Run,this.gotoRun()),this._sumonDelay>=0&&GameManager.Instance.gameState==EGameState.Start&&(this._sumonDelay+=t,this._sumonDelay>=GameConfig.spiderDelay&&(this._sumonDelay=0));else if(this._state==EMonsterState.FallDown&&(this.y+=t*this._spFall,this.y>=PanelManager.gameScenePanel.waterPos)){this.y=PanelManager.gameScenePanel.waterPos,this._state=EMonsterState.Drown,this._armatureContainer.visible=!1;var n=GameConfig.chapterTable[PanelManager.gameSelectLevel.selectChater.toString()];if(1==n.water)GameVoice.fallDownWaterSound.play(0,1);else{var a=RES.getRes("fallDownGround_mp3");a.play(0,1)}this.GotoFallWater()}},t.prototype.destroy=function(){this._destroyBalloon(),this._armatureContainer.clear(),this._effectArmatureContainer.clear(),GameObjectPool.getInstance().destroyObject(this)},t.prototype.removeBalloon=function(e){},t.prototype._onEffectArmatureComplete=function(){this._state==EMonsterState.Drown&&(this.destroy(),PanelManager.gameScenePanel.removeSpiderActor(this))},t.prototype._onArmatureComplete=function(){switch(this._state){case EMonsterState.Arrive:this.gotoAttack();break;case EMonsterState.Ready:this.gotoAttack();break;case EMonsterState.Attack:this._summonWave>=6?this.gotoSummonFinish():(this._spitStage++,this._spitStage>3&&(this._spitStage=1),this.gotoIdle());break;case EMonsterState.Move:break;case EMonsterState.FallDown:}},t.prototype._onArmatureFrame=function(e){var t=e.frameLabel,n=0,a=0;switch(t){case"summon1":this._isSpit=!0,n=this.x,a=this.y+200;break;case"summon2":this._isSpit=!0,n=this.x-100,a=this.y+200;break;case"summon3":this._isSpit=!0,n=this.x+100,a=this.y+200;break;case"readyFall":}if(this._isSpit){this._isSpit=!1,this._summonWave++;for(var i=MathUtils.getRandom(1,2),o={id:1003,diff:1,ids:[],count:2},r=0;i>r;r++)egret.setTimeout(this._spide,this,400*r,o,n,a,i,r)}},t.prototype._spide=function(e,t,n,a,i){var o=GameVoice.spiderKingDrug.play(0,1);o.volume=GameConfig.soundValue/100,PanelManager.gameScenePanel.createSummonActor(e,this._ePos,t,n,a,i)},t}(BaseActor);__reflect(SpiderActor.prototype,"SpiderActor");var SummonActor=function(e){function t(){var t=e.call(this)||this;return t._balloons=new Array,t.m_gesture=new egret.Bitmap,t.addChild(t.m_gesture),t.m_gesture.scaleX=.55,t.m_gesture.scaleY=.55,t}return __extends(t,e),t.prototype.init=function(e,t,n,a,i){if(this._sumWeight=0,this._type=EMonsterDifficult.Summon,this._data=GameConfig.summonTable[e.id.toString()],this._animations=this._data.Actions,this._gesturDiff=e.diff,this._gestureData.length=0,void 0!=e.ids&&e.ids.length>0)for(var o=0;o<e.ids.length;o++)for(var r=e.ids[o],s=0;s<GameConfig.gestureConfig.length;s++)GameConfig.gestureConfig[s].type==r&&this._gestureData.push(GameConfig.gestureConfig[s]);else for(var o=0;o<GameConfig.gestureConfig.length;o++)this._gesturDiff==EGestureDifficult.Mix?this._gestureData.push(GameConfig.gestureConfig[o]):GameConfig.gestureConfig[o].difficult==this._gesturDiff&&this._gestureData.push(GameConfig.gestureConfig[o]);this._data?(this.initData(),this.initGraph(),this._endX=t,this._endY=n,this._data.Type==ESummonType.Balloon?(this.x=a,this.y=i):this._data.Type==ESummonType.Monster&&(this.x=t,this.y=i)):Error("no wolf data")},t.prototype.initData=function(){e.prototype.initData.call(this);var t=this._data.Animation,n=DragonBonesFactory.getInstance().buildArmatureDisplay(t,t);null==this._armature&&(this._armature=new DragonBonesArmature(n)),this._armature.ArmatureDisplay=n,this._armatureContainer.register(this._armature,this._animations),this._state=EMonsterState.Ready,this._addNum=0,this._speedY=this._data.Speed/100*GameConfig.gameSpeedPercent,this._baseSpeedY=this._speedY,this._speedX=.1,this._effectArmatureContainer.visible=!1,this._armatureContainer.scaleX=this._data.Scale,this._armatureContainer.scaleY=this._data.Scale,this._rect.width=this._data.Width,this._rect.height=this._data.Height,this._width=this._data.Width,this._height=this._data.Height},t.prototype.initGraph=function(){if(this.x=Config.stageWidth+this._width/2,this.y=MathUtils.getRandom(Config.stageHalfHeight-200,Config.stageHalfHeight+200),this.m_gesture.visible=!1,this._groupBalloon.visible=!1,this._armatureContainer.visible=!0,this._destroyBalloon(),this._data.Type==ESummonType.Balloon)this._isArrive=!1,this.updateGesture(),this._armatureContainer.play(this._animationName,1),this._armatureContainer.pause(this._animationName);else if(this._data.Type==ESummonType.Monster){this._isArrive=!0,this._sumBalloon=1;for(var e=0;e<this._sumBalloon;e++){var t=GameObjectPool.getInstance().createObject(Balloon,"Balloon");t.init(this._gestureData,this),this._setBallonPosition(t,this._sumBalloon,e),this._groupBalloon.addChild(t),this._balloons.push(t)}this._animationName=DragonBonesAnimations.Dead,this._gestureType=this._balloons[0].type,this._state=EMonsterState.Summon,this._armatureContainer.play(DragonBonesAnimations.Arrive,1,1,0,3),this._armatureContainer.addCompleteCallFunc(this._onArmatureComplet,this)}},t.prototype.updateGesture=function(){var e=MathUtils.getRandom(this._gestureData.length-1);this.m_gesture.texture=RES.getRes(this._gestureData[e].path),this.m_gesture.anchorOffsetX=this.m_gesture.width/2,this.m_gesture.anchorOffsetY=this.m_gesture.height/2,this.m_gesture.x=this._armatureContainer.x+1,this.m_gesture.y=this._armatureContainer.y-38,this.m_gesture.visible=!0,this._gestureType=this._gestureData[e].type,this._score=this._gestureData[e].count,this._animationName=this._gestureData[e].balloon,this._gestureData.splice(e,1)},t.prototype.gotoIdle=function(){},t.prototype.gotoRun=function(){GameManager.Instance.stop()},Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t.prototype.gotoDead=function(){if(PanelManager.gameScenePanel.boom=!0,this._gestureType=-1,this.m_gesture.visible=!1,this._armatureContainer.play(this._animationName,1),this._state=EMonsterState.Dead,this._armatureContainer.addCompleteCallFunc(this._onArmatureComplet,this),PanelManager.gameScenePanel.sceneData.addPower+=this._data.Power,this._data.Type==ESummonType.Balloon){GameConfig.balloonScore+=this._score,PanelManager.gameScenePanel.boom=!0;var e=GameVoice.ballonBoomSound.play(0,1);e.volume=GameConfig.soundValue/100}else this._data.Type==ESummonType.Monster&&this._balloons[0].balloonExplore(!0)},t.prototype.destroy=function(){this._armatureContainer.removeCompleteCallFunc(this._onArmatureComplet,this),this._destroyBalloon(),this._armatureContainer.clear(),this._armatureContainer.visible=!1,GameObjectPool.getInstance().destroyObject(this)},t.prototype.destroyAndRemove=function(){e.prototype.destroyAndRemove.call(this),this.destroy(),PanelManager.gameScenePanel.removeSummonActor(this)},t.prototype.update=function(t){if(e.prototype.update.call(this,t),this._state==EMonsterState.Ready)if(this._isArrive)this.y+=t*this._speedY,this.y>=PanelManager.gameScenePanel.groundPos&&(this.y=PanelManager.gameScenePanel.groundPos,this._state=EMonsterState.Run,this.gotoRun());else{var n=MathUtils.getDistance(this._endX,this._endY,this.x,this.y);if(10>=n)return void(this._isArrive=!0);var a=MathUtils.getRadian2(this.x,this.y,this._endX,this._endY),i=t/2,o=Math.cos(a)*i,r=Math.sin(a)*i,s=parseFloat(o.toFixed(2)),l=parseFloat(r.toFixed(2));this.x+=s,this.y+=l}},Object.defineProperty(t.prototype,"gestureType",{get:function(){return this._gestureType},enumerable:!0,configurable:!0}),t.prototype.updateEffectArmature=function(t){e.prototype.updateEffectArmature.call(this,t)},t.prototype.playEffect=function(e){this._state==EMonsterState.Ready&&(this._effectArmatureContainer.visible=!0,this._effectArmatureContainer.play(e.skill,1),this._state=EMonsterState.Stop)},t.prototype.onEffectArmatureComplete=function(){e.prototype.onEffectArmatureComplete.call(this)},t.prototype.onEffectArmatureFram=function(e){},t.prototype._onArmatureComplet=function(){this._state==EMonsterState.Dead&&this.destroyAndRemove(),this._state==EMonsterState.Summon&&(this._groupBalloon.visible=!0,this._armatureContainer.play(DragonBonesAnimations.Idle,0),this._state=EMonsterState.Ready,this._armatureContainer.removeCompleteCallFunc(this._onArmatureComplet,this))},t}(BaseActor);__reflect(SummonActor.prototype,"SummonActor");var HttpRequest=function(){function e(){this.urls={},this._reqQueue=new Array}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.addQueue=function(e){this._reqQueue.push(e)},e.prototype.send=function(e,t,n,a,i,o){void 0===a&&(a=!0),void 0===i&&(i=null),void 0===o&&(o=null);var r=GameObjectPool.getInstance().createObject(Http,"Http");r.func=i,r.funcObj=o,r.open(this.urls[t],e,a);var s=JSON.stringify(n);a||(s=Common.getUrlParams(n)),r.send(s)},e}();__reflect(HttpRequest.prototype,"HttpRequest");var Http=function(){function e(){this.httpRequest=new egret.HttpRequest,this.httpRequest.responseType=egret.HttpResponseType.TEXT,this.httpRequest.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this.httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),this.httpRequest.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)}return e.prototype.send=function(e){void 0===e&&(e=null),this.httpRequest.send(e)},e.prototype.open=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=null),this.httpRequest.open(e,t),a&&this.httpRequest.setRequestHeader("Authentication-token",a),n?this.httpRequest.setRequestHeader("Content-Type","application/json"):this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},e.prototype.onPostComplete=function(e){var t=this.httpRequest.response;GameObjectPool.getInstance().destroyObject(this);var n=JSON.parse(t);Common.log("onPostComplete",n)},e.prototype.onPostIOError=function(e){console.log("get Error",e)},e.prototype.onPostProgress=function(e){console.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e.prototype.onPostClose=function(){},e}();__reflect(Http.prototype,"Http");var Animations;!function(e){function t(e,t,n,a){void 0===t&&(t=1e3),void 0===n&&(n=100),void 0===a&&(a=null);var i=Math.floor(t/(2*n)),o=0,r=function(){var t=this;egret.Tween.get(e).to({alpha:.3},n).call(function(){egret.Tween.get(e).to({alpha:1},n).call(function(){egret.Tween.removeTweens(e),o++,i>o?r():a&&a()},t)},this)}.bind(this);r()}function n(e,t,n,a){void 0===t&&(t=1e3),void 0===n&&(n=0),void 0===a&&(a=0);var i=function(){egret.Tween.get(e).to({y:a},t/2).call(function(){egret.Tween.get(e).to({y:n},t/2).call(function(){i()})})};i()}function a(e,t,n){void 0===t&&(t=500),void 0===n&&(n=null),e.scaleX=0,e.scaleY=0,egret.Tween.get(e).to({scaleX:1,scaleY:1},t,egret.Ease.backOut).call(function(){n&&n()})}function i(e,t,n){void 0===t&&(t=500),void 0===n&&(n=null),egret.Tween.get(e).to({scaleX:0,scaleY:0},t,egret.Ease.backIn).call(function(){n&&n()})}function o(e,t){void 0===t&&(t=50),e.alpha=0;var n=function(){egret.Tween.get(e).to({alpha:0},200)};egret.Tween.get(e).to({y:e.y-t,alpha:1},400,egret.Ease.backOut).call(n)}function r(e,t,n,a){void 0===t&&(t=500),void 0===n&&(n=null),void 0===a&&(a=null),e.alpha=0,egret.Tween.get(e).to({alpha:1},t,egret.Ease.circOut).call(function(){a&&a()}),n&&n()}function s(e,t,n){void 0===t&&(t=500),void 0===n&&(n=null),e.alpha=1,egret.Tween.get(e).to({alpha:0},t,egret.Ease.circIn).call(function(){n&&n()})}function l(e,t,n,a,i,o){void 0===t&&(t=200),void 0===n&&(n=200),void 0===a&&(a=0),void 0===i&&(i=null),void 0===o&&(o=null),egret.Tween.get(e).to({alpha:1},t,egret.Ease.quintOut),egret.setTimeout(function(){egret.Tween.get(e).to({alpha:0},n,egret.Ease.quintIn).call(function(){i&&i(o)})},this,a)}e.flash=t,e.floatUpDown=n,e.popupOut=a,e.popupIn=i,e.hurtTips=o,e.fadeOut=r,e.fadeIn=s,e.fadeOutIn=l}(Animations||(Animations={}));var AudioManager=function(){function e(){}return e.balloonBoom="resource/assets/voice/balloonBoom.mp3",e.begin="resource/assets/voice/begin.mp3",e.bgMusic="resource/assets/voice/bgMusic.mp3",e.bottleBreak="resource/assets/voice/bottleBreak.mp3",e.bottleChange="resource/assets/voice/bgMusic.mp3",e.fallGround="resource/assets/voice/fallGround.mp3",e.gesture="resource/assets/voice/gesture.mp3",e.gold="resource/assets/voice/gold.mp3",e.ice="resource/assets/voice/ice.mp3",e.potBoom="resource/assets/voice/potBoom.mp3",e.thief="resource/assets/voice/thief.mp3",e.thunder="resource/assets/voice/thunder.mp3",e.wolfFallDown="resource/assets/voice/wolfFallDown.mp3",e}();__reflect(AudioManager.prototype,"AudioManager");var Common;!function(e){function t(){var e=window.navigator.userAgent.toLowerCase(),t=""+e.match(/MicroMessenger/i);return"null"==t?!1:"micromessenger"==t?!0:void 0}function n(){var e=window.navigator.userAgent.toLowerCase();""+e.match(/MicroMessenger/i);return""+e.match(/windows nt/i)=="windows nt"?"windows":""+e.match(/iphone/i)=="iphone"?"ios":""+e.match(/android/i)=="android"?"android":""+e.match(/ipad/i)=="ipad"?"ipad":""+e.match(/linux/i)=="linux"?"linux":""+e.match(/mac/i)=="mac"?"mac":""+e.match(/ucbrower/i)=="ucbrower"?"ucbrower":void console.log("未知系统类型")}function a(){var e=window.navigator.userAgent.toLowerCase();return""+e.match(/micromessenger/i)=="micromessenger"?"micromessenger":""+e.match(/qzone/i)=="qzone"?"qzone":""+e.match(/weibo/i)=="weibo"?"weibo":""+e.match(/qq/i)=="qq"?"qq":""+e.match(/renren/i)=="renren"?"renren":""+e.match(/txmicroblog/i)=="txmicroblog"?"txmicroblog":""+e.match(/douban/i)=="douban"?"douban":"other"}function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]}function o(e,t){void 0===t&&(t=!1);var n="",a=function(e,t){void 0===t&&(t=!1);for(var a=0;a<e.length;a++){var i=typeof e[a];"string"==i||"number"==i||"boolean"==i?n+=e[a]+",":(n+=o(e[a],!0),t||(n+=","))}e.length>0&&(n=n.substr(0,n.length-1))};if("[object Array]"==Object.prototype.toString.call(e)&&t&&(n+="[",a(e,!0),n+="]"),"[object Object]"==Object.prototype.toString.call(e))if(t){n+="{";for(var i in e)n+='"'+i+'":',n+="string"==typeof e[i]||"number"==typeof e[i]||"boolean"==typeof e[i]?e[i]:o(e[i],!0),n+=",";Object.keys(e).length>0&&(n=n.substr(0,n.length-1)),n+="}"}else for(var r in e){var s=typeof e[r];"string"==s||"number"==s||"boolean"==s?n+=r+"="+e[r]+"&":"[object Array]"==Object.prototype.toString.call(e[r])?(n+=r+"=[",a(e[r],!1),n+="]&"):(n+=r+"=",n+=o(e[r],!0),n+="&")}return n}function r(e){var t=o(e);return t.substr(0,t.length-1)}function s(e,t,n,a){void 0===t&&(t=null),void 0===n&&(n=!1),void 0===a&&(a=!1);var i=new lcp.LEvent(e,t,n,a);lcp.LListener.getInstance().dispatchEvent(i)}function l(e,t,n,a,i){void 0===a&&(a=!1),void 0===i&&(i=0),lcp.LListener.getInstance().addEventListener(e,t,n,a,i)}function h(e,t,n,a){void 0===a&&(a=!1),lcp.LListener.getInstance().removeEventListener(e,t,n,a)}function u(){return egret.MainContext.instance.stage}function m(e,t,n){null!=e&&(e.x=t,e.y=n)}function c(e,t,n,a,i,o){void 0===t&&(t=30),void 0===n&&(n=16777215),void 0===a&&(a=!1),void 0===i&&(i="Arial"),void 0===o&&(o="left");var r=new egret.TextField;return r.text=e,r.size=t,r.textColor=n,r.bold=a,r.fontFamily=i,r.textAlign=o,r}function g(e,t,n,a){var i=new egret.Shape;return i.graphics.beginFill(0,1),i.graphics.drawRect(e,t,n,a),i.graphics.endFill(),i}function p(e){var t,n=RES.getRes(e+"_json"),a=RES.getRes(e+"_png"),i=new egret.MovieClipDataFactory(n,a);return t=new egret.MovieClip(i.generateMovieClipData(e))}function d(e,t,n,a,i){void 0===a&&(a=24),void 0===i&&(i=16777215);var o=new egret.TextField;return o.text=e,o.x=t,o.y=n,o.size=a,o.textColor=i,o}function _(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t}function f(e,t,n){e.x=t,e.y=n}function y(e,t){void 0===t&&(t=null);var n=new egret.BitmapText,a=RES.getRes(e);return n.font=a,t&&t.addChild(n),n}function C(e){var t={};e instanceof Array&&(t=[]);for(var n in e){var a=e[n];t[n]="object"==typeof a?C(a):a}return t}function v(e,t,n,a,i,o,r){void 0===n&&(n=0),void 0===a&&(a=5),void 0===i&&(i=5),void 0===o&&(o=0),void 0===r&&(r=0);var s=new egret.Sprite;return s.graphics.beginFill(n),s.graphics.drawRoundRect(o,r,e,t,a,i),s.graphics.endFill(),s}function b(e,t,n,a){void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0);var i=new egret.Sprite;return i.graphics.beginFill(t),i.graphics.drawCircle(n,a,e),i.graphics.endFill(),i}function S(e,t,n,a,i){void 0===n&&(n=0),void 0===a&&(a=0),void 0===i&&(i=0);var o=new egret.Sprite;return o.graphics.beginFill(n),o.graphics.drawRect(a,i,e,t),o.graphics.endFill(),o}e.TextColors={white:16777215,milkWhite:15722688,grayWhite:13547170,yellow:16776960,lightYellow:16765813,orangeYellow:16750848,red:10824988,green:58624,blue:1742039,grayBlue:3101047,purple:15284466,pink:16724016,black:3026221,golden:16766720,lvNotFull:7301213,lvFull:9551154},e.LabelFontSize={littleSize:12,middleSize:18,normalSize:24,bigSize:36},e.isWeiXin=t,e.systemType=n,e.platformType=a,e.log=i,e.getUrlParams=r,e.dispatchEvent=s,e.addEventListener=l,e.removeEventListener=h,e.curStage=u,e.SetXY=m,e.CreateText=c,e.CreateShape=g,e.CreateMovieClip=p,e.createText=d,e.createBitmap=_,e.setControlPosition=f,e.createBitmapText=y,e.cloneObj=C,e.getRoundRect=v,e.getCircle=b,e.getRect=S;var E=function(){function e(){}return e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.SHAPE_RECT="shape rect",e.SHAPE_RECT_ROUND="shape rect round",e.SHAPE_CIRCLE="shape circle",e.VER_DEBUG="debug",e.VER_RELEASE="release",e}();e.Const=E,__reflect(E.prototype,"Common.Const");var G=function(t){function n(){var e=t.call(this)||this;return e._type=E.SHAPE_RECT,e._color=0,e.display=new egret.Sprite,e.bg=new egret.Sprite,e}return __extends(n,t),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this._data.c=e,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{set:function(e){this._data=e,this.draw()},enumerable:!0,configurable:!0}),n.prototype.draw=function(){this._color=this._data.c,this.display.graphics.clear(),this.display=this.getDisplay(this._data),this.addChild(this.display),this.setPosition()},n.prototype.setPosition=function(){this._hasBg&&this.type!=E.SHAPE_CIRCLE&&(this.display.x=this.bg.width-this.display.width>>1,this.display.y=this.bg.height-this.display.height>>1)},n.prototype.setBackground=function(e,t){void 0===t&&(t=1),this._hasBg=!0;var n=this._data,a={};for(var i in n)a[i]=n[i];a.c=e,a.w&&(a.w=a.w+2*t),a.h&&(a.h=a.h+2*t),a.r&&(a.r=a.r+t),this.bg.graphics.clear(),this.bg=this.getDisplay(a),this.addChildAt(this.bg,0),this.setPosition()},n.prototype.getDisplay=function(t){switch(this.type){case E.SHAPE_RECT:return e.getRect(t.w,t.h,t.c);case E.SHAPE_RECT_ROUND:return e.getRoundRect(t.w,t.h,t.c,t.ew,t.eh);case E.SHAPE_CIRCLE:return e.getCircle(t.r,t.c)}},n}(egret.Sprite);e.MoonDisplayObject=G,__reflect(G.prototype,"Common.MoonDisplayObject")}(Common||(Common={}));var Config=function(){function e(){}return e.UserInfo={nickName:"",avatarUrl:""},e.stageWidth=0,e.stageHeight=0,e.stageHalfWidth=0,e.stageHalfHeight=0,e.stageLeft=0,e.stageCenter=0,e.stageRight=0,e}();__reflect(Config.prototype,"Config");var GameObjectPool=function(){function e(){this._pool={},this._list=[]}return e.prototype.createObject=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i,o=t,r=this._pool[o];if(null!=r&&r.length)i=r.shift();else{var s=n.length;i=0==s?new e:1==s?new e(n[0]):2==s?new e(n[0],n[1]):3==s?new e(n[0],n[1],n[2]):new e(n[0],n[1],n[2],n[3]),i.key=o}return this._list.push(i),i},e.prototype.destroyObject=function(e){var t=e.key;null==this._pool[t]&&(this._pool[t]=[]),this._pool[t].push(e);var n=this._list.indexOf(e);-1!=n&&this._list.splice(n,1)},e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e}();__reflect(GameObjectPool.prototype,"GameObjectPool");var lcp;!function(e){var t=function(e){function t(t,n,a,i){void 0===n&&(n=null),void 0===a&&(a=!1),void 0===i&&(i=!1);var o=e.call(this,t,a,i)||this;return o.name="LEvent",o.key="LEvent",n&&(o._obj=n),o}return __extends(t,e),t.prototype.clone=function(e){return new t(this.type,e?e:this._obj,this.bubbles,this.cancelable)},Object.defineProperty(t.prototype,"param",{get:function(){return this._obj},enumerable:!0,configurable:!0}),t}(egret.Event);e.LEvent=t,__reflect(t.prototype,"lcp.LEvent")}(lcp||(lcp={}));var lcp;!function(e){var t=function(){function e(){this.name="LListener",this.dispatcher||(this.dispatcher=new egret.EventDispatcher)}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.addEventListener=function(e,t,n,a,i){void 0===a&&(a=!1),void 0===i&&(i=0),this.dispatcher.addEventListener(e,t,n,a,i)},e.prototype.removeEventListener=function(e,t,n,a){void 0===a&&(a=!1),this.dispatcher.removeEventListener(e,t,n,a)},e.prototype.hasEventListener=function(e){return this.dispatcher.hasEventListener(e)},e.prototype.dispatchEvent=function(e){this.dispatcher.dispatchEvent(e)},e}();e.LListener=t,__reflect(t.prototype,"lcp.LListener")}(lcp||(lcp={}));var MathUtils;!function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=e.length;switch(a){case 0:n=Math.random();break;case 1:n=Math.floor((e[0]+1)*Math.random());break;default:n=Math.floor(Math.random()*(e[1]-e[0]+1)+e[0])}return n}function n(e){return 180*e/Math.PI}function a(e){return e/180*Math.PI}function i(e,t,n,a){var i=Math.round(n-e),o=Math.round(a-t),s=i*i+o*o,l=r(s),h=1/l;return Math.floor(h)}function o(e,t,n,a){var i=Math.round(n-e),o=Math.round(a-t),r=Math.atan2(o,i),s=parseFloat(r.toFixed(2));return s}function r(e,t){void 0===t&&(t=1);var n=new Float32Array(1),a=new Int32Array(n.buffer);n[0]=e,a[0]=1597463174-(a[0]>>1);for(var i=0;t>i;i++)n[0]=n[0]*(1.5-.5*e*n[0]*n[0]);return n[0]}function s(e){for(var t,n,a=e.length;a;)n=Math.floor(Math.random()*a--),t=e[a],e[a]=e[n],e[n]=t;return e}e.getRandom=t,e.getAngle=n,e.getRadian=a,e.getDistance=i,e.getRadian2=o,e.InvSqrt=r,e.shuffle=s}(MathUtils||(MathUtils={}));var md5=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),n)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var n=this.rstr2binl(e);n.length>16&&(n=this.binl_md5(n,8*e.length));for(var a=Array(16),i=Array(16),o=0;16>o;o++)a[o]=909522486^n[o],i[o]=1549556828^n[o];var r=this.binl_md5(a.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(i.concat(r),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var n,a=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<e.length;o++)n=e.charCodeAt(o),i+=a.charAt(n>>>4&15)+a.charAt(15&n);return i},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="",i=e.length,o=0;i>o;o+=3)for(var r=e.charCodeAt(o)<<16|(i>o+1?e.charCodeAt(o+1)<<8:0)|(i>o+2?e.charCodeAt(o+2):0),s=0;4>s;s++)a+=8*o+6*s>8*e.length?this.b64pad:n.charAt(r>>>6*(3-s)&63);return a},e.prototype.rstr2any=function(e,t){var n,a,i,o,r,s=t.length,l=Array(Math.ceil(e.length/2));for(n=0;n<l.length;n++)l[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var h=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),u=Array(h);for(a=0;h>a;a++){for(r=Array(),o=0,n=0;n<l.length;n++)o=(o<<16)+l[n],i=Math.floor(o/s),o-=i*s,(r.length>0||i>0)&&(r[r.length]=i);u[a]=o,l=r}var m="";for(n=u.length-1;n>=0;n--)m+=t.charAt(u[n]);return m},e.prototype.str2rstr_utf8=function(e){for(var t,n,a="",i=-1;++i<e.length;)t=e.charCodeAt(i),n=i+1<e.length?e.charCodeAt(i+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),i++),127>=t?a+=String.fromCharCode(t):2047>=t?a+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?a+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(a+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return a},e.prototype.str2rstr_utf16le=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},e.prototype.binl2rstr=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,a=-271733879,i=-1732584194,o=271733878,r=0;r<e.length;r+=16){var s=n,l=a,h=i,u=o;n=this.md5_ff(n,a,i,o,e[r+0],7,-680876936),o=this.md5_ff(o,n,a,i,e[r+1],12,-389564586),i=this.md5_ff(i,o,n,a,e[r+2],17,606105819),a=this.md5_ff(a,i,o,n,e[r+3],22,-1044525330),n=this.md5_ff(n,a,i,o,e[r+4],7,-176418897),o=this.md5_ff(o,n,a,i,e[r+5],12,1200080426),i=this.md5_ff(i,o,n,a,e[r+6],17,-1473231341),a=this.md5_ff(a,i,o,n,e[r+7],22,-45705983),n=this.md5_ff(n,a,i,o,e[r+8],7,1770035416),o=this.md5_ff(o,n,a,i,e[r+9],12,-1958414417),i=this.md5_ff(i,o,n,a,e[r+10],17,-42063),a=this.md5_ff(a,i,o,n,e[r+11],22,-1990404162),n=this.md5_ff(n,a,i,o,e[r+12],7,1804603682),o=this.md5_ff(o,n,a,i,e[r+13],12,-40341101),i=this.md5_ff(i,o,n,a,e[r+14],17,-1502002290),a=this.md5_ff(a,i,o,n,e[r+15],22,1236535329),n=this.md5_gg(n,a,i,o,e[r+1],5,-165796510),o=this.md5_gg(o,n,a,i,e[r+6],9,-1069501632),i=this.md5_gg(i,o,n,a,e[r+11],14,643717713),a=this.md5_gg(a,i,o,n,e[r+0],20,-373897302),n=this.md5_gg(n,a,i,o,e[r+5],5,-701558691),o=this.md5_gg(o,n,a,i,e[r+10],9,38016083),i=this.md5_gg(i,o,n,a,e[r+15],14,-660478335),a=this.md5_gg(a,i,o,n,e[r+4],20,-405537848),n=this.md5_gg(n,a,i,o,e[r+9],5,568446438),o=this.md5_gg(o,n,a,i,e[r+14],9,-1019803690),i=this.md5_gg(i,o,n,a,e[r+3],14,-187363961),a=this.md5_gg(a,i,o,n,e[r+8],20,1163531501),n=this.md5_gg(n,a,i,o,e[r+13],5,-1444681467),o=this.md5_gg(o,n,a,i,e[r+2],9,-51403784),i=this.md5_gg(i,o,n,a,e[r+7],14,1735328473),a=this.md5_gg(a,i,o,n,e[r+12],20,-1926607734),n=this.md5_hh(n,a,i,o,e[r+5],4,-378558),o=this.md5_hh(o,n,a,i,e[r+8],11,-2022574463),i=this.md5_hh(i,o,n,a,e[r+11],16,1839030562),a=this.md5_hh(a,i,o,n,e[r+14],23,-35309556),n=this.md5_hh(n,a,i,o,e[r+1],4,-1530992060),o=this.md5_hh(o,n,a,i,e[r+4],11,1272893353),i=this.md5_hh(i,o,n,a,e[r+7],16,-155497632),a=this.md5_hh(a,i,o,n,e[r+10],23,-1094730640),n=this.md5_hh(n,a,i,o,e[r+13],4,681279174),o=this.md5_hh(o,n,a,i,e[r+0],11,-358537222),i=this.md5_hh(i,o,n,a,e[r+3],16,-722521979),a=this.md5_hh(a,i,o,n,e[r+6],23,76029189),n=this.md5_hh(n,a,i,o,e[r+9],4,-640364487),o=this.md5_hh(o,n,a,i,e[r+12],11,-421815835),i=this.md5_hh(i,o,n,a,e[r+15],16,530742520),a=this.md5_hh(a,i,o,n,e[r+2],23,-995338651),n=this.md5_ii(n,a,i,o,e[r+0],6,-198630844),o=this.md5_ii(o,n,a,i,e[r+7],10,1126891415),i=this.md5_ii(i,o,n,a,e[r+14],15,-1416354905),a=this.md5_ii(a,i,o,n,e[r+5],21,-57434055),n=this.md5_ii(n,a,i,o,e[r+12],6,1700485571),o=this.md5_ii(o,n,a,i,e[r+3],10,-1894986606),i=this.md5_ii(i,o,n,a,e[r+10],15,-1051523),a=this.md5_ii(a,i,o,n,e[r+1],21,-2054922799),n=this.md5_ii(n,a,i,o,e[r+8],6,1873313359),o=this.md5_ii(o,n,a,i,e[r+15],10,-30611744),i=this.md5_ii(i,o,n,a,e[r+6],15,-1560198380),a=this.md5_ii(a,i,o,n,e[r+13],21,1309151649),n=this.md5_ii(n,a,i,o,e[r+4],6,-145523070),o=this.md5_ii(o,n,a,i,e[r+11],10,-1120210379),i=this.md5_ii(i,o,n,a,e[r+2],15,718787259),a=this.md5_ii(a,i,o,n,e[r+9],21,-343485551),n=this.safe_add(n,s),a=this.safe_add(a,l),i=this.safe_add(i,h),o=this.safe_add(o,u)
}return[n,a,i,o]},e.prototype.md5_cmn=function(e,t,n,a,i,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(a,o)),i),n)},e.prototype.md5_ff=function(e,t,n,a,i,o,r){return this.md5_cmn(t&n|~t&a,e,t,i,o,r)},e.prototype.md5_gg=function(e,t,n,a,i,o,r){return this.md5_cmn(t&a|n&~a,e,t,i,o,r)},e.prototype.md5_hh=function(e,t,n,a,i,o,r){return this.md5_cmn(t^n^a,e,t,i,o,r)},e.prototype.md5_ii=function(e,t,n,a,i,o,r){return this.md5_cmn(n^(t|~a),e,t,i,o,r)},e.prototype.safe_add=function(e,t){var n=(65535&e)+(65535&t),a=(e>>16)+(t>>16)+(n>>16);return a<<16|65535&n},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();__reflect(md5.prototype,"md5");var NativeApi;!function(e){function t(e,t){egret.localStorage.setItem(e,t)}function n(e){return egret.localStorage.getItem(e)}function a(e){egret.localStorage.removeItem(e)}function i(){egret.localStorage.clear()}function o(){}function r(){}function s(e){window.open("tel:"+e,"_self")}function l(e){window.open("sms:"+e,"_self")}function h(){return window.location.href}e.setLocalData=t,e.getLocalData=n,e.deleteLocalData=a,e.clearLocalData=i,e.getMic=o,e.getScreen=r,e.callPhone=s,e.sendMessage=l,e.getCurUrl=h}(NativeApi||(NativeApi={}));var ShakeTool=function(){function e(){this.count=0,this.timer=new egret.Timer(100)}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.shakeObj=function(e,t,n,a,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.target=e,this.maxDis=a,this.count=t*n,this.rate=n,this.timer.delay=100/n,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start(),null!=i&&null!=o&&(this.completeFunc=i,this.thisobj=o)},e.prototype.setInitPos=function(e,t){this.initX=e,this.initY=t},e.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},100/this.rate)},e.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.completeFunc&&this.thisobj&&this.completeFunc.call(this.thisobj),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},e.prototype.stop=function(){this.shakeComplete()},e}();__reflect(ShakeTool.prototype,"ShakeTool");